!function(t){var e={id:"c4907790",exports:{}};t.__modules__||(t.__modules__={});!function(t,e){(function(){var i=this,n=i._,s={},a=Array.prototype,o=Object.prototype,r=Function.prototype,d=a.push,l=a.slice,h=a.concat,c=o.toString,u=o.hasOwnProperty,p=a.forEach,f=a.map,g=a.reduce,v=a.reduceRight,_=a.filter,b=a.every,m=a.some,y=a.indexOf,w=a.lastIndexOf,T=Array.isArray,E=Object.keys,x=r.bind,A=function(t){return t instanceof A?t:this instanceof A?void(this._wrapped=t):new A(t)};"undefined"!=typeof t?("undefined"!=typeof e&&e.exports&&(t=e.exports=A),t._=A):i._=A,A.VERSION="1.6.0";var k=A.each=A.forEach=function(t,e,i){if(null==t)return t;if(p&&t.forEach===p)t.forEach(e,i);else if(t.length===+t.length){for(var n=0,a=t.length;a>n;n++)if(e.call(i,t[n],n,t)===s)return}else for(var o=A.keys(t),n=0,a=o.length;a>n;n++)if(e.call(i,t[o[n]],o[n],t)===s)return;return t};A.map=A.collect=function(t,e,i){var n=[];return null==t?n:f&&t.map===f?t.map(e,i):(k(t,function(t,s,a){n.push(e.call(i,t,s,a))}),n)};var P="Reduce of empty array with no initial value";A.reduce=A.foldl=A.inject=function(t,e,i,n){var s=arguments.length>2;if(null==t&&(t=[]),g&&t.reduce===g)return n&&(e=A.bind(e,n)),s?t.reduce(e,i):t.reduce(e);if(k(t,function(t,a,o){s?i=e.call(n,i,t,a,o):(i=t,s=!0)}),!s)throw new TypeError(P);return i},A.reduceRight=A.foldr=function(t,e,i,n){var s=arguments.length>2;if(null==t&&(t=[]),v&&t.reduceRight===v)return n&&(e=A.bind(e,n)),s?t.reduceRight(e,i):t.reduceRight(e);var a=t.length;if(a!==+a){var o=A.keys(t);a=o.length}if(k(t,function(r,d,l){d=o?o[--a]:--a,s?i=e.call(n,i,t[d],d,l):(i=t[d],s=!0)}),!s)throw new TypeError(P);return i},A.find=A.detect=function(t,e,i){var n;return S(t,function(t,s,a){return e.call(i,t,s,a)?(n=t,!0):void 0}),n},A.filter=A.select=function(t,e,i){var n=[];return null==t?n:_&&t.filter===_?t.filter(e,i):(k(t,function(t,s,a){e.call(i,t,s,a)&&n.push(t)}),n)},A.reject=function(t,e,i){return A.filter(t,function(t,n,s){return!e.call(i,t,n,s)},i)},A.every=A.all=function(t,e,i){e||(e=A.identity);var n=!0;return null==t?n:b&&t.every===b?t.every(e,i):(k(t,function(t,a,o){return(n=n&&e.call(i,t,a,o))?void 0:s}),!!n)};var S=A.some=A.any=function(t,e,i){e||(e=A.identity);var n=!1;return null==t?n:m&&t.some===m?t.some(e,i):(k(t,function(t,a,o){return n||(n=e.call(i,t,a,o))?s:void 0}),!!n)};A.contains=A.include=function(t,e){return null==t?!1:y&&t.indexOf===y?-1!=t.indexOf(e):S(t,function(t){return t===e})},A.invoke=function(t,e){var i=l.call(arguments,2),n=A.isFunction(e);return A.map(t,function(t){return(n?e:t[e]).apply(t,i)})},A.pluck=function(t,e){return A.map(t,A.property(e))},A.where=function(t,e){return A.filter(t,A.matches(e))},A.findWhere=function(t,e){return A.find(t,A.matches(e))},A.max=function(t,e,i){if(!e&&A.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.max.apply(Math,t);var n=-1/0,s=-1/0;return k(t,function(t,a,o){var r=e?e.call(i,t,a,o):t;r>s&&(n=t,s=r)}),n},A.min=function(t,e,i){if(!e&&A.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.min.apply(Math,t);var n=1/0,s=1/0;return k(t,function(t,a,o){var r=e?e.call(i,t,a,o):t;s>r&&(n=t,s=r)}),n},A.shuffle=function(t){var e,i=0,n=[];return k(t,function(t){e=A.random(i++),n[i-1]=n[e],n[e]=t}),n},A.sample=function(t,e,i){return null==e||i?(t.length!==+t.length&&(t=A.values(t)),t[A.random(t.length-1)]):A.shuffle(t).slice(0,Math.max(0,e))};var I=function(t){return null==t?A.identity:A.isFunction(t)?t:A.property(t)};A.sortBy=function(t,e,i){return e=I(e),A.pluck(A.map(t,function(t,n,s){return{value:t,index:n,criteria:e.call(i,t,n,s)}}).sort(function(t,e){var i=t.criteria,n=e.criteria;if(i!==n){if(i>n||void 0===i)return 1;if(n>i||void 0===n)return-1}return t.index-e.index}),"value")};var L=function(t){return function(e,i,n){var s={};return i=I(i),k(e,function(a,o){var r=i.call(n,a,o,e);t(s,r,a)}),s}};A.groupBy=L(function(t,e,i){A.has(t,e)?t[e].push(i):t[e]=[i]}),A.indexBy=L(function(t,e,i){t[e]=i}),A.countBy=L(function(t,e){A.has(t,e)?t[e]++:t[e]=1}),A.sortedIndex=function(t,e,i,n){i=I(i);for(var s=i.call(n,e),a=0,o=t.length;o>a;){var r=a+o>>>1;i.call(n,t[r])<s?a=r+1:o=r}return a},A.toArray=function(t){return t?A.isArray(t)?l.call(t):t.length===+t.length?A.map(t,A.identity):A.values(t):[]},A.size=function(t){return null==t?0:t.length===+t.length?t.length:A.keys(t).length},A.first=A.head=A.take=function(t,e,i){return null==t?void 0:null==e||i?t[0]:0>e?[]:l.call(t,0,e)},A.initial=function(t,e,i){return l.call(t,0,t.length-(null==e||i?1:e))},A.last=function(t,e,i){return null==t?void 0:null==e||i?t[t.length-1]:l.call(t,Math.max(t.length-e,0))},A.rest=A.tail=A.drop=function(t,e,i){return l.call(t,null==e||i?1:e)},A.compact=function(t){return A.filter(t,A.identity)};var C=function(t,e,i){return e&&A.every(t,A.isArray)?h.apply(i,t):(k(t,function(t){A.isArray(t)||A.isArguments(t)?e?d.apply(i,t):C(t,e,i):i.push(t)}),i)};A.flatten=function(t,e){return C(t,e,[])},A.without=function(t){return A.difference(t,l.call(arguments,1))},A.partition=function(t,e){var i=[],n=[];return k(t,function(t){(e(t)?i:n).push(t)}),[i,n]},A.uniq=A.unique=function(t,e,i,n){A.isFunction(e)&&(n=i,i=e,e=!1);var s=i?A.map(t,i,n):t,a=[],o=[];return k(s,function(i,n){(e?n&&o[o.length-1]===i:A.contains(o,i))||(o.push(i),a.push(t[n]))}),a},A.union=function(){return A.uniq(A.flatten(arguments,!0))},A.intersection=function(t){var e=l.call(arguments,1);return A.filter(A.uniq(t),function(t){return A.every(e,function(e){return A.contains(e,t)})})},A.difference=function(t){var e=h.apply(a,l.call(arguments,1));return A.filter(t,function(t){return!A.contains(e,t)})},A.zip=function(){for(var t=A.max(A.pluck(arguments,"length").concat(0)),e=new Array(t),i=0;t>i;i++)e[i]=A.pluck(arguments,""+i);return e},A.object=function(t,e){if(null==t)return{};for(var i={},n=0,s=t.length;s>n;n++)e?i[t[n]]=e[n]:i[t[n][0]]=t[n][1];return i},A.indexOf=function(t,e,i){if(null==t)return-1;var n=0,s=t.length;if(i){if("number"!=typeof i)return n=A.sortedIndex(t,e),t[n]===e?n:-1;n=0>i?Math.max(0,s+i):i}if(y&&t.indexOf===y)return t.indexOf(e,i);for(;s>n;n++)if(t[n]===e)return n;return-1},A.lastIndexOf=function(t,e,i){if(null==t)return-1;var n=null!=i;if(w&&t.lastIndexOf===w)return n?t.lastIndexOf(e,i):t.lastIndexOf(e);for(var s=n?i:t.length;s--;)if(t[s]===e)return s;return-1},A.range=function(t,e,i){arguments.length<=1&&(e=t||0,t=0),i=arguments[2]||1;for(var n=Math.max(Math.ceil((e-t)/i),0),s=0,a=new Array(n);n>s;)a[s++]=t,t+=i;return a};var D=function(){};A.bind=function(t,e){var i,n;if(x&&t.bind===x)return x.apply(t,l.call(arguments,1));if(!A.isFunction(t))throw new TypeError;return i=l.call(arguments,2),n=function(){if(!(this instanceof n))return t.apply(e,i.concat(l.call(arguments)));D.prototype=t.prototype;var s=new D;D.prototype=null;var a=t.apply(s,i.concat(l.call(arguments)));return Object(a)===a?a:s}},A.partial=function(t){var e=l.call(arguments,1);return function(){for(var i=0,n=e.slice(),s=0,a=n.length;a>s;s++)n[s]===A&&(n[s]=arguments[i++]);for(;i<arguments.length;)n.push(arguments[i++]);return t.apply(this,n)}},A.bindAll=function(t){var e=l.call(arguments,1);if(0===e.length)throw new Error("bindAll must be passed function names");return k(e,function(e){t[e]=A.bind(t[e],t)}),t},A.memoize=function(t,e){var i={};return e||(e=A.identity),function(){var n=e.apply(this,arguments);return A.has(i,n)?i[n]:i[n]=t.apply(this,arguments)}},A.delay=function(t,e){var i=l.call(arguments,2);return setTimeout(function(){return t.apply(null,i)},e)},A.defer=function(t){return A.delay.apply(A,[t,1].concat(l.call(arguments,1)))},A.throttle=function(t,e,i){var n,s,a,o=null,r=0;i||(i={});var d=function(){r=i.leading===!1?0:A.now(),o=null,a=t.apply(n,s),n=s=null};return function(){var l=A.now();r||i.leading!==!1||(r=l);var h=e-(l-r);return n=this,s=arguments,0>=h?(clearTimeout(o),o=null,r=l,a=t.apply(n,s),n=s=null):o||i.trailing===!1||(o=setTimeout(d,h)),a}},A.debounce=function(t,e,i){var n,s,a,o,r,d=function(){var l=A.now()-o;e>l?n=setTimeout(d,e-l):(n=null,i||(r=t.apply(a,s),a=s=null))};return function(){a=this,s=arguments,o=A.now();var l=i&&!n;return n||(n=setTimeout(d,e)),l&&(r=t.apply(a,s),a=s=null),r}},A.once=function(t){var e,i=!1;return function(){return i?e:(i=!0,e=t.apply(this,arguments),t=null,e)}},A.wrap=function(t,e){return A.partial(e,t)},A.compose=function(){var t=arguments;return function(){for(var e=arguments,i=t.length-1;i>=0;i--)e=[t[i].apply(this,e)];return e[0]}},A.after=function(t,e){return function(){return--t<1?e.apply(this,arguments):void 0}},A.keys=function(t){if(!A.isObject(t))return[];if(E)return E(t);var e=[];for(var i in t)A.has(t,i)&&e.push(i);return e},A.values=function(t){for(var e=A.keys(t),i=e.length,n=new Array(i),s=0;i>s;s++)n[s]=t[e[s]];return n},A.pairs=function(t){for(var e=A.keys(t),i=e.length,n=new Array(i),s=0;i>s;s++)n[s]=[e[s],t[e[s]]];return n},A.invert=function(t){for(var e={},i=A.keys(t),n=0,s=i.length;s>n;n++)e[t[i[n]]]=i[n];return e},A.functions=A.methods=function(t){var e=[];for(var i in t)A.isFunction(t[i])&&e.push(i);return e.sort()},A.extend=function(t){return k(l.call(arguments,1),function(e){if(e)for(var i in e)t[i]=e[i]}),t},A.pick=function(t){var e={},i=h.apply(a,l.call(arguments,1));return k(i,function(i){i in t&&(e[i]=t[i])}),e},A.omit=function(t){var e={},i=h.apply(a,l.call(arguments,1));for(var n in t)A.contains(i,n)||(e[n]=t[n]);return e},A.defaults=function(t){return k(l.call(arguments,1),function(e){if(e)for(var i in e)void 0===t[i]&&(t[i]=e[i])}),t},A.clone=function(t){return A.isObject(t)?A.isArray(t)?t.slice():A.extend({},t):t},A.tap=function(t,e){return e(t),t};var M=function(t,e,i,n){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return t===e;t instanceof A&&(t=t._wrapped),e instanceof A&&(e=e._wrapped);var s=c.call(t);if(s!=c.call(e))return!1;switch(s){case"[object String]":return t==String(e);case"[object Number]":return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object RegExp]":return t.source==e.source&&t.global==e.global&&t.multiline==e.multiline&&t.ignoreCase==e.ignoreCase}if("object"!=typeof t||"object"!=typeof e)return!1;for(var a=i.length;a--;)if(i[a]==t)return n[a]==e;var o=t.constructor,r=e.constructor;if(o!==r&&!(A.isFunction(o)&&o instanceof o&&A.isFunction(r)&&r instanceof r)&&"constructor"in t&&"constructor"in e)return!1;i.push(t),n.push(e);var d=0,l=!0;if("[object Array]"==s){if(d=t.length,l=d==e.length)for(;d--&&(l=M(t[d],e[d],i,n)););}else{for(var h in t)if(A.has(t,h)&&(d++,!(l=A.has(e,h)&&M(t[h],e[h],i,n))))break;if(l){for(h in e)if(A.has(e,h)&&!d--)break;l=!d}}return i.pop(),n.pop(),l};A.isEqual=function(t,e){return M(t,e,[],[])},A.isEmpty=function(t){if(null==t)return!0;if(A.isArray(t)||A.isString(t))return 0===t.length;for(var e in t)if(A.has(t,e))return!1;return!0},A.isElement=function(t){return!(!t||1!==t.nodeType)},A.isArray=T||function(t){return"[object Array]"==c.call(t)},A.isObject=function(t){return t===Object(t)},k(["Arguments","Function","String","Number","Date","RegExp"],function(t){A["is"+t]=function(e){return c.call(e)=="[object "+t+"]"}}),A.isArguments(arguments)||(A.isArguments=function(t){return!(!t||!A.has(t,"callee"))}),"function"!=typeof/./&&(A.isFunction=function(t){return"function"==typeof t}),A.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},A.isNaN=function(t){return A.isNumber(t)&&t!=+t},A.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"==c.call(t)},A.isNull=function(t){return null===t},A.isUndefined=function(t){return void 0===t},A.has=function(t,e){return u.call(t,e)},A.noConflict=function(){return i._=n,this},A.identity=function(t){return t},A.constant=function(t){return function(){return t}},A.property=function(t){return function(e){return e[t]}},A.matches=function(t){return function(e){if(e===t)return!0;for(var i in t)if(t[i]!==e[i])return!1;return!0}},A.times=function(t,e,i){for(var n=Array(Math.max(0,t)),s=0;t>s;s++)n[s]=e.call(i,s);return n},A.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},A.now=Date.now||function(){return(new Date).getTime()};var H={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};H.unescape=A.invert(H.escape);var R={escape:new RegExp("["+A.keys(H.escape).join("")+"]","g"),unescape:new RegExp("("+A.keys(H.unescape).join("|")+")","g")};A.each(["escape","unescape"],function(t){A[t]=function(e){return null==e?"":(""+e).replace(R[t],function(e){return H[t][e]})}}),A.result=function(t,e){if(null==t)return void 0;var i=t[e];return A.isFunction(i)?i.call(t):i},A.mixin=function(t){k(A.functions(t),function(e){var i=A[e]=t[e];A.prototype[e]=function(){var t=[this._wrapped];return d.apply(t,arguments),F.call(this,i.apply(A,t))}})};var O=0;A.uniqueId=function(t){var e=++O+"";return t?t+e:e},A.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var N=/(.)^/,B={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},U=/\\|'|\r|\n|\t|\u2028|\u2029/g;A.template=function(t,e,i){var n;i=A.defaults({},i,A.templateSettings);var s=new RegExp([(i.escape||N).source,(i.interpolate||N).source,(i.evaluate||N).source].join("|")+"|$","g"),a=0,o="__p+='";t.replace(s,function(e,i,n,s,r){return o+=t.slice(a,r).replace(U,function(t){return"\\"+B[t]}),i&&(o+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'"),n&&(o+="'+\n((__t=("+n+"))==null?'':__t)+\n'"),s&&(o+="';\n"+s+"\n__p+='"),a=r+e.length,e}),o+="';\n",i.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{n=new Function(i.variable||"obj","_",o)}catch(r){throw r.source=o,r}if(e)return n(e,A);var d=function(t){return n.call(this,t,A)};return d.source="function("+(i.variable||"obj")+"){\n"+o+"}",d},A.chain=function(t){return A(t).chain()};var F=function(t){return this._chain?A(t).chain():t};A.mixin(A),k(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=a[t];A.prototype[t]=function(){var i=this._wrapped;return e.apply(i,arguments),"shift"!=t&&"splice"!=t||0!==i.length||delete i[0],F.call(this,i)}}),k(["concat","join","slice"],function(t){var e=a[t];A.prototype[t]=function(){return F.call(this,e.apply(this._wrapped,arguments))}}),A.extend(A.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),"function"==typeof define&&define.amd&&define("underscore",[],function(){return A}),window._=A}).call(this)}(e.exports,e,t);t.__modules__.c4907790=e.exports}(this),function(t){var e={id:"c490c5b0",exports:{}};t.__modules__||(t.__modules__={});!function(){Handlebars.registerHelper("range",function(t,e){for(var i="",n=0;t>n;n++)i+=e.fn();return i})}(e.exports,e,t);t.__modules__.c490c5b0=e.exports}(this),function(t){var e={id:"c490ecc0",exports:{}};t.__modules__||(t.__modules__={});!function(){!function(t){var e=function(t,e){var i,n=this;i=t&&_.has(t,"constructor")?t.constructor:function(){return n.apply(this,arguments)},_.extend(i,n,e);var s=function(){this.constructor=i};return s.prototype=n.prototype,i.prototype=new s,t&&_.extend(i.prototype,t),_.extend(i.prototype,{"super":n.prototype}),i},i=function(t){t||(t={});for(var e={},i={},n=this.super,s={},a={};n;)_.extend(i,n.config),_.extend(a,n.listeners),n=n.super;_.extend(e,i,this.config),_.extend(s,a,this.listeners,t.listeners);var o=_.keys(e);e=_.defaults(_.pick(t,o),e),t=_.omit(t,o),t.config=e,t.listeners=s,this.options=t,this.initial.call(this,t)};_.extend(i.prototype,{fid:0,config:{},events:{},listeners:{},initial:function(){},set:function(t,e){if(_.isObject(t)&&!e)for(var i in t)t.hasOwnProperty(i)&&this.set(i,t[i]);else if(_.isString(t)){var n,s,a=_.result(this.options,"config");"undefined"!=typeof a[t]&&(_.isFunction(e)&&(e=e.call(null)),s=a[t],this.options.config[t]=e,n=this.options.listeners[t+"Changed"]||this.events[t+"changed"],_.isFunction(n)&&!1===n.apply(this,[e,s])&&(this.options.config[t]=s))}},get:function(t){return this.options.config[t]},trigger:function(t,e){t=this.options.listeners[t],_.isFunction(t)&&t.apply(this,e)}}),i.extend=e,t.FClass=t.F=i,t.log=console.log}(window)}(e.exports,e,t);t.__modules__.c490ecc0=e.exports}(this),function(t){var e={id:"c490ecc1",exports:{}};t.__modules__||(t.__modules__={});!function(t,e){var i=/^(\S+)\s*(.*)$/;window.Fui=e.exports=FClass.extend({el:null,$el:null,tagName:"div",config:null,model:null,collection:null,attributes:null,css:null,className:null,events:{},initialize:function(){},initial:function(t){this.cid=_.uniqueId("fui"),_.extend(this.events,t.events||{}),_.extend(this,_.omit(t,["events"])),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},render:function(){},callParent:function(t){_.isString(t)||(t="render");var e=this.super[t];return _.isFunction(e)&&(e=e.call(this)),e},show:function(){this.$el.show()},hide:function(){this.$el.hide()},refresh:null,remove:function(){return this.$el.remove(),this.stopListening(),this.onRemove(),this},onRemove:function(){},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},delegateEvents:function(t){if(!t&&!(t=_.result(this,"events")))return this;this.undelegateEvents();for(var e in t){var n=t[e];if(_.isFunction(n)||(n=this[t[e]]),n){var s=e.match(i),a=s[1],o=s[2];n=_.bind(n,this),a+=".delegateEvents"+this.cid,""===o?this.$el.on(a,n):this.$el.on(a,o,n)}}return this},setElement:function(t,e){this.$el&&this.undelegateEvents(),this.$el=t instanceof $?t:$(t),this.el=this.$el[0];var i=_.extend({},_.result(this,"attributes")),n=_.extend({},_.result(this,"css"));this.id&&(i.id=_.result(this,"id"));var s=_.result(this,"className");return _.isFunction(s)&&(s=s.apply(this)),_.isArray(s)&&(s=s.join(" ")),this.$el.attr(i).css(n).addClass(s),e!==!1&&this.delegateEvents(),this},_ensureElement:function(){if(this.el)this.setElement(_.result(this,"el"),!1);else{var t=$("<"+_.result(this,"tagName")+">");this.setElement(t,!1)}},stopListening:function(t,e,i){var n=this._listeningTo;if(!n)return this;var s=!e&&!i;i||"object"!=typeof e||(i=this),t&&((n={})[t._listenId]=t);for(var a in n)t=n[a],t.off(e,i,this),(s||_.isEmpty(t._events))&&delete this._listeningTo[a];return this}},{emptyFunc:function(){},deviceType:function(){var t=this.WIN_W;return 640>t?1:960>t?2:1280>t?3:4},isM:function(){return 1==this.deviceType()},WIN_W:$(window).width(),WIN_H:$(window).height(),SCROLL_TOP:function(){return $(document).scrollTop()},Msg:function(t,e){e=e||"info",console.log("["+e+"] "+t)}})}(e.exports,e,t);t.__modules__.c490ecc1=e.exports}(this),function(t){var e={id:"c4922540",exports:{}};t.__modules__||(t.__modules__={});!function(){var t={ua:navigator.userAgent,andrioid_version:100,isAndroid:!1,init:function(){this.OS=this.searchString(this.dataOS())||"an unknown OS",this.Browser=this.searchBrowser(this.dataB()),this.mobile="iPhone"==this.OS||"iPad"==this.OS||"Android"==this.OS||"Winphone"==this.OS?!0:!1,/Android (\d+\.\d+)/.test(navigator.userAgent)&&(this.andrioid_version=RegExp.$1,this.isAndroid=!0)},searchString:function(t){for(var e=0;e<t.length;e++){var i=t[e].string;if(i&&-1!=i.indexOf(t[e].forSearch))return t[e].forShow}},searchBrowser:function(t){for(var e="",i=0;i<t.length;i++){var n=t[i].string;n&&-1!=n.indexOf(t[i].forSearch)&&(e+=t[i].forShow+"|")}return e},dataOS:function(){return[{string:navigator.platform,forSearch:"Win",forShow:"Windows"},{string:navigator.platform,forSearch:"Mac",forShow:"Mac"},{string:this.ua,forSearch:"iPhone",forShow:"iPhone"},{string:this.ua,forSearch:"iPad",forShow:"iPad"},{string:this.ua,forSearch:"Android",forShow:"Android"},{string:this.ua,forSearch:"Windows Phone",forShow:"Winphone"}]},dataB:function(){return[{string:this.ua,forSearch:"360browser",forShow:"360"},{string:this.ua,forSearch:"Maxthon",forShow:"Maxthon"},{string:this.ua,forSearch:"UCBrowser",forShow:"uc"},{string:this.ua,forSearch:"Oupeng",forShow:"opera"},{string:this.ua,forSearch:"Opera",forShow:"opera"},{string:this.ua,forSearch:"Sogou",forShow:"sogou"},{string:this.ua,forSearch:"baidu",forShow:"baidu"},{string:this.ua,forSearch:"Safari",forShow:"safari"},{string:this.ua,forSearch:"MicroMessenger",forShow:"weixin"},{string:this.ua,forSearch:"QQ/",forShow:"qq"},{string:this.ua,forSearch:"Weibo",forShow:"weibo"},{string:this.ua,forSearch:"MQBrowser",forShow:"360"},{string:this.ua,forSearch:"MQQBrowser",forShow:"qqbrowser"},{string:this.ua,forSearch:"CriOS",forShow:"Maxthon"}]}};t.init(),Fui.client=t}(e.exports,e,t);t.__modules__.c4922540=e.exports}(this),function(t){var e={id:"c493abe0",exports:{}};t.__modules__||(t.__modules__={});!function(){var t=Fui.Event=function(t){this.options=t,this.bindEvents()};t.prototype={_event_start:!1,_event_start_p:{x:0,y:0,ts:0},_event_cur_p:{x:0,y:0,ts:0},_event_cur_dis:{x:0,y:0},_event_del_p:{x:0,y:0,ts:0},gesture:null,unbindEvents:function(){var t=this.options.hoster;t.$el.undelegate("."+t.cid),delete this},getAngle:function(t,e){var i=180*Math.atan(Math.abs(e/t))/Math.PI;return 0>t&&(i=180-i),e>0&&(i=-i),i},getCurAngle:function(){var t,e=this,i=e._event_del_p;return t=180*Math.atan(-i.y/i.x)/Math.PI,i.x<0&&(t+=90),t},bindEvents:function(){function t(t){var e=t.originalEvent.touches?t.originalEvent.touches[0]:t.originalEvent;h._event_start=!0,n=h._event_start_p=h._event_cur_p=o=a={x:e.clientX,y:e.clientY,ts:Date.now()},f=!0,h.gesture=null,_.isFunction(c._onstart)&&c._onstart(t)}function e(t){var e=t.originalEvent.touches?t.originalEvent.touches[0]:t.originalEvent,i=h.gesture;f&&(g=!0),s=h._event_cur_p={x:e.clientX,y:e.clientY,ts:Date.now()},o=a,a=s;var u=h._event_cur_dis.x=s.x-n.x,p=h._event_cur_dis.y=s.y-n.y;if(null==i&&(Math.abs(u)>10||Math.abs(p)>10)){var v=h.getAngle(u,p);h.gesture=30>=v&&v>=-30?"rightSwipe":v>30&&150>v?"topSwipe":v>=150||-150>=v?"leftSwipe":"bottomSwipe"}a.ts-o.ts>5&&(r=a.x-o.x,d=a.y-o.y,l=a.ts-o.ts,h._event_del_p={x:r,y:d,ts:l},h._event_cur_speed={x:r/l,y:d/l},_.isFunction(c._onmove)&&c._onmove(t))}function i(t){null==h.gesture&&(h.gesture="tap"),_.isFunction(c._onend)&&c._onend(t),f&&!g&&_.isFunction(c._ontap)&&c._ontap(t),f=!1,g=!1}var n,s,a,o,r,d,l,h=this,c=this.options.hoster,u=c.cid,p=c.$el,f=!1,g=!1,v=!1;p.bind("touchstart."+u,t).bind("touchmove."+u,e).bind("touchend."+u,i).bind("mousedown."+u,function(e){v=!0,t(e)}).bind("mousemove."+u,function(t){v&&e(t)}).bind("mouseup."+u,function(t){v&&(i(t),v=!1)}).bind("mouseout."+u,function(t){v&&(i(t),v=!1)})}}}(e.exports,e,t);t.__modules__.c493abe0=e.exports}(this),function(t){var e={id:"c4902970",exports:{}};t.__modules__||(t.__modules__={});!function(t,e,i){i.__modules__.c4907790,i.__modules__.c490c5b0,i.__modules__.c490ecc0,i.__modules__.c490ecc1,i.__modules__.c4922540,i.__modules__.c493abe0}(e.exports,e,t);t.__modules__.c4902970=e.exports}(this),function(t){var e={id:"c4950b70",exports:{}};t.__modules__||(t.__modules__={});!function(){Fui.Weixin=FClass.extend({config:{title:null,desc:null,link:String(window.location.href),appid:"",img_url:null,img_width:200,img_height:200},initialize:function(){var t=this;document.addEventListener("WeixinJSBridgeReady",function(){WeixinJSBridge.on("menu:share:appmessage",function(){WeixinJSBridge.invoke("sendAppMessage",{appid:"",img_url:t.get("img_url"),img_width:t.get("img_width"),img_height:t.get("img_height"),link:t.get("link"),desc:t.get("desc"),title:t.get("title")},function(){})}),WeixinJSBridge.on("menu:share:timeline",function(){WeixinJSBridge.invoke("shareTimeline",{appid:"",img_url:t.get("img_url"),img_width:t.get("img_width"),img_height:t.get("img_height"),link:t.get("link"),desc:t.get("desc"),title:t.get("title")},function(e){switch(e.err_msg){case"share:timeline:ok":t.trigger("timeline",[!0]);break;case"share:timeline:cancel":t.trigger("timeline",[!1])}})})},!1)}})}(e.exports,e,t);t.__modules__.c4950b70=e.exports}(this),function(t){var e={id:"c495a7b0",exports:{}};t.__modules__||(t.__modules__={});!function(){var t=window.URL&&window.URL.createObjectURL?window.URL:window.webkitURL&&window.webkitURL.createObjectURL?window.webkitURL:null;if(!t)throw Error("No createObjectURL function found to create blob url");Fui.Template=Fui.extend({config:{template:null,tpl:null,pageIndex:0,bg:null},propsForm:null,save:function(){},getImgPath:function(t){return t},initialize:function(){var t=this,e=t.get("bg");this.renderBg(e),this.addTpl()},renderBg:function(t){t&&this.$el.css({backgroundImage:"url("+this.getImgPath(t)+")"})},clearBg:function(){this.$el.css({backgroundImage:"none"})},onFocus:function(){},onBlur:function(){},getTplData:function(){return{pageIndex:this.get("pageIndex")}},checkSize:function(){return!0},validateInfo:function(t,e){var i=!0;return _.each(e,function(e){t.hasOwnProperty(e)||(error("Module must contain a ["+e+"] on [name: "+t.label+",label:"+t.name+"]"),i=!1)}),i},addTpl:function(){var t=this.get("tpl")||"";this.$el.append(Handlebars.compile(t)(this.getTplData()))},getData:function(){return _.extend({},{template:this.get("template")},this.getForm().getData())},form:null,getForm:function(){var t=this.get("pageIndex")+1;return this.form||(this.form=new Fui.Form({size:"normal",title:(1==t?"首":"第 "+t+" ")+"页属性",items:this.getFormItems()})),this.form},getFormItems:Fui.emptyFunc,getGestureItems:function(){return[]},getText:function(t){return this.validateInfo(t,["name","label","placeHolder"])?(t.type="text",t):void 0},getSelection:function(t){t.$el;if(this.validateInfo(t,["name","label","change","data"]))return t.type="select",t},getImagePicker:function(t){return this.getImage(t)},getImageListPicker:function(e){var i=this;if(this.validateInfo(e,["name","change"]))return{type:"image-list",name:e.name,listeners:{change:function(n,s){var a=n.target.files[0],o=t.createObjectURL(a),r=new Image;r.src=o,r.onload=function(){var t=this.naturalWidth,a=this.naturalHeight;return i.checkSize(t,a)?void e.change.call(r,n,s):void error("Image size must be 640 X 1010")}}}}},getImage:function(t){if(this.validateInfo(t,["name","label","change"])){return t.type="image",t}}})}(e.exports,e,t);t.__modules__.c495a7b0=e.exports}(this),function(t){var e={id:"c4970740",exports:{}};t.__modules__||(t.__modules__={});!function(t,e){e.exports='<div class="base-foreground"></div>'}(e.exports,e,t);t.__modules__.c4970740=e.exports}(this),function(t){var e={id:"c4966b00",exports:{}};t.__modules__||(t.__modules__={});!function(t,e,i){Fui.Template.Base=Fui.Template.extend({className:"module module-base",config:{tpl:i.__modules__.c4970740,fg:null},save:function(t){function e(){s++,2==s&&t(!0,i)}var i=this,n=this.getForm().getData(),s=0;_.each(n,function(n,s){new Fui.FileUpload({file:n,name:s,listeners:{end:function(t,n){i.getForm().setData(n,t),e()},error:function(){t(!1)}}})})},render:function(){var t=this,e=t.get("fg");this.renderFg(e)},renderFg:function(t){t&&this.$el.children(".base-foreground").css({backgroundImage:"url("+this.getImgPath(t)+")"})},clearFg:function(){this.$el.children(".base-foreground").css({backgroundImage:"none"})},getFormItems:function(){{var t=this;t.$el}return[{type:"ImagePicker",$el:this.$el,label:"背景图片：",name:"bg",listeners:{change:function(e,i){t.renderBg(i.src)},clear:function(){t.clearBg()}}},{type:"ImagePicker",$el:this.$el,label:"前景图片：",name:"fg",listeners:{change:function(e,i){t.renderFg(i.src)},clear:function(){t.clearFg()}}}]}})}(e.exports,e,t);t.__modules__.c4966b00=e.exports}(this),function(t){var e={id:"c4999f50",exports:{}};t.__modules__||(t.__modules__={});!function(t,e){e.exports='<div class="video-play">    <a data-tap="page-{{pageIndex}}-video-play" class="play-icon icon icon-play3 white"></a>    <div class="play-bg"></div></div><div class="video-pack">    <a data-tap="page-{{pageIndex}}-video-close" class="close"></a>    <div id="page-{{pageIndex}}-video-player" class="i">    </div></div>'}(e.exports,e,t);t.__modules__.c4999f50=e.exports}(this),function(t){var e={id:"c4972e50",exports:{}};t.__modules__||(t.__modules__={});!function(t,e,i){Fui.Template.Video=Fui.Template.extend({className:"module module-video",config:{tpl:i.__modules__.c4999f50,videoPackCss:null,playBtnCss:null,closeBtnCss:null,platform:null,clientId:"3e9659d488a5a018",vid:null,width:640,whRatio:16/9},listeners:{play:function(){function t(){if(YKU){var t=e.player=new YKU.Player("page-"+e.get("pageIndex")+"-video-player",{styleid:"0",client_id:e.get("clientId"),vid:e.get("vid"),autoplay:!0,show_related:!1,events:{onPlayerReady:function(){},onPlayStart:function(){},onPlayEnd:function(){e.trigger("close")}}});setTimeout(function(){try{t.playVideo()}catch(e){}},200)}}var e=this,i=e.get("platform");switch(this.$videoPack.addClass("show"),i){case"youku":t()}},close:function(){this.$videoPack.removeClass("show");try{}catch(t){}}},render:function(){var t=this,e=t.$videoPack=t.$el.children(".video-pack"),i=e.children(".i");e.css(t.get("videoPackCss")||{}),t.$el.find(".video-pack>.close").css(t.get("closeBtnCss")||{}),t.$el.find(".play-icon").css(t.get("playBtnCss")||{}),i.css({width:t.get("width"),height:t.get("width")/t.get("whRatio")})},getGestureItems:function(){var t=this;return[{gesture:"tap",name:"page-"+t.get("pageIndex")+"-video-play",callback:function(){t.trigger("play")},caller:t},{gesture:"tap",name:"page-"+t.get("pageIndex")+"-video-close",callback:function(){t.trigger("close")},caller:t}]},save:function(t){var e=this,i=e.getForm(),n=e.getData();new Fui.FileUpload({file:n.bg,name:"bg",listeners:{end:function(e,n){console.log(arguments),i.setData(n,e),t(!0)},error:function(){t(!1)}}})},getFormItems:function(){var t=this,e=this.$el;return[{type:"ImagePicker",label:"背景：",name:"bg",listeners:{change:function(t,i){e.css({backgroundImage:"url("+i.src+")"})},clear:function(){t.clearBg()}}},{type:"Select",label:"播放按钮样式：",data:[{text:"样式一",value:0,checked:!0},{text:"样式二",value:1},{text:"样式三",value:2}],name:"playIconStyle",listeners:{change:function(){}}},{type:"Select",label:"播放平台",name:"platform",data:[{text:"优酷",value:"youku",checked:!0},{text:"腾讯",value:"qq"}],listeners:{change:function(e){t.set("platform",e)}}},{type:"Text",label:"视频ID",name:"vid",placeHolder:"优酷视频的ID(vid)",listeners:{valueChanged:function(e){t.set("vid",e)}}}]}})}(e.exports,e,t);t.__modules__.c4972e50=e.exports}(this),function(t){var e={id:"c49b4d00",exports:{}};t.__modules__||(t.__modules__={});!function(t,e){e.exports='<a class="phtots-arrow photos-l-arrow"></a><a class="phtots-arrow photos-r-arrow"></a><div class="photos-pack">    {{#each imgList}}        <img class="normal" data-leftSwipe="page-{{../pageIndex}}-photos-item" data-rightSwipe="page-{{../pageIndex}}-photos-item" src="{{this}}"/>    {{/each}}</div>'}(e.exports,e,t);t.__modules__.c49b4d00=e.exports}(this),function(t){var e={id:"c499c660",exports:{}};t.__modules__||(t.__modules__={});!function(t,e,i){Fui.Template.Photos=Fui.Template.extend({className:"module module-photos",config:{tpl:i.__modules__.c49b4d00,data:null,index:0},onPopFlag:!0,render:function(){{var t=this,e=t.$el;t.$pack=e.children(".photos-pack"),t.get("data")||[]}this.ensureTop3Rotate()},save:function(t){function e(){2==++a&&t(!0)}var i=this,n=i.getForm(),s=n.getData(),a=0;_.each(s,function(i,s){new Fui.FileUpload({file:i,name:s,listeners:{end:function(t,i){n.setData(i,t),e()},error:function(){t(!1)}}})})},onFocus:function(){var t=this;t.$pack.addClass("focus").one("webkitTransitionEnd",function(){t.$el.addClass("ani")})},onBlur:function(){this.$pack.removeClass("focus"),this.$el.removeClass("ani")},ensureTop3Rotate:function(){var t=this.$pack.children(),e=t.last();t.removeClass("pre1 pre2"),e.addClass("pre1").prev().addClass("pre2")},getTplData:function(){var t=this,e=t.get("data");return{pageIndex:t.get("pageIndex"),imgList:e}},pop:function(t){var e=this,i=e.$pack,n=i.children("img");if(e.onPopFlag){e.onPopFlag=!1;var s=n.last();s.addClass(t).one("webkitTransitionEnd",function(){i.prepend(s.removeClass(t)),e.ensureTop3Rotate(),e.onPopFlag=!0})}},getGestureItems:function(){var t=this,e=t.get("pageIndex"),i=["page",e,"photos","item"].join("-");return[{gesture:"leftSwipe",name:i,callback:function(){t.pop("afterL")
}},{gesture:"rightSwipe",name:i,callback:function(){t.pop("afterR")}}]},addImg:function(t,e){var i=this,n=i.$pack.children().eq(e);n.length>0?n.attr("src",t):i.$pack.append(Handlebars.compile('<img class="normal" data-form-image-list-item="{{index}}" data-leftSwipe="page-{{pageIndex}}-photos-item" data-rightSwipe="page-{{pageIndex}}-photos-item" src="{{src}}"/>')({index:e,src:t,pageIndex:i.get("pageIndex")})),this.ensureTop3Rotate()},removeImg:function(t){this.$pack.children("[data-form-image-list-item="+t+"]").remove(),this.ensureTop3Rotate()},getFormItems:function(){{var t=this;t.$pack}return[{type:"ImagePicker",name:"bg",label:"背景图片：",listeners:{change:function(e,i){t.renderBg(i.src)},clear:function(){t.clearBg()}}},{type:"ImageListPicker",name:"imageList",listeners:{change:function(e,i,n){t.addImg(i.src,n)},itemRemove:function(e){t.removeImg(e)}}}]}})}(e.exports,e,t);t.__modules__.c499c660=e.exports}(this),function(t){var e={id:"c4955990",exports:{}};t.__modules__||(t.__modules__={});!function(t,e,i){i.__modules__.c495a7b0,i.__modules__.c4966b00,i.__modules__.c4972e50,i.__modules__.c499c660}(e.exports,e,t);t.__modules__.c4955990=e.exports}(this),function(t){var e={id:"c49cd3a0",exports:{}};t.__modules__||(t.__modules__={});!function(){Fui.Arrow=Fui.extend({tagName:"a",config:{orient:"bottom",color:"white"},initialize:function(){var t=this,e=t.get("orient"),i={position:"absolute",zIndex:1030,border:"2px solid "+t.get("color"),borderRight:0,borderBottom:0,width:36,height:36,webkitAnimation:t.get("orient")+"Arrow 2s linear infinite"},n={};switch(e){case"top":n={left:"50%",top:30,marginLeft:-18};break;case"left":n={top:"50%",left:30,marginTop:-18};break;case"right":n={top:"50%",right:30,marginTop:-18};break;case"bottom":n={left:"50%",bottom:30,marginLeft:-18}}_.extend(i,n),this.$el.css(i)}})}(e.exports,e,t);t.__modules__.c49cd3a0=e.exports}(this),function(t){var e={id:"c49b7410",exports:{}};t.__modules__||(t.__modules__={});!function(t,e,i){i.__modules__.c49cd3a0,Fui.PageSlider=Fui.extend({fid:"PageSlider",config:{index:-1,preIndex:-1,pageNum:0,curPage:0,lock:!1,data:null,toggleCls:"focus",arrow:"bottom",orient:"v"},appData:null,data:null,gestureItems:[],fg:null,arrowWithout:"",getImgPath:function(t){return t},initialize:function(){{var t=this;t.$el}this.render(),this.event=new Fui.Event({hoster:this});var e=this.get("arrow");if(e){_.isString(e)&&(e={orient:e,without:[]});var i=this.arrow=new Fui.Arrow({orient:e.orient});this.arrowWithout=_.isArray(e.without)?"-"+e.without.join("-")+"-":"",this.$el.append(i.$el)}var n=(this.get("appData"),this.get("data"));_.isArray(n)?(_.each(n,function(e,i){var s=Fui.Template[e.template];if(_.isFunction(s)){var a=$(t.getOnePageLI(i));t.$ul.append(a),e.pageIndex=i,e.el=a;var o=new s(e);o.render(),n.splice(i,1,o)}}),this.set("pageNum",n.length)):this.set("data",[]),setTimeout(function(){t.slide(t.get("curPage"))},10)},onTouchStart:Fui.emptyFunc,onTouchMove:Fui.emptyFunc,onTouchEnd:Fui.emptyFunc,onTap:Fui.emptyFunc,ensureLayout:function(){var t=this,e=t.$ul,i=t.get("pageNum");e.css({height:i+"00%"}),e.children("li").css(t.getLICss())},getLICss:function(){return{height:100/this.get("pageNum")+"%",backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center top",position:"relative"}},events:{pageNumchanged:function(){this.ensureLayout()}},pageMap:{},getOnePageLI:function(t){return Handlebars.compile('<li class="p p{{index}}"></li>')({index:t})},insert:function(t,e){var i=this,n=i.$ul,s=i.get("pageNum")+1,a=i.get("data"),o=Fui.Template[t];if(0>e&&(e=0),e>s&&(e=s),!_.isFunction(o))return error(t+" is not loaded !"),!1;var r=$(i.getOnePageLI(e)),d=new o({pageIndex:e,template:t,el:r[0]});d.render(),0==e?n.prepend(r):r.insertAfter(n.children().eq(e-1));var l=a.slice(0,e),h=a.slice(e);return i.set("data",l.concat([d],h)),i.set("pageNum",s),d},render:function(){var t=this,e=t.$el,i=t.$ul=$('<ul class="c"></ul>');e.append(i),e.css({position:"relative",width:640,height:"100%",overflow:"hidden",boxSizing:"border-box",margin:"0 auto"}),this.ensureLayout()},ontransitionend:function(){},onslide:function(){},onswipe:function(){},onSlide:function(){},onSlideEnd:function(){},onGesture:function(t,e,i){var n=this,s=n.get("data"),a=[],o=null;_.each(s,function(t){a=a.concat(t.getGestureItems())}),e=e||"",e=e.split("@");for(var r=0,d=a.length;d>r;r++)if(o=a[r],t==o.gesture&&o.name==e[0]&&_.isFunction(o.callback)){o.callback.call(null,i,e[1]);break}},doSlide:function(t){var e=this,i=e.$ul,n=e.get("pageNum"),s=e.get("orient"),a="";return"v"==s&&(a="0,-"+100*t/n+"%,0"),"h"==s&&(a="-"+100*t/n+"%,0,0"),i.css({webkitTransition:"-webkit-transform .3s ease-in-out",webkitTransform:"translate3d("+a+")"}),i},slide:function(t,e){var i=this,n=i.$ul,s=i.get("pageNum");t==i.get("index")||0>t||t>=s||(i.set("preIndex",i.get("index")),i.set("index",t),!1!==i.onSlide(t,e)&&(this.arrow instanceof Fui&&this.arrowWithout.indexOf("-"+t+"-")>=0?this.arrow.hide():this.arrow.show(),i.doSlide(t,e).one("webkitTransitionEnd",function(e){n.children("li").eq(t).addClass("focus").siblings("li").removeClass("focus");var s=i.get("data"),a=i.get("preIndex"),o=s[t],r=s[a];o&&_.isFunction(o.onFocus)&&o.onFocus(),r&&_.isFunction(r.onBlur)&&r.onBlur(),i.onSlideEnd(t,e)})))},next:function(t){var e=this,i=e.get("index");e.slide(++i,t)},prev:function(t){var e=this.get("index");this.slide(--e,t)},_onstart:function(t){t.stopPropagation(),Fui.client.andrioid_version>=4.4&&t.preventDefault(),this.onTouchStart(t)},_onmove:function(t){t.stopPropagation(),Fui.client.andrioid_version>=4.4&&t.preventDefault(),this.onTouchMove(t)},_onend:function(t){t.stopPropagation(),Fui.client.andrioid_version>=4.4&&t.preventDefault();var e=this,i=e.event,n=e.get("orient"),s=e.gesture=i.gesture,a=$(t.target);if(this.onTouchEnd(t),$("body").scrollTop(0),e.onGesture(s,a.attr("data-"+s),t),!0!==e.get("lock")){if("v"==n)switch(i.gesture){case"topSwipe":e.next(t);break;case"bottomSwipe":e.prev(t)}if("h"==n)switch(i.gesture){case"leftSwipe":e.next(t);break;case"rightSwipe":e.prev(t)}}},_ontap:function(t){this.onTap(t)}})}(e.exports,e,t);t.__modules__.c49b7410=e.exports}(this),function(t){var e={id:"c49d48d0",exports:{}};t.__modules__||(t.__modules__={});!function(){Fui.PageSliderFade=Fui.PageSlider.extend({fid:"PageSliderFade",config:{index:0,pageNum:0,curPage:0,toggleCls:"focus",lock:!1,orient:"v"},ensureLayout:function(){{var t=this,e=t.$ul;t.get("pageNum")}e.css({position:"absolute",top:0,left:0,right:0,bottom:0}).children("li").css({position:"absolute",top:0,left:0,right:0,bottom:0,opacity:0,backgroundSize:"cover"})},doSlide:function(t){{var e=this,i=e.$ul;e.get("pageNum")}return i.children("li").eq(t).css({webkitTransition:"opacity .3s ease-in-out",opacity:1,zIndex:1}).siblings("li").css({webkitTransition:"opacity .3s ease-in-out",opacity:0,zIndex:0}),i}})}(e.exports,e,t);t.__modules__.c49d48d0=e.exports}(this),function(t){var e={id:"c49b4d01",exports:{}};t.__modules__||(t.__modules__={});!function(t,e,i){i.__modules__.c49b7410,i.__modules__.c49d48d0}(e.exports,e,t);t.__modules__.c49b4d01=e.exports}(this),function(__ctx){var module={id:"c49d96f0",exports:{}};__ctx.__modules__||(__ctx.__modules__={});var r=function(exports,module,global){!function(){var consoleBak=console;!function(){function w(t){var e=document.createElement("script");e.type="text/javascript",e.src=t,document.getElementsByTagName("head")[0].appendChild(e)}function na(t){if(!t)return"";var e,i,n,s,a,t=t.toString(),o=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1];for(s=t.length,n=0,a="";s>n;){do e=o[255&t.charCodeAt(n++)];while(s>n&&-1==e);if(-1==e)break;do i=o[255&t.charCodeAt(n++)];while(s>n&&-1==i);if(-1==i)break;a+=String.fromCharCode(e<<2|(48&i)>>4);do{if(e=255&t.charCodeAt(n++),61==e)return a;e=o[e]}while(s>n&&-1==e);if(-1==e)break;a+=String.fromCharCode((15&i)<<4|(60&e)>>2);do{if(i=255&t.charCodeAt(n++),61==i)return a;i=o[i]}while(s>n&&-1==i);if(-1==i)break;a+=String.fromCharCode((3&e)<<6|i)}return a}function E(t,e){for(var i,n=[],s=0,a="",o=0;256>o;o++)n[o]=o;for(o=0;256>o;o++)s=(s+n[o]+t.charCodeAt(o%t.length))%256,i=n[o],n[o]=n[s],n[s]=i;for(var r=s=o=0;r<e.length;r++)o=(o+1)%256,s=(s+n[o])%256,i=n[o],n[o]=n[s],n[s]=i,a+=String.fromCharCode(e.charCodeAt(r)^n[(n[o]+n[s])%256]);return a}function F(t,e){for(var i=[],n=0;n<t.length;n++){for(var s=0,s="a"<=t[n]&&"z">=t[n]?t[n].charCodeAt(0)-97:t[n]-0+26,a=0;36>a;a++)if(e[a]==s){s=a;break}i[n]=s>25?s-26:String.fromCharCode(s+97)}return i.join("")}function oa(t){function e(t,e){return t<<e|t>>>32-e}function i(t){var e,i,n="";for(e=7;e>=0;e--)i=t>>>4*e&15,n+=i.toString(16);return n}var n,s,a,o,r,d,l,h=Array(80),c=1732584193,u=4023233417,p=2562383102,f=271733878,g=3285377520,t=function(t){for(var t=t.replace(/\r\n/g,"\n"),e="",i=0;i<t.length;i++){var n=t.charCodeAt(i);128>n?e+=String.fromCharCode(n):(n>127&&2048>n?e+=String.fromCharCode(n>>6|192):(e+=String.fromCharCode(n>>12|224),e+=String.fromCharCode(n>>6&63|128)),e+=String.fromCharCode(63&n|128))}return e}(t);a=t.length;var v=[];for(n=0;a-3>n;n+=4)s=t.charCodeAt(n)<<24|t.charCodeAt(n+1)<<16|t.charCodeAt(n+2)<<8|t.charCodeAt(n+3),v.push(s);switch(a%4){case 0:n=2147483648;break;case 1:n=t.charCodeAt(a-1)<<24|8388608;break;case 2:n=t.charCodeAt(a-2)<<24|t.charCodeAt(a-1)<<16|32768;break;case 3:n=t.charCodeAt(a-3)<<24|t.charCodeAt(a-2)<<16|t.charCodeAt(a-1)<<8|128}for(v.push(n);14!=v.length%16;)v.push(0);for(v.push(a>>>29),v.push(a<<3&4294967295),t=0;t<v.length;t+=16){for(n=0;16>n;n++)h[n]=v[t+n];for(n=16;79>=n;n++)h[n]=e(h[n-3]^h[n-8]^h[n-14]^h[n-16],1);for(s=c,a=u,o=p,r=f,d=g,n=0;19>=n;n++)l=e(s,5)+(a&o|~a&r)+d+h[n]+1518500249&4294967295,d=r,r=o,o=e(a,30),a=s,s=l;for(n=20;39>=n;n++)l=e(s,5)+(a^o^r)+d+h[n]+1859775393&4294967295,d=r,r=o,o=e(a,30),a=s,s=l;for(n=40;59>=n;n++)l=e(s,5)+(a&o|a&r|o&r)+d+h[n]+2400959708&4294967295,d=r,r=o,o=e(a,30),a=s,s=l;for(n=60;79>=n;n++)l=e(s,5)+(a^o^r)+d+h[n]+3395469782&4294967295,d=r,r=o,o=e(a,30),a=s,s=l;c=c+s&4294967295,u=u+a&4294967295,p=p+o&4294967295,f=f+r&4294967295,g=g+d&4294967295}return l=i(c)+i(u)+i(p)+i(f)+i(g),l.toLowerCase()}function x(t,e){if("js"==e){var i=document.createElement("script");i.setAttribute("type","text/javascript"),i.setAttribute("src",t)}else"css"==e&&(i=document.createElement("link"),i.setAttribute("rel","stylesheet"),i.setAttribute("type","text/css"),i.setAttribute("href",t));"undefined"!=typeof i&&document.getElementsByTagName("head")[0].appendChild(i)}function P(){return d.isAndroid?d.isAndroid4?"adr4":"adr":d.isIPHONE?"iph":d.isIPAD?"ipa":d.isIPOD?"ipo":"oth"}function y(t){return d.isIPAD&&0<=window.location.href.indexOf("v.youku.com")?"x-player":200>=t?"x-player x-player-200":300>=t?"x-player x-player-200-300":660>=t?"x-player x-player-300-660":800>=t?"x-player x-player-660-800":"x-player"}VER="2013/12/2713:55:33",VER="2014/08/2518:26:49",DEBUG__=0,0!=DEBUG__&&window.console||(window.console={},window.console.log=function(){}),debug={log:function(t){null!=document.getElementById("debug")&&(document.getElementById("debug").innerHTML+=t+" | ")}};var b={},B={},d={playerType:"",uniplayerUrl:"http://passport-log.youku.com/logsys/logstorage/append?project=uniplayer&log=",MPIECEURL:"http://passport-log.youku.com/logsys/logstorage/append?project=mpiece&log=",userCache:{a1:"4",a2:"1"},playerState:{PLAYER_STATE_INIT:"PLAYER_STATE_INIT",PLAYER_STATE_READY:"PLAYER_STATE_READY",PLAYER_STATE_AD:"PLAYER_STATE_AD",PLAYER_STATE_PLAYING:"PLAYER_STATE_PLAYING",PLAYER_STATE_END:"PLAYER_STATE_END",PLAYER_STATE_ERROR:"PLAYER_STATE_ERROR"},playerCurrentState:"PLAYER_STATE_INIT",Log:function(t,e){var i=document.createElement("img");e&&i.addEventListener("error",e,!1),i.src=t+"&r_="+Math.floor(1e4*Math.random()),i.id="youku-uniplayer-stat"},isNeedAdrTrick:function(){return d.isAndroid&&!d.adrPlayTrick&&!d.isHTC&&d.isNeedFrontAd&&!d.isVIVO},adrInvalidPauseCheck:function(t){var e=t.currentTime,i=0,n=!1;d.adrPlayTrick=!0,t.pause(),t.play(),setInterval(function(){t.currentTime!=e||n?n=!0:(i++,t.play(),0==i%10&&(t.load(),t.play()))},1e3)},sendErrorReport:function(t){var e={},i="",i=d.isIPAD?"xplayer_ipad":d.isIPHONE?"xplayer_iphone":"xplayer_android";e.m=i,e.ec=t,i="",1e3==t&&(i=b.v.data[0].error_code),e.gc=i,e.u=encodeURIComponent(window.location.href),e.v=b.videoInfo?b.videoInfo._sid:"",e.ct=b.v?b.v.data[0].ct:"",e.cs=b.v?b.v.data[0].cs:"",e.hd=d.hd?d.hd:0,e.a=b.v?b.v.controller.area_code+"|"+b.v.controller.dma_code:"",t="",b.initConfig.vvlogconfig&&b.initConfig.vvlogconfig.pvid&&(t=b.initConfig.vvlogconfig.pvid),e.pid=t,d.Log("http://v.l.youku.com/perror?"+n(e))},uniReport:function(t){t.partner=b.initConfig.client_id,t.os=escape(d.os),t.mios=d.isMobileIOS,t.adrd4=d.isAndroid4,t.mobile=d.isMobile,t.adrpad=d.isAndroidPad,0==t.mobile&&(t.ua=escape(navigator.userAgent.replace(/[\/\+\*@\(\)\,]/g,""))),t.version=VER.replace(/[-: ]/g,""),d.Log(d.uniplayerUrl+q(t))},Load:function(t,e){if("js"==e){var i=document.createElement("script");i.setAttribute("type","text/javascript"),i.setAttribute("src",t)}else"css"==e&&(i=document.createElement("link"),i.setAttribute("rel","stylesheet"),i.setAttribute("type","text/css"),i.setAttribute("href",t));"undefined"!=typeof i&&document.getElementsByTagName("head")[0].appendChild(i)},showError:function(t,e){var i=b.get("#x-player");i.innerHTML=e?e:"该视频格式特殊，请在PC上观看",i.style.textAlign="center",i.style.color="white",i.style.lineHeight=i.offsetHeight+"px",b.playerEvents&&b.playerEvents.onPlayError&&b.playerEvents.onPlayError(e?e:"该视频格式特殊，请在PC上观看")}};!function(){var t=document.createElement("video"),e={MP4:"video/mp4",OGG:"video/ogg",WEBM:"video/webm"},i={isWin:"Win",isMac:"Mac",isSafari:"Safari",isChrome:"Chrome",isIPAD:"iPad",isIPAD7:"iPad; CPU OS 7",isIPHONE:"iPhone",isIPOD:"iPod",isLEPAD:"lepad_hls",isMIUI:"MI-ONE",isAndroid:"Android",isAndroid4:"Android 4.",isAndroid41:"Android 4.1",isSonyDTV:"SonyDTV",isBlackBerry:"BlackBerry",isMQQBrowser:"MQQBrowser",isMobile:"Mobile",isSamSung:"SAMSUNG",isHTC:"HTC",isVIVO:"vivo"};if(d.supportHTML5Video=!1,d.isIOS=!1,d.os="",t.canPlayType){d.supportHTML5Video=!0;for(var n in e)d["canPlay"+n]=t.canPlayType(e[n])?!0:!1}for(var s in i)-1!==navigator.userAgent.indexOf(i[s])?(d[s]=!0,d.os+=i[s]+" "):d[s]=!1,-1!==navigator.userAgent.indexOf("Android")&&(t=navigator.userAgent.indexOf("Android"),t=navigator.userAgent.substr(t,10),t>i.isAndroid4&&(d.isAndroid4=!0,d.os+=t+" "));d.isMobileIOS=d.isIPAD||d.isIPHONE||d.isIPOD,d.isIOS=d.isMobileIOS||d.isMac,d.isSupportH5M3U8=d.isMobileIOS||d.isMac&&d.isSafari&&!d.isChrome||d.isLEPAD||d.isSonyDTV,d.isSupportH5MP4=(d.isChrome||d.isIE10||d.isAndroid41||d.isAndroid4)&&d.canPlayMP4,s=i=0;try{if(document.all){var a=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");a&&(i=1,VSwf=a.GetVariable("$version"),parseInt(VSwf.split(" ")[1].split(",")[0]))}else if(navigator.plugins&&0<navigator.plugins.length&&(a=navigator.plugins["Shockwave Flash"]))for(var i=1,o=a.description.split(" "),a=0;a<o.length;++a)isNaN(parseInt(o[a]))||parseInt(o[a])}catch(r){s=i=1}d.isSupportFlash=i&&!s,d.isMQQBrowser&&(d.isSupportFlash=!1),d.isPhone=d.isIPHONE||d.isIPOD||d.isAndroid&&d.isMobile,d.isAndroidPad=d.isAndroid&&!d.isMobile,d.isPad=d.isIPAD||d.isAndroidPad,d.isMobile=d.isIPAD||d.isIPHONE||d.isIPOD||d.isLEPAD||d.isMIUI||d.isAndroid4||d.isSonyDTV}();var I=function(a){debug.log("canplay mp4 = "+d.canPlayMP4),b.initConfig=a,this._vid=a.vid,this._target=a.target,this._partnerId=a.partnerId,a.client_id&&(this._partnerId=a.client_id),this._vid&&this._target&&this._partnerId?(this._events=a.events,b.playerEvents=a.events,d._target=this._target,this._paid=0,null!=a.paid&&(this._paid=a.paid),this._id=a.id,null==this._id&&(this._id="youku-player"),d.playerId=this._id,this._width=a.width,this._height=a.height,this._expand=a.expand,null==a.width||null==a.height?null==a.expand&&(this._expand=0):null==a.expand&&(this._expand=1),this._prefer=a.prefer?a.prefer.toLowerCase():"flash",this._starttime=a.starttime,this._password=a.password,this._poster=a.poster,this._autoplay=eval(a.autoplay),this._canWide=a.canWide,this._showRelated=a.show_related,this._winType=a.wintype,this._playlistconfig=a.playlistconfig,this._isMobile=d.isMobile,this._isMobileIOS=d.isMobileIOS,this._playerType="",b.mk={},b.mk.a3="b4et",b.mk.a4="boa4"):alert("[Fail]The params of {vid,target,client_id} are necessary !")};I.prototype={isSupportH5MP4:function(){return d.isSupportH5MP4},isSupportH5M3U8:function(){return d.isSupportH5M3U8},isSupportFlash:function(){return d.isSupportFlash},playerType:function(){return""!=this._playerType?this._playerType:(this._playerType="h5"==this._prefer?this.isSupportH5M3U8()?"h5m3u8":this.isSupportH5MP4()?"h5mp4":this.isSupportFlash()?"flash":"error":"flash"==this._prefer?this.isSupportFlash()?"flash":this.isSupportH5M3U8()?"h5m3u8":this.isSupportH5MP4()?"h5mp4":"error":"error",window.console&&console.log&&console.log("playerType = "+this._playerType),this._playerType)},select:function(){if(debug.log("playerType = "+this.playerType()),this.isThirdParty()){var t=this;this.processThirdParty(function(){t.selectHandler()})}else this.selectHandler()},selectHandler:function(){if("h5m3u8"==this.playerType()?(this.selectH5M3U8(),l.appendItem("phase","type_h5m3u8")):"h5mp4"==this.playerType()?(this.selectH5MP4(),l.appendItem("phase","type_h5mp4")):"flash"==this.playerType()?(this.selectFlash(),l.appendItem("phase","type_flash")):(this.selectDirectUrl(),l.appendItem("phase","type_directurl")),this._events&&this._events.onPlayerReady){var t=this._events.onPlayerReady;if("h5"==d.playerType)var e=setInterval(function(){if($$$(d.playerId)){d.playerCurrentState=d.playerState.PLAYER_STATE_READY,debug.log(d.playerCurrentState),clearInterval(e);try{l.appendItem("phase","playerready"),t()}catch(i){}}},500);else"flash"==d.playerType&&(e=setInterval(function(){if(1==B.swfLoaded){d.playerCurrentState=d.playerState.PLAYER_STATE_READY,debug.log(d.playerCurrentState),clearInterval(e);try{l.appendItem("phase","playerready"),t()}catch(i){}}},500))}},selectH5MP4:function(){d.uniReport({mp4:1}),d.playerType="h5";var t=this._h5player=new YoukuHTML5Player({id:this._id,vid:this._vid,partnerId:this._partnerId,parentBox:this._target,events:this._events,width:this._width,height:this._height,poster:this._poster,autoplay:this._autoplay,isMobile:this._isMobile,isMobileIOS:this._isMobileIOS,content:"mp4",wintype:this._winType,expand:this._expand,partner_config:this.partner_config,canWide:this._canWide?this._canWide:0});d.GetMP4OK=function(e,i){l.appendItem("phase","vinfo_mp4"),t.startPlay(e,i),b.initConfig.events.onMediaSrcOK&&b.initConfig.events.onMediaSrcOK(m,i._videoSegsDic[m][0].src)},i.playlistconfig=this._playlistconfig,i.start(this._vid,this._password,"mp4")},selectH5M3U8:function(){d.uniReport({m3u8:1}),d.playerType="h5";var t={id:this._id,vid:this._vid,partnerId:this._partnerId,parentBox:this._target,events:this._events,width:this._width,height:this._height,poster:this._poster,autoplay:this._autoplay,isMobile:this._isMobile,isMobileIOS:this._isMobileIOS,content:"m3u8",wintype:this._winType,expand:this._expand,partner_config:this.partner_config,canWide:this._canWide?this._canWide:0};(d.isIPHONE||d.isIPOD)&&(t.playType="directsrc");var e=new YoukuHTML5Player(t);this._h5player=e,d.GetM3U8OK=function(t,i){l.appendItem("phase","vinfo_m3u8"),console.log("videoinfo src = "+i.src),e.startPlay(t,i)},i.playlistconfig=this._playlistconfig,i.start(this._vid,this._password,"m3u8")},processThirdParty:function(t){var e=new Q({client_id:b.initConfig.client_id,video_id:b.initConfig.vid,embsig:b.initConfig.embsig,refer:escape(window.location.href)}),i=this;e.addEventListener(PartnerConstant.OPEN_API_OK,function(e){debug.log("thirdparty res ok"),i.partner_config=e.data,t()}),e.addEventListener(PartnerConstant.OPEN_API_ERROR,function(){debug.log("thirdparty res error"),t()}),e.addEventListener(PartnerConstant.OPEN_API_TIME_OUT,function(){debug.log("thirdparty res timeout"),t()})},selectH5VTag:function(){d.playerType="h5";var t="http://v.youku.com/player/getM3U8/vid/"+this._vid+"/type/mp4/ts/"+parseInt((new Date).getTime()/1e3),t=t+(this._password?"/password/"+this._password:""),t='<video src="'+(t+"/v.m3u8")+'" controls width='+this._width+" height="+this._height+" id="+this._id+" autohide=false "+(this._poster?"poster="+this._poster:"")+" "+(1==this._autoplay?"autoplay=true":"")+"></video>";$$$(this._target).innerHTML=t},isThirdParty:function(){var t=b.initConfig.client_id;return null!=t&&16==(t+"").length},selectFlash:function(){d.uniReport({flash:1}),d.playerType="flash";var t={imglogo:this._poster||"",paid:this._paid,partnerId:b.initConfig.client_id};null!=b.initConfig.firsttime&&(t.firsttime=b.initConfig.firsttime),null!=this._autoplay&&(t.isAutoPlay=this._autoplay),null!=b.initConfig.embsig&&(t.embsig=b.initConfig.embsig),null!=this._showRelated&&(t.isShowRelatedVideo=this._showRelated),null!=b.initConfig.password&&(t.passwordstr=b.initConfig.password),null!=b.initConfig.styleid&&(t.styleid=b.initConfig.styleid),null!=b.initConfig.vext&&(t.vext=b.initConfig.vext);for(var e in b.initConfig.adconfig)t[e]=b.initConfig.adconfig[e];for(e in b.initConfig.flashconfig)t[e]=b.initConfig.flashconfig[e];e="",this.isThirdParty()&&(e="/partnerid/"+this._partnerId),t.delayload&&(e="");var i="";null!=this._winType&&""!=this._winType&&(i="/winType/"+this._winType),e="http://player.youku.com/player.php/sid/"+this._vid+e+i+"/v.swf",b.initConfig.flashsrc&&(e=b.initConfig.flashsrc),t=n(t),$$$(this._target).innerHTML="<object type=application/x-shockwave-flash data= "+e+" width=100% height=100% id="+this._id+"><param name=allowFullScreen value=true><param name=allowScriptAccess value=always><param name=movie value="+e+"><param name=flashvars value="+t+">"+(b.initConfig.flashext||"")+"</object>",this._expand&&($$$(this._target).style.width=this._width+"px",$$$(this._target).style.height=this._height+"px")},selectDirectUrl:function(t){t=t||"mp4",debug.log("select directsrc"),d.uniReport({direct:1}),d.playerType="directsrc";var e=new DirectPlayer({id:this._id,vid:this._vid,partnerId:this._partnerId,parentBox:this._target,events:this._events,width:this._width,height:this._height,poster:this._poster,autoplay:this._autoplay,isMobile:this._isMobile,isMobileIOS:this._isMobileIOS,content:t,playType:"directsrc",wintype:this._winType,expand:this._expand,canWide:this._canWide?this._canWide:0});this._h5player=e,i.playlistconfig=this._playlistconfig,i.start(this._vid,this._password,t,function(t,i){e.startPlay(t,i)})},selectError_:function(t,e){d.uniReport({error:1}),(this._width||this._height)&&($$$(this._target).style.width=this._width+"px",$$$(this._target).style.height=this._height+"px"),d.playerType="error",d.showError(this._target,t,e)}},B.Player=function(t,e){e.target=t,this.select=new I(e),this.select.select(),this._player=""},B.Player.prototype={player:function(){return""!=this._player?this._player:this._player="h5"==d.playerType?new R(this.select._h5player):"flash"==d.playerType?new S:"error"},resize:function(t,e){this.player().resize(t,e)},currentTime:function(){return this.player().currentTime()},totalTime:function(){return this.player().totalTime()},playVideo:function(){this.player().playVideo()},pauseVideo:function(){this.player().pauseVideo()},seekTo:function(t){this.player().seekTo(t)},hideControls:function(){this.player().hideControls()},showControls:function(){this.player().showControls()},playVideoById:function(t){this.player().playVideoById(t)},switchFullScreen:function(){try{this.player().switchFullScreen()}catch(t){}}};var S=function(){this._player=document.getElementById(d.playerId)};S.prototype={resize:function(t,e){this._player.style.width=t+"px",this._player.style.height=e+"px"},currentTime:function(){var t=this._player.getPlayerState().split("|");return 3<=t.length?t[2]:-1},totalTime:function(){var t=this._player.getPlayerState().split("|");return 4<=t.length?t[3]:-1},playVideo:function(){this._player.pauseVideo(!1)},pauseVideo:function(){this._player.pauseVideo(!0)},seekTo:function(t){this._player.nsseek(t)},playVideoById:function(t){this._player.playVideoByID(t)},hideControls:function(){this._player.showControlBar(!1)},showControls:function(){this._player.showControlBar(!0)}},PartnerConstant={OPEN_API_URL:"https://openapi.youku.com/v2/players/custom.json",OPEN_API_OK:"openapiokyouku",OPEN_API_TIME_OUT:"openapitimeoutyouku",OPEN_API_ERROR:"openapierror"};var Q=function(t){this._handler={},window.partnerinfo=this,t.callback="partnerinfo.parse",t=n(t),w(PartnerConstant.OPEN_API_URL+"?"+t);var e=this;setTimeout(function(){e._hasResp||e.dispatch({type:PartnerConstant.OPEN_API_TIME_OUT})},2e3)};Q.prototype={addEventListener:function(t,e){this._handler[t]=e},removeEventListener:function(t){this._handler[t]=null},dispatch:function(t){t&&this._handler[t.type]&&(t._target=this,this._handler[t.type](t))},parse:function(t){this._hasResp=!0,this.dispatch(null!=t.error||1!=t.status?{type:PartnerConstant.OPEN_API_ERROR}:{type:PartnerConstant.OPEN_API_OK,data:t})}};var i={},z={},C=[];i.mp4srcs=[],i.start=function(t,e,i,n){if(this._callback=n,null==this._callback)switch(this._type){case"m3u8":this._callback=d.GetM3U8OK;break;case"mp4":this._callback=d.GetMP4OK;break;default:this._callback=d.GetM3U8OK}null!=z[t]&&null!=z[t][i]?(console.log("Cache Hit vid = "+t),this._callback(z[t][i].v,z[t][i].videoInfo)):(this._vid=t,this._password=e,this._type=i,this._videoInfo=null,this._url="",this.mp4srcs=[],this.request())},i.cache=function(){z[i._vid]={},z[i._vid][i._type]={v:this._v,videoInfo:this._videoInfo}},i.getPlayListUrl=function(){var t,e="http://v.youku.com/player/getPlayList/VideoIDS/"+this._vid,e=e+"/Pf/4/ctype/12/ev/1";for(t in this.playlistconfig)e+="/"+t+"/"+this.playlistconfig[t];return e+"?"},i.error=function(t){t||(t=0),d.sendErrorReport(0),d.uniReport({error:t,vid:b.initConfig.vid}),d.showError(b.config.parentBox,"该视频暂时不能播放,请下载APP或在PC上观看",320)},i.reportPlayListUep=function(){var t=(new Date).getTime()-this._plreqStartTime;C.push({type:"getplaylist",time:t})},i.response=function(t){this.playlistError||(this.playlistOK=!0,this.reportPlayListUep(),(b.v=t)&&t.data&&t.data[0]&&!0!==t.data[0].rtmp&&!0!==t.data[0].drm?this.init(t):this.error(1,t,t.data,t.data[0]))},i.request=function(){this._url=this.getPlayListUrl(),this._password&&(this._url+="password="+escape(this._password),this._url+="&"),this._password&&b.initConfig.client_id&&b.config.partner_config&&1==b.config.partner_config.status&&1==b.config.partner_config.passless&&(this._url+="client_id="+b.initConfig.client_id,this._url+="&"),this._url+="__callback=BuildVideoInfo.response",""!=b.getUCStr(this._vid)&&(this._url+=b.getUCStr(this._vid)),this._plreqStartTime=(new Date).getTime(),w(this._url);var t=this;setTimeout(function(){t.playlistOK||(t.playlistError=!0,d.sendErrorReport(2003),b.playerEvents&&b.playerEvents.onPlayError&&b.playerEvents.onPlayError("视频信息出错，请刷新重试"),b.get("#x-player").innerHTML="视频信息出错，请刷新重试",b.get("#x-player").style.color="white",b.get("#x-player").style.textAlign="center",b.get("#x-player").style.lineHeight=b.get("#x-player").offsetHeight+"px")},15e3)},i.m3u8src=function(t){return b.password=this._password,b.m3u8src_v2(this._vid,t)},i.total=function(t){for(var e in t.segs){for(var i=0,n=0,s=0;s<t.segs[e].length;s++)var a=t.segs[e][s],i=i+parseInt(a.seconds),n=n+parseInt(a.size);return{totalTime:i,totalBytes:n}}},i.cleanSrc=function(){for(var t=this._videoInfo._videoSegsDic[m],e=0;e<t.length;e++)t[e].fyksrc=t[e].src,t[e].src=i.mp4srcs[e]},i.processError=function(t){return debug.log("playlist errorcode = "+t.error_code),-12==t.error_code||-13==t.error_code?(t.segs={"3gphd":[{no:"0",size:"0",seconds:"0",k:"",k2:""}]},t.streamfileids={"3gphd":"0*0"},!1):(null==this._callback?"m3u8"==this._type?d.GetM3U8OK(this._v,{}):d.GetMP4OK(this._v,{}):this._callback(this._v,{}),!0)},i.init=function(t){if(this._v=t,t=t.data[0],t.ep&&t.ip){var e=E(F(b.mk.a3+"o0b"+d.userCache.a1,[19,1,4,7,30,14,28,8,24,17,6,35,34,16,9,10,13,22,32,29,31,21,18,3,2,23,25,27,11,20,5,15,12,0,33,26]).toString(),na(t.ep));if(2>e.split("_").length)d.sendErrorReport(2004),d.showError(null,"数据解析错误");else{if(d.userCache.sid=e.split("_")[0],d.userCache.token=e.split("_")[1],null!=t.error_code&&(d.sendErrorReport(-6==t.error_code||-7==t.error_code?4e3:1e3),this.processError(t)))return;if(e=i.total(t),this._videoInfo=new T(t,this._type),this._videoInfo.totalTime=e?e.totalTime:t.seconds,"m3u8"==this._type)b.defaultVideoType="mp4",null!=l.getItem("defaultVideoType")&&(b.defaultVideoType=l.getItem("defaultVideoType")),-1==t.streamtypes.indexOf(b.defaultVideoType)&&(b.defaultVideoType="mp4",-1==t.streamtypes.indexOf("mp4")&&(b.defaultVideoType="flv")),debug.log("default = "+b.defaultVideoType),this._videoInfo.src=i.m3u8src(b.defaultVideoType),this.cache(),null==this._callback?d.GetM3U8OK(this._v,this._videoInfo):this._callback(this._v,this._videoInfo);else if("mp4"==this._type){e=["3gphd","mp4","flv"],m=null;for(var n=0;n<e.length;n++)if(this._videoInfo._videoSegsDic[e[n]]&&!("3gphd"==e[n]&&7200<parseInt(t.seconds))){m=e[n];break}debug.log("mp4 type="+m),m?("flv"==m&&(d.Log(d.uniplayerUrl+q({error:"flvonly",vid:b.initConfig.vid})),b.config.playType="directsrc"),this.fetchDirectSrc(this._videoInfo._videoSegsDic[m]),this._tid=setInterval("checkSrc()",500)):this.error(2)}}}else d.sendErrorReport(2004),d.showError(null,"数据解析错误")},i.getFileUrl=function(t){var e=[];if(t)for(var i=0;i<t.length;i++)e.push(t[i].src);return e},i.fetchDirectSrc=function(t){if(this._fyks=urls=this.getFileUrl(t),this._v&&this._v.data[0].trial){for(var t=0,e=this._v.data[0].segs,t=0;t<e.mp4.length&&-1!==e.mp4[t].k;t++);urls.length=t}for(t=0;t<urls.length;t++)i.mp4srcs.push(urls[t])},DirectSrcOK=function(t){null==t||"object"!=typeof t||0==t.length||i.mp4srcs.push(t[0].server)};var T=function(t,e){this._sid=d.userCache.sid,this._seed=t.seed,this._fileType=e;var i=new U(this._seed);this._streamFileIds=t.streamfileids,this._videoSegsDic={};for(e in t.segs){for(var n=[],s=0,a=0;a<t.segs[e].length;a++){var o=t.segs[e][a],r={};r.no=o.no,r.size=o.size,r.seconds=o.seconds,o.k&&(r.key=o.k),r.fileId=this.getFileId(t.streamfileids,e,parseInt(a),i),r.type=e,r.src=this.getVideoSrc(o.no,t,e,r.fileId),n[s++]=r}this._videoSegsDic[e]=n}},U=function(t){this._randomSeed=t,this.cg_hun()};U.prototype={cg_hun:function(){this._cgStr="";for(var t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ/\\:._-1234567890",e=t.length,i=0;e>i;i++){var n=parseInt(this.ran()*t.length);this._cgStr+=t.charAt(n),t=t.split(t.charAt(n)).join("")}},cg_fun:function(t){for(var t=t.split("*"),e="",i=0;i<t.length-1;i++)e+=this._cgStr.charAt(t[i]);return e},ran:function(){return this._randomSeed=(211*this._randomSeed+30031)%65536,this._randomSeed/65536}},T.prototype={getFileId:function(t,e,i,n){for(var s in t)if(s==e){streamFid=t[s];break}return""==streamFid?"":(e=n.cg_fun(streamFid),t=e.slice(0,8),i=i.toString(16),1==i.length&&(i="0"+i),i=i.toUpperCase(),e=e.slice(10,e.length),t+i+e)},getVideoSrc:function(t,e,i,n,s,a){if(!e.videoid||!i)return"";var o={flv:0,flvhd:0,mp4:1,hd2:2,"3gphd":1,"3gp":0}[i],r={flv:"flv",mp4:"mp4",hd2:"flv","3gphd":"mp4","3gp":"flv"}[i],l=t.toString(16);1==l.length&&(l="0"+l);var h=e.segs[i][t].seconds,t=e.segs[i][t].k;return(""==t||-1==t)&&(t=e.key2+e.key1),i="",e.show&&(i=e.show.show_paid?"&ypremium=1":"&ymovie=1"),e="/player/getFlvPath/sid/"+d.userCache.sid+"_"+l+"/st/"+r+"/fileid/"+n+"?K="+t+"&hd="+o+"&myp=0&ts="+h+"&ypp=0"+i,n=encodeURIComponent(D(E(F(b.mk.a4+"poz"+d.userCache.a2,[19,1,4,7,30,14,28,8,24,17,6,35,34,16,9,10,13,22,32,29,31,21,18,3,2,23,25,27,11,20,5,15,12,0,33,26]).toString(),d.userCache.sid+"_"+n+"_"+d.userCache.token))),e=e+("&ep="+n)+"&ctype=12&ev=1&token="+d.userCache.token,e+="&oip="+b.v.data[0].ip,"http://k.youku.com"+(e+((s?"/password/"+s:"")+(a?a:"")))
}};var R=function(t){this._player=document.getElementById("youku-html5player-video"),null==this._player&&(this._player=document.getElementById("youku-html5player-video-0")),this._oplayer=t};R.prototype={resize:function(t,e){this._oplayer.resize(t,e)},currentTime:function(){return this._player.currentTime},totalTime:function(){return this._player.duration},playVideo:function(){this._oplayer.play()},pauseVideo:function(){this._player.pause()},seekTo:function(t){try{this._player.currentTime=t}catch(e){}},playVideoById:function(t,e){debug.log("YKH5Player playVideoByid");var n=this._oplayer;b.config.autoplay=!0,b.config.vid=t,i.start(t,e,b.config.content,function(t,e){n.startPlay(t,e)})},hideControls:function(){this._player.removeAttribute("controls")},showControls:function(){this._player.setAttribute("controls",!0)},switchFullScreen:function(){this._oplayer.controls.fullscreenPanel.switchFullScreen({})}},function(){this.FX=function(e,i,n,s,a,o){this.el=t.get(e),this.attributes=i,this.duration=n||.7,this.transition=s&&s in FX.transitions?s:"easeInOut",this.callback=a||function(){},this.ctx=o||window,this.units={},this.frame={},this.endAttr={},this.startAttr={}},this.FX.transitions={linear:function(t,e,i,n){return i*t/n+e},easeIn:function(t,e,i,n){return-i*Math.cos(t/n*(Math.PI/2))+i+e},easeOut:function(t,e,i,n){return i*Math.sin(t/n*(Math.PI/2))+e},easeInOut:function(t,e,i,n){return-i/2*(Math.cos(Math.PI*t/n)-1)+e}},this.FX.prototype={start:function(){var t=this;this.getAttributes(),this.duration*=1e3,this.time=(new Date).getTime(),this.animating=!0,this.timer=setInterval(function(){var e=(new Date).getTime();e<t.time+t.duration?(t.elapsed=e-t.time,t.setCurrentFrame()):(t.frame=t.endAttr,t.complete()),t.setAttributes()},10)},ease:function(t,e){return FX.transitions[this.transition](this.elapsed,t,e-t,this.duration)},complete:function(){clearInterval(this.timer),this.timer=null,this.animating=!1,this.callback.call(this.ctx)},setCurrentFrame:function(){for(attr in this.startAttr)if(this.startAttr[attr]instanceof Array){this.frame[attr]=[];for(var t=0;t<this.startAttr[attr].length;t++)this.frame[attr][t]=this.ease(this.startAttr[attr][t],this.endAttr[attr][t])}else this.frame[attr]=this.ease(this.startAttr[attr],this.endAttr[attr])},getAttributes:function(){for(var e in this.attributes)switch(e){case"color":case"borderColor":case"border-color":case"backgroundColor":case"background-color":this.startAttr[e]=i(this.attributes[e].from||t.getStyle(this.el,e)),this.endAttr[e]=i(this.attributes[e].to);break;case"scrollTop":case"scrollLeft":var n=this.el==document.body?document.documentElement||document.body:this.el;this.startAttr[e]=this.attributes[e].from||n[e],this.endAttr[e]=this.attributes[e].to;break;default:var s=this.attributes[e].to,a=this.attributes[e].units||"px";this.attributes[e].from?n=this.attributes[e].from:(n=parseFloat(t.getStyle(this.el,e))||0,"px"!=a&&document.defaultView&&(t.setStyle(this.el,e,(s||1)+a),n*=(s||1)/parseFloat(t.getStyle(this.el,e)),t.setStyle(this.el,e,n+a))),this.units[e]=a,this.endAttr[e]=s,this.startAttr[e]=n}},setAttributes:function(){for(var e in this.frame)switch(e){case"opacity":t.setStyle(this.el,e,this.frame[e]);break;case"scrollLeft":case"scrollTop":(this.el==document.body?document.documentElement||document.body:this.el)[e]=this.frame[e];break;case"color":case"borderColor":case"border-color":case"backgroundColor":case"background-color":t.setStyle(this.el,e,"rgb("+Math.floor(this.frame[e][0])+","+Math.floor(this.frame[e][1])+","+Math.floor(this.frame[e][2])+")");break;default:t.setStyle(this.el,e,this.frame[e]+this.units[e])}}};var t={get:function(t){return"string"==typeof t?document.getElementById(t):t},getStyle:function(t,i){var i=e(i),n=document.defaultView;return n&&n.getComputedStyle?n.getComputedStyle(t,"")[i]||null:"opacity"==i?(n=t.filters("alpha").opacity,isNaN(n)?1:n?n/100:0):t.currentStyle[i]||null},setStyle:function(t,i,n){"opacity"==i?(t.style.filter="alpha(opacity="+100*n+")",t.style.opacity=n):(i=e(i),t.style[i]=n)}},e=function(){var t={};return function(e){if(t[e])return t[e];var i=e.split("-"),n=i[0];if(1<i.length)for(var s=1,a=i.length;a>s;s++)n+=i[s].charAt(0).toUpperCase()+i[s].substring(1);return t[e]=n}}(),i=function(){var t=/^#?(\w{2})(\w{2})(\w{2})$/,e=/^#?(\w{1})(\w{1})(\w{1})$/,i=/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/;return function(n){var s=n.match(t);return s&&4==s.length?[parseInt(s[1],16),parseInt(s[2],16),parseInt(s[3],16)]:(s=n.match(i))&&4==s.length?[parseInt(s[1],10),parseInt(s[2],10),parseInt(s[3],10)]:(s=n.match(e))&&4==s.length?[parseInt(s[1]+s[1],16),parseInt(s[2]+s[2],16),parseInt(s[3]+s[3],16)]:void 0}}()}(),FX.transitions.quadIn=function(t,e,i,n){return i*(t/=n)*t+e},FX.transitions.quadOut=function(t,e,i,n){return-i*(t/=n)*(t-2)+e},FX.transitions.quadInOut=function(t,e,i,n){return 1>(t/=n/2)?i/2*t*t+e:-i/2*(--t*(t-2)-1)+e},FX.transitions.cubicIn=function(t,e,i,n){return i*(t/=n)*t*t+e},FX.transitions.cubicOut=function(t,e,i,n){return i*((t=t/n-1)*t*t+1)+e},FX.transitions.cubicInOut=function(t,e,i,n){return 1>(t/=n/2)?i/2*t*t*t+e:i/2*((t-=2)*t*t+2)+e},FX.transitions.quartIn=function(t,e,i,n){return i*(t/=n)*t*t*t+e},FX.transitions.quartOut=function(t,e,i,n){return-i*((t=t/n-1)*t*t*t-1)+e},FX.transitions.quartInOut=function(t,e,i,n){return 1>(t/=n/2)?i/2*t*t*t*t+e:-i/2*((t-=2)*t*t*t-2)+e},FX.transitions.quintIn=function(t,e,i,n){return i*(t/=n)*t*t*t*t+e},FX.transitions.quintOut=function(t,e,i,n){return i*((t=t/n-1)*t*t*t*t+1)+e},FX.transitions.quintInOut=function(t,e,i,n){return 1>(t/=n/2)?i/2*t*t*t*t*t+e:i/2*((t-=2)*t*t*t*t+2)+e},FX.transitions.expoIn=function(t,e,i,n){return 0==t?e:i*Math.pow(2,10*(t/n-1))+e-.001*i},FX.transitions.expoOut=function(t,e,i,n){return t==n?e+i:1.001*i*(-Math.pow(2,-10*t/n)+1)+e},FX.transitions.expoInOut=function(t,e,i,n){return 0==t?e:t==n?e+i:1>(t/=n/2)?i/2*Math.pow(2,10*(t-1))+e-5e-4*i:1.0005*(i/2)*(-Math.pow(2,-10*--t)+2)+e},FX.transitions.circIn=function(t,e,i,n){return-i*(Math.sqrt(1-(t/=n)*t)-1)+e},FX.transitions.circOut=function(t,e,i,n){return i*Math.sqrt(1-(t=t/n-1)*t)+e},FX.transitions.circInOut=function(t,e,i,n){return 1>(t/=n/2)?-i/2*(Math.sqrt(1-t*t)-1)+e:i/2*(Math.sqrt(1-(t-=2)*t)+1)+e},FX.transitions.backIn=function(t,e,i,n,s){return s=s||1.70158,i*(t/=n)*t*((s+1)*t-s)+e},FX.transitions.backOut=function(t,e,i,n,s){return s=s||1.70158,i*((t=t/n-1)*t*((s+1)*t+s)+1)+e},FX.transitions.backBoth=function(t,e,i,n,s){return s=s||1.70158,1>(t/=n/2)?i/2*t*t*(((s*=1.525)+1)*t-s)+e:i/2*((t-=2)*t*(((s*=1.525)+1)*t+s)+2)+e},FX.transitions.elasticIn=function(t,e,i,n,s,a){return 0==t?e:1==(t/=n)?e+i:(a||(a=.3*n),!s||s<Math.abs(i)?(s=i,i=a/4):i=a/(2*Math.PI)*Math.asin(i/s),-(s*Math.pow(2,10*(t-=1))*Math.sin(2*(t*n-i)*Math.PI/a))+e)},FX.transitions.elasticOut=function(t,e,i,n,s,a){if(0==t)return e;if(1==(t/=n))return e+i;if(a||(a=.3*n),!s||s<Math.abs(i))var s=i,o=a/4;else o=a/(2*Math.PI)*Math.asin(i/s);return s*Math.pow(2,-10*t)*Math.sin(2*(t*n-o)*Math.PI/a)+i+e},FX.transitions.elasticBoth=function(t,e,i,n,s,a){if(0==t)return e;if(2==(t/=n/2))return e+i;if(a||(a=.3*n*1.5),!s||s<Math.abs(i))var s=i,o=a/4;else o=a/(2*Math.PI)*Math.asin(i/s);return 1>t?-.5*s*Math.pow(2,10*(t-=1))*Math.sin(2*(t*n-o)*Math.PI/a)+e:.5*s*Math.pow(2,-10*(t-=1))*Math.sin(2*(t*n-o)*Math.PI/a)+i+e},FX.transitions.backIn=function(t,e,i,n,s){return"undefined"==typeof s&&(s=1.70158),i*(t/=n)*t*((s+1)*t-s)+e},FX.transitions.backOut=function(t,e,i,n,s){return"undefined"==typeof s&&(s=1.70158),i*((t=t/n-1)*t*((s+1)*t+s)+1)+e},FX.transitions.backBoth=function(t,e,i,n,s){return"undefined"==typeof s&&(s=1.70158),1>(t/=n/2)?i/2*t*t*(((s*=1.525)+1)*t-s)+e:i/2*((t-=2)*t*(((s*=1.525)+1)*t+s)+2)+e},FX.transitions.bounceIn=function(t,e,i,n){return i-FX.transitions.bounceOut(n-t,0,i,n)+e},FX.transitions.bounceOut=function(t,e,i,n){return(t/=n)<1/2.75?7.5625*i*t*t+e:2/2.75>t?i*(7.5625*(t-=1.5/2.75)*t+.75)+e:2.5/2.75>t?i*(7.5625*(t-=2.25/2.75)*t+.9375)+e:i*(7.5625*(t-=2.625/2.75)*t+.984375)+e},FX.transitions.bounceBoth=function(t,e,i,n){return n/2>t?.5*FX.transitions.bounceIn(2*t,0,i,n)+e:.5*FX.transitions.bounceOut(2*t-n,0,i,n)+.5*i+e},$$$=function(t){return document.getElementById(t)};var pa=function(t){return t=parseInt(t),Math.min(Math.max(t,0),b.videoInfo.totalTime)},q=function(t){var e,i=[];for(e in t)i.push(e+":"+t[e]);return"{"+i.join(",")+"}"},n=function(t){var e,i=[];for(e in t)i.push(e+"="+t[e]);return i.join("&")},D=function(t){if(!t)return"";var e,i,n,s,a,o,t=t.toString();for(n=t.length,i=0,e="";n>i;){if(s=255&t.charCodeAt(i++),i==n){e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(s>>2),e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt((3&s)<<4),e+="==";break}if(a=t.charCodeAt(i++),i==n){e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(s>>2),e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt((3&s)<<4|(240&a)>>4),e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt((15&a)<<2),e+="=";break}o=t.charCodeAt(i++),e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(s>>2),e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt((3&s)<<4|(240&a)>>4),e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt((15&a)<<2|(192&o)>>6),e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&o)}return e},u={"-1":"该视频正在转码中... , 请稍候","-2":"该视频正在审核中... , 请稍候","-3":"该视频已被屏蔽","-4":"该视频转码失败","-9":"无效视频","-5":"该视频被设为私密","-6":"该视频已经加密","-7":"对不起，您输入的密码错误，请重新输入","-8":"Sorry,this video can only be streamed within Mainland China.","-15":"很抱歉! 该视频的格式暂时不支持在ipad平台上播放","-25":"您的账号观看过于频繁，超过IP上限,如账号被盗，请及时联系客服","-26":"您所在的国家/地区无法观看此视频！"},J=function(t,e){this.player=t,this._handle={},this._feedback=b.get(".x-feedback"),this._message=this._feedback.getElementsByClassName("x-message")[0],this._messagetxt=this._message.getElementsByClassName("x-message-txt")[0],this._messagebtn=this._message.getElementsByClassName("x-message-btn")[0],this._errorcode=this._error=null,this.init(e),this.bindEvent()};J.prototype={init:function(t){if(t&&t.data&&t.data[0]&&(t.data[0].error_code||t.data[0].error)){switch(b.hide(b.get(".x-video-button")),b.hide(b.get(".x-console")),this._vid=t.data[0].videoid,this._title=t.data[0].title,this._userid=t.data[0].userid,this._error=t.data[0].error,this._errorcode=parseInt(t.data[0].error_code),this._errorcode){case-1:this.setMessage(u[-1]);break;case-2:this.setMessage(u[-2]);break;case-3:this.setMessage(u[-3]),this.setButton("搜索",this.search);break;case-4:this.setMessage(u[-4]),this.bind_feedback=b.bindAsEventListener(this,this.feedback),this.setButton("在线反馈",this.bind_feedback);break;case-9:this.setMessage(u[-9]);break;case-5:this.setMessage(u[-5]),this.bind_contact=b.bindAsEventListener(this,this.contactOwner),this.setButton("联系上传者",this.bind_contact);break;case-6:this._messagetxt.innerHTML="<input type=password placeholder=输入密码观看视频 class=x-message-input>",this.bind_inputpassword=b.bindAsEventListener(this,this.inputPassword),this.setButton("确定",this.bind_inputpassword);break;case-7:this._messagetxt.innerHTML='<input type=password placeholder="对不起,您输入的密码错误,请重新输入" class=x-message-input>',this.bind_inputpassword=b.bindAsEventListener(this,this.inputPassword),this.setButton("确定",this.bind_inputpassword);break;case-8:this.setMessage(u[-8]);break;case-15:this.setMessage(u[-15]);break;case-25:this.setMessage(u[-25]);break;case-26:this.setMessage(u[-26]);break;default:this.setMessage(t.data[0].error)}this.show(),this.showMessage()}},bindEvent:function(){},show:function(){b.show(this._feedback)},hide:function(){b.hide(this._feedback)},showMessage:function(){b.show(this._message)},hideMessage:function(){b.hide(this._message)},setMessage:function(t){this._messagetxt.innerHTML="<p>"+t+"</p>"},setButton:function(t,e){this._messagebtn.innerHTML="<button type=button class=x-btn>"+t+"</button>";var i=this._message.getElementsByClassName("x-btn")[0];b.addEventHandler(i,"click",e)},search:function(){window.location.href="http://www.soku.com/search_video/q_"+this._title},feedback:function(){window.location.href="http://www.youku.com/service/feed/subtype/4/"},contactOwner:function(){window.location.href="http://i.youku.com/u/id_"+this._userid},onPasswordConfirm:function(){},inputPassword:function(){var t=this._messagetxt.getElementsByClassName("x-message-input")[0],e=t.value;if(null==e||0==e.replace(/\s/g,"").length)t.value="",t.placeholder="密码为空，请重新输入";else{var n=this.player;b.password=e,i.start(this._vid,e,b.config.content,function(t,i){b.hide(b.get(".x-feedback")),b.password=e,b.show(b.get(".x-video-button")),b.hide(b.get(".x-message")),n.startPlay(t,i)})}}};var V=function(t){this._handler={},this.player=t,this._fullflag=null,this.init(),this._fullscreen=b.get(".x-fullscreen"),this._btn=this._fullscreen.getElementsByTagName("button")[0],this._btnb=this._btn.getElementsByTagName("b")[0],this.bindEvent()};V.prototype={addEventListener:function(t,e){this._handler[t]=e},removeEventListener:function(t){this._handler[t]=null},dispatch:function(t){t&&this._handler[t.type]&&(t._target=this,this._handler[t.type](t))},init:function(){},bindEvent:function(){this.bind_switch=b.bindAsEventListener(this,this.switchFullScreen),b.addEventHandler(this._fullscreen,"click",this.bind_switch,!0)},removeEvent:function(){b.removeEventHandler(this._fullscreen,"click",this.bind_switch,!0)},zoomStatus:function(){return this._btnb.className},fullFlag:function(){if(null!==this._fullflag)return this._fullflag;var t=this.player.video.webkitDisplayingFullscreen;return this._fullflag="undefined"!=typeof t?t:!1},switchFullScreen:function(t){var e=t.method||"c",i=this._btnb.className;b.config.events&&b.config.events.onSwitchFullScreen?(-1===i.indexOf("in")?(this._fullflag=!1,this._btnb.className=i.replace(/out/g,"in"),this.player.controls.hideShowListBtn(),this.player._reporter.sendUserActionReport("xexfs",e),this.player.adjustVideoRatio(1),this.dispatch({type:"exitfullscreen"})):(this._fullflag=!0,this._btnb.className=i.replace(/in/g,"out"),this.player.controls.showShowListBtn(),this.player._reporter.sendUserActionReport("xenfs",e),this.player.adjustVideoRatio(),this.dispatch({type:"enterfullscreen"})),(e=b.config.events.onSwitchFullScreen)(t,i)):(t=document.getElementById("x-player"),-1===i.indexOf("in")?(this.player._reporter.sendUserActionReport("xexfs",e),document.webkitCancelFullScreen&&(this._btnb.className=i.replace(/out/g,"in"),this._fullflag=!1,document.webkitCancelFullScreen())):(this.player._reporter.sendUserActionReport("xenfs",e),t.webkitRequestFullScreen?(this._btnb.className=i.replace(/in/g,"out"),this._fullflag=!0,t.webkitRequestFullScreen()):this.player.video.webkitSupportsFullscreen&&1<=this.player.video.readyState&&this.player.video.webkitEnterFullscreen()))}};var W=function(t,e){this.handler={},this.player=t,this.information=b.get(".x-video-info"),this.title=this.information.getElementsByClassName("x-title")[0],this.videoState=this.information.getElementsByClassName("x-video-state")[0],b.hide(this.videoState),this.init(e)};W.prototype={init:function(t){!t.data[0].trial&&!t.data[0].error_code&&!t.data[0].error&&(this.title.innerHTML=t.data[0].title.substr(0,20),this.videoState.innerHTML="<span>时长: "+b.getTime(parseInt(t.data[0].seconds))+"</span>",this.show())},show:function(){b.v.data[0].trial||b.show(this.information)},hide:function(){b.hide(this.information)},bindEvent:function(){}};var X=function(t){this.player=t,this._tip=b.get(".x-prompt"),this.init()};X.prototype={init:function(){this._tip.innerHTML='<div class=x-prompt-mode><div class=x-prompt-time></div><div class=x-prompt-forward>快进</div><div class=x-prompt-back>快退</div><div class=x-mask></div></div><div class=x-prompt-status style="display:none"><div class=x-prompt-txt></div><div class=x-mask></div></div>',this._mode=this._tip.getElementsByClassName("x-prompt-mode")[0],this._time=this._tip.getElementsByClassName("x-prompt-time")[0],this._back=this._tip.getElementsByClassName("x-prompt-back")[0],this._forward=this._tip.getElementsByClassName("x-prompt-forward")[0],this._status=this._tip.getElementsByClassName("x-prompt-status")[0],this._statusTxt=this._tip.getElementsByClassName("x-prompt-txt")[0]},setProgress_:function(t){1!=this._progressFlag&&(this._time.innerHTML=b.getTime(parseInt(t)))},setStatus:function(t){this._statusTxt.innerHTML=t,this.showStatus()},hideStatus:function(){b.hide(this._status),b.hide(this._tip)},showStatus:function(){b.hide(this._mode),b.show(this._status),b.show(this._tip)},setTip:function(t,e){this._progressFlag=!0,this._time.innerHTML=b.getTime(pa(t+e)),0>=e?(b.show(this._back),b.hide(this._forward)):(b.show(this._forward),b.hide(this._back));var i=this;setTimeout(function(){i._progressFlag=!1},1e3)},isVisible:function(){return"none"!=this._tip.style.display},hide:function(){b.hide(this._tip)},show:function(){b.show(this._mode),b.hide(this._status),b.show(this._tip)},autoHide:function(t){var e=this;setTimeout(function(){e.hide()},t||1e3)}};var Y=function(t,e){this._handler={},e&&e.data&&e.data[0]&&e.data[0].dvd&&e.data[0].dvd.audiolang?(this.player=t,this._language=b.get(".x-localization"),this.init(e),this.bindEvent(),this._button=this._language.getElementsByTagName("button")[0],this._panel=this._language.getElementsByTagName("div")[0],this._nodes=this._language.getElementsByTagName("li")):b.get(".x-localization").style.display="none"};Y.prototype={addEventListener:function(t,e){this._handler[t]=e},removeEventListener:function(t){this._handler[t]=null},dispatch:function(t){t&&this._handler[t.type]&&(t._target=this,this._handler[t.type](t))},init:function(t){for(var t=t.data[0],e=t.dvd.audiolang,i=["<button class=x-control-btn>","","</button>"],n=["<div class=x-panel><ul>","","</ul><div class=x-mask></div>","</div>"],s=[],a=0;a<e.length;a++){var o="",o=o+("<li data-vid="+e[a].vid),o=o+(" data-language="+e[a].lang);e[a].vid==t.vidEncoded?(i[1]=e[a].lang,o+=" class=selected>"):o+=">",o+=e[a].lang+"</li>",s[e[a].langid]=o}n[1]=s.join(""),this._language.innerHTML=i.join("")+n.join("")},bindEvent:function(){var t=this._language.getElementsByTagName("li");if(0!=t.length){this.bind_toggle=b.bindAsEventListener(this,this.toggleLanguagePanel),b.addEventHandler(this._language,"click",this.bind_toggle);for(var e=0;e<t.length;e++)b.addEventHandler(t[e],"click",b.bindAsEventListener(this,this.switchLanguage))}},removeEvent:function(){null!=this._language&&b.removeEventHandler(this._language,"click",this.bind_toggle)},hide:function(t){if(this._language){var e=this._panel;this._language.className=this._language.className.replace(/[\s]*pressed/g,""),e.style.display="none",t||this.dispatch({type:"settinghide"})}},toggleLanguagePanel:function(t){var e=this._panel;-1===this._language.className.indexOf("pressed")?(this._language.className+=" pressed",e.style.display="block",this.dispatch({type:"settingshow"}),this.player._reporter.sendUserActionReport("xcl","c")):(this.hide(),this.player._reporter.sendUserActionReport("xhl","c")),this.dispatch(t)},switchLanguage:function(t){this.player._reporter.sendUserActionReport("xsl","c"),t.stopPropagation();var t=t.target,e=null,n=null;for(t.getAttribute?(e=t.getAttribute("data-vid"),n=t.getAttribute("data-language")):(e=t.parentNode.getAttribute("data-vid"),n=t.parentNode.getAttribute("data-language")),b.defaultLanguage=n,t=this._nodes,n=0;n<t.length;n++)if(t[n].getAttribute("data-vid")==e){if(-1!==t[n].className.indexOf("selected"))return void this.toggleLanguagePanel();t[n].innerHTML=t[n].getAttribute("data-language"),t[n].className+=" selected",this._button.innerHTML=t[n].getAttribute("data-language")}else t[n].innerHTML=t[n].getAttribute("data-language"),t[n].className=t[n].className.replace(/[\s]*selected/g,"");this.toggleLanguagePanel(),this.dispatch({type:"settingdone"});var s=this.player,a=this.player.currentTime;if("mp4"==b.config.content)a=this.player.currentTime,i.start(e,"",b.config.content,function(t,i){if(console.log("switchLanguage vid = "+e),t.data&&t.data[0]){null==t.data[0].dvd&&(t.data[0].dvd=b.v.data[0].dvd,console.log("switchLanuage keep dvd info audiolang")),b.config.nextAutoPlay=1,null!=i._videoSegsDic&&null!=i._videoSegsDic[m]&&(s.video.src=i._videoSegsDic[m][0].src,s.video.load(),s.video.play());var n=0;s.video.addEventListener("canplay",function(){1!==n&&(n=1,s.seek(a))})}});else{this.player.video.src=b.m3u8src_v2(e,b.defaultVideoType),this.player.video.autoplay=!0,b.unitedTag=null;var o=this,r=0;this.player.video.addEventListener("canplay",function(){1!==r&&(r=1,o.player.seek(a))}),this.player.video.load(),this.player.video.play()}}};var l={setItem:function(t,e){try{window.localStorage.setItem(t,e)}catch(i){}},appendItem:function(t,e){"phase"==t&&!this.phaseTag&&(this.phaseTag=!0,l.removeItem("phase"));try{var i=l.getItem(t);null!==i&&(e=i+"-"+e),window.localStorage.setItem(t,e)}catch(n){}},getItem:function(t){try{return window.localStorage.getItem(t)}catch(e){return null}},removeItem:function(t){try{window.localStorage.removeItem(t)}catch(e){}}},Z=function(t){this.player=t,this._progress=b.get(".x-progress-mini"),this._track=this._progress.getElementsByClassName("x-progress-track-mini")[0],this._play=this._progress.getElementsByClassName("x-progress-play-mini")[0],this._load=this._progress.getElementsByClassName("x-progress-load-mini")[0],this._handler={},this.bindEvent(),this.resetProgress(),this.hide()};Z.prototype={addEventListener:function(t,e){this._handler[t]=e},removeEventListener:function(t){this._handler[t]=null},bindEvent:function(){},removeEvent:function(){},dispatch:function(t){t&&this._handler[t.type]&&this._handler[t.type]()},setProgress:function(t,e){var i=Math.min(t,b.videoInfo.totalTime);this.playTime=i;var n=i/b.videoInfo.totalTime;this._play.style.width=100*n+"%",!0!==e&&(this.loadTime=i+=Math.max(this.player.bufferedEnd()-t,0),n=i/b.videoInfo.totalTime+.05,this._load.style.width=100*Math.min(Math.max(n,0),1)+"%")},resetProgress:function(){this._play.style.width="0%",this._load.style.width="0%"},show:function(){this._progress.style.display="block"},hide:function(){this._progress.style.display="none"}};var $=function(t,e){this._handler={},this._hasPayInfo=!1,this._payInfo=b.get(".x-pay"),this._text=b.get(".x-pay-txt"),this._title=this._text.getElementsByTagName("h1")[0],this._vip=this._text.getElementsByTagName("em")[0],this._tip=b.get(".x-pay-tips"),this._button=b.get(".x-pay-btn"),this._tryBtn=b.get("#x-try"),this._payBtn=b.get("#x-pay"),this.player=t,this.init(e)};$.prototype={addEventListener:function(t,e){this._handler[t]=e},removeEventListener:function(t){this._handler[t]=null},dispatch:function(t){t&&this._handler[t.type]&&(t._target=this,this._handler[t.type](t))},bindEvent:function(){this.bind_try=b.bindAsEventListener(this,this.play),this.bind_pay=b.bindAsEventListener(this,this.pay),b.addEventHandler(this._tryBtn,"click",this.bind_try),b.addEventHandler(this._payBtn,"click",this.bind_pay)},removeEvent:function(){b.removeEventHandler(this._tryBtn,"click",this.bind_try),b.removeEventHandler(this._payBtn,"click",this.bind_pay)},init:function(t){if(null==t.data[0].trial)debug.log("not pay");else{this._hasPayInfo=!0,this._showid=t.data[0].show.showid,this._type=t.data[0].show.paid_type;var e=t.data[0].title;12<e.length&&(e=e.substr(0,12)+"..."),this._tryDuration=parseInt(t.data[0].trial.time),this.player.tryDuration=this._tryDuration,debug.log("try = "+this._tryDuration),"vod"==this._type?(this._title.innerHTML=e+"<em class=x-vip>付费影片</em>",this._payBtn.innerHTML="立即购买"):(this._title.innerHTML=e+"<em class=x-vip>付费包月影片</em>",this._payBtn.innerHTML="开通会员"),this.bindEvent(),this.show(),this.player._reporter.sendPayReport()}},play:function(){(d.isIPHONE||d.isIPOD)&&null!=b.v.data[0].trial&&(this.player.video.style.display="block"),0===this.activeTime?this.player.seek(0):this.player.video.play(),this.player._reporter.sendUserActionReport("xtry","c")},pay:function(){this.player.video.pause(),b.v.payInfo&&b.v.payInfo.h5_caseurl&&window.open(b.v.payInfo.h5_caseurl,"","",!1),this.player._reporter.sendUserActionReport("xbuy","c")},hide:function(){this._payInfo&&(this._payInfo.style.display="none")},show:function(){0!=this._hasPayInfo&&(this._payInfo.style.display="block",0>=this._tryDuration&&b.hide(this._tryBtn))},isBlock:function(){return"block"==this._payInfo.style.display},showTip:function(){this._hasPayInfo&&(this._tip.innerHTML="免费试看已经结束，付费即可观看",this.show())},clearTip:function(){this._tip.innerHTML=""},hasPayInfo:function(){return this._hasPayInfo},tryDuration:function(){return this._tryDuration}};var aa=function(t,e){this._handler={},this.player=t,this._videoInfo=e,this._app_disable=!1,this._limitTime=2400,1==this._videoInfo.controller.app_disable&&(this._app_disable=!0),this._isLimit=!1,1==this._videoInfo.controller.xplayer_disable&&(this._isLimit=!0,this.player.tryDuration=this._limitTime),this._isCreated=!1,debug.log("videoInfo.controller.xplayer_disable:",this._isLimit),debug.log("videoInfo.controller.app_disable:",this._app_disable)};aa.prototype={addEventListener:function(t,e){this._handler[t]=e},removeEventListener:function(t){this._handler[t]=null},dispatch:function(t){t&&this._handler[t.type]&&(t._target=this,this._handler[t.type](t))},create:function(){if(!this._isCreated){debug.log("playLimit create"),this.player.video.pause(),this._isCreated=!0;var t=b.get("#x-player"),e=this._videoInfo.controller.mobile_disabled,i=this._videoInfo.controller.pad_disabled,n=this._videoInfo.controller.pc_disabled,e=0==this._app_disable&&(1==e||1==i)&&0==n;1==this._app_disable||e?(t.innerHTML="<div class=x-app-guide><div class=x-app-guide-tips><p>本页面提供40分钟预览，</p><p>请使用电脑观看完整版！</p></div></div>",this._content=b.get(".x-app-guide"),d.Log("http://hz.youku.com/red/click.php?tp=1&cp=4009227&cpp=1000752&url=")):(t.innerHTML='<div class=x-app-guide><div class=x-app-guide-tips><p>本页面提供40分钟预览</p></div><div class=x-app-guide-action><button type=button class="x-btn x-btn-major">&nbsp;&nbsp;&nbsp;点这里观看完整版&nbsp;&nbsp;&nbsp;</button></div><div class=x-app-openapp></div></div>',this._content=b.get(".x-app-guide"),this._fullBtn=this._content.getElementsByClassName("x-btn")[0],this._openApp=this._content.getElementsByClassName("x-app-openapp")[0],this.bind_onFullClick=b.bindAsEventListener(this,this.onFullClick),b.addEventHandler(this._fullBtn,"click",this.bind_onFullClick),d.Log("http://hz.youku.com/red/click.php?tp=1&cp=4009212&cpp=1000752&url=")),this._content.style.marginLeft=parseInt(-this._content.offsetWidth/2)+"px",this._content.style.marginTop=parseInt(-this._content.offsetHeight/2)+"px"}},onFullClick:function(){debug.log("onFullClick"),this._content.getElementsByClassName("x-app-guide-action")[0].innerHTML='<button type=button class="x-btn x-btn-major">&nbsp;下载安装&nbsp;</button><button type=button class="x-btn">&nbsp;我知道了&nbsp;</button>',this._downloadBtn=this._content.getElementsByClassName("x-btn")[0],this._knowBtn=this._content.getElementsByClassName("x-btn")[1],this.bind_onDownload=b.bindAsEventListener(this,this.onDownloadClick),this.bind_onKnow=b.bindAsEventListener(this,this.onKnowClick),b.addEventHandler(this._downloadBtn,"click",this.bind_onDownload),b.addEventHandler(this._knowBtn,"click",this.bind_onKnow),d.Log("http://hz.youku.com/red/click.php?tp=1&cp=4009213&cpp=1000752&url="),this._content.getElementsByClassName("x-app-guide-tips")[0].innerHTML="<p>看完整版需安装最新优酷app</p>",this._content.style.marginLeft=parseInt(-this._content.offsetWidth/2)+"px",this._content.style.marginTop=parseInt(-this._content.offsetHeight/2)+"px",this.openApp()},onDownloadClick:function(){d.Log("http://hz.youku.com/red/click.php?tp=1&cp=4009215&cpp=1000752&url="),window.open("http://hz.youku.com/red/click.php?tp=1&cp=4008066&cpp=1000687&url=http://m.youku.com/webapp/dl?app=youku&source=webqr","_blank")},onKnowClick:function(){d.Log("http://hz.youku.com/red/click.php?tp=1&cp=4009216&cpp=1000752&url="),setTimeout(function(){window.location.reload()},500)},openApp:function(){var t=document.createElement("iframe");t.height=0,t.width=0,t.frameBorder="no",t.src="youku://play?vid="+b.initConfig.vid,d.isIPAD&&(t.src="youkuhd://play?vid="+b.initConfig.vid),document.getElementsByTagName("body")[0].appendChild(t)},isLimit:function(){return this._isLimit},limitTime:function(){return this._limitTime}};var A={2:"2倍",1.5:"1.5倍",1:"常速",.8:"0.8倍"},ba=function(t,e){this._handler={},d.isIPAD7&&(this.player=t,this.playRate=b.get(".x-playspeed"),this.init(e),this.bindEvent(),this.button=this.playRate.getElementsByTagName("button")[0],this.panel=this.playRate.getElementsByTagName("div")[0],this.nodes=this.playRate.getElementsByTagName("li"),b.show(this.playRate))};ba.prototype={addEventListener:function(t,e){this._handler[t]=e},removeEventListener:function(t){this._handler[t]=null},dispatch:function(t){t&&this._handler[t.type]&&(t._target=this,this._handler[t.type](t))},init:function(){for(var t=["<button class=x-control-btn>","","</button>"],e=['<div class=x-panel style="display:none"><ul>',"","</ul><div class=x-mask></div>","</div>"],i="",n=[],s=["2","1.5","1","0.8"],a=0;a<s.length;a++){var o=s[a],r="",d="";"1"==o&&(r="",t[1]=A[o],d=" class=selected"),i+="<li data-vtype="+o+d+">"+r+A[o]+"</li>",n.push(A[o])}e[1]=i,this.playRate.innerHTML=t.join("")+e.join("")},bindEvent:function(){var t=this.playRate.getElementsByTagName("li");if(0!=t.length){this.bind_toggle=b.bindAsEventListener(this,this.toggleRatePanel),b.addEventHandler(this.playRate,"click",this.bind_toggle);for(var e=0;e<t.length;e++)b.addEventHandler(t[e],"click",b.bindAsEventListener(this,this.switchRate))}},removeEvent:function(){null!=this.playRate&&b.removeEventHandler(this.playRate,"click",this.bind_toggle)},hide:function(t){if(this.playRate){var e=this.panel;this.playRate.className=this.playRate.className.replace(/[\s]*pressed/g,""),e.style.display="none",t||this.dispatch({type:"settinghide"})}},toggleRatePanel:function(t){var e=this.panel;-1===this.playRate.className.indexOf("pressed")?(this.playRate.className+=" pressed",e.style.display="block",this.player._reporter.sendUserActionReport("xcra","c"),this.dispatch({type:"settingshow"})):(this.hide(),this.player._reporter.sendUserActionReport("xhra","c")),this.dispatch(t)},switchRate:function(t){t.stopPropagation();var e=t.target,t=null,t=e.getAttribute?e.getAttribute("data-vtype"):e.parentNode.getAttribute("data-vtype");this.player._reporter.sendUserActionReport("xsra","c",{rate:t});for(var e=this.button,i=this.nodes,n=0;n<i.length;n++)if(i[n].getAttribute("data-vtype")==t){if(-1!==i[n].className.indexOf("selected"))return void this.toggleRatePanel();i[n].innerHTML=A[t],i[n].className+=" selected",e.innerHTML=A[t]}else{var s=i[n].getAttribute("data-vtype");i[n].innerHTML=A[s],i[n].className=i[n].className.replace(/selected/,"")}this.toggleRatePanel(),this.dispatch({type:"settingdone"}),this.player.video.pause(),this.player.video.playbackRate=parseFloat(t),this.player.video.play()}};var ca=function(t){this.player=t,this._progress=b.get(".x-progress"),this._track=this._progress.getElementsByClassName("x-progress-track")[0],this._play=this._progress.getElementsByClassName("x-progress-play")[0],this._load=this._progress.getElementsByClassName("x-progress-load")[0],this._seek=this._progress.getElementsByClassName("x-progress-seek")[0],this._seekHandle=this._seek.getElementsByClassName("x-seek-handle")[0],this._handler={},this.bindEvent()};ca.prototype={addEventListener:function(t,e){this._handler[t]=e},removeEventListener:function(t){this._handler[t]=null},bindEvent:function(){this.bind_seek=b.bindAsEventListener(this,this.seek),this.bind_touchstart=b.bindAsEventListener(this,this.onTouchStart),b.addEventHandler(this._track,"click",this.bind_seek,!0),b.addEventHandler(this._seek,"touchstart",this.bind_touchstart)},removeEvent:function(){b.removeEventHandler(this._track,"click",this.bind_seek,!0),b.removeEventHandler(this._seek,"touchstart",this.bind_touchstart)
},removeClickEvent:function(){b.removeEventHandler(this._track,"click",this.bind_seek,!0)},addClickEvent:function(){b.addEventHandler(this._track,"click",this.bind_seek,!0)},dispatch:function(t){t&&this._handler[t.type]&&this._handler[t.type](t)},setProgress:function(t,e){var i=Math.min(Math.max(t,0),b.videoInfo.totalTime);this.playTime=i;var n=i/b.videoInfo.totalTime,s=this._track.offsetWidth,a=this._seek.offsetWidth;this._play.style.width=Math.min(100*(n+a/s/2),100)+"%",this._seek.style.left=n*s>s-a?s-a+"px":100*Math.min(Math.max(n,0),1)+"%",this.uCurrentTime.innerHTML=b.getTime(i),!0!==e&&(this.loadTime=i+=Math.max(this.player.bufferedEnd()-t,0),n=i/b.videoInfo.totalTime,this._load.style.width=100*Math.min(Math.max(n+.05,0),1)+"%")},resetProgress:function(){this._seek.style.left=this._seek.style.width,this._load.style.width="0",this._play.style.width="0"},getRate:function(t,e){var i=1,n=b.get(".x-fs-console");return n&&(i=parseFloat(b.getCurrentStyle(n).zoom)),t/(e*i)},seek:function(t){var e=(new Date).getTime()-da;if(t.srcElement==this._seek||ea>e)return debug.log(e+","+ea),!1;this.player._reporter.sendUserActionReport("xcs","c"),e=t.offsetX||t.changedTouches[0].clientX-this._track.clientX,debug.log("x = "+e);var e=this.getRate(e,this._track.offsetWidth),i=e*b.videoInfo.totalTime;debug.log("progress bar time = "+i+"rate = "+e+"total = "+b.videoInfo.totalTime),this.setProgress(i,!0),this.dispatch({type:"progressend"}),this.player.seek(i),this.dispatch(t)},handleX:function(){return 0},onTouchStart:function(t){if(1!=t.targetTouches.length||this.isTouching)return!1;if(this.startX=t.targetTouches[0].clientX,t.preventDefault(),this.isTouching=!0,this.startTime=this._currentTime=this.player.currentTime||0,"m3u8"==b.config.content&&(this._prepaused=this.player.video.paused,this.player.video.pause(),this.startTime=this.player.currentTime),"mp4"==b.config.content)for(this.player.video.pause(),this.startTime=this.player.video.currentTime,t=0;r>t;t++)this.startTime+=parseInt(b.videoInfo._videoSegsDic[m][t].seconds);this.bind_onTouchMove=b.bindAsEventListener(this,this.onTouchMove),this.bind_onTouchEnd=b.bindAsEventListener(this,this.onTouchEnd),b.addEventHandler(this._seek,"touchmove",this.bind_onTouchMove),b.addEventHandler(this._seek,"touchend",this.bind_onTouchEnd)},onTouchMove:function(t){return 1!=t.targetTouches.length?!1:(t.preventDefault(),t.stopPropagation(),t=this.startTime+this.getRate(t.targetTouches[0].clientX-this.startX,this._track.offsetWidth)*b.videoInfo.totalTime,this.dispatch({type:"progressing",st:this._currentTime,dt:t-this._currentTime}),this._currentTime=t,this.setProgress(Math.min(Math.max(this._currentTime,0),b.videoInfo.totalTime),!0),!1)},onTouchEnd:function(t){if(this.dispatch({type:"progressend"}),this.isTouching=!1,1<t.changedTouches.length)return!1;var e={tb:parseInt(100*this.startTime)/100,to:parseInt(100*this._currentTime)/100};debug.log("tb="+e.tb),this.player._reporter.sendUserActionReport("xds","d",e),t.preventDefault(),t.stopPropagation(),b.removeEventHandler(this._seek,"touchmove",this.bind_onTouchMove),b.removeEventHandler(this._seek,"touchend",this.bind_onTouchEnd),t=Math.min(Math.max(this._currentTime,0),b.videoInfo.totalTime-5),this.player.controls.onPlay();var i=this.player;return this.player.seek(t,function(){i.video.play()}),!1}};var fa=function(t,e){this._handler={},"m3u8"!=b.config.content?b.get(".x-quality").style.display="none":e&&e.data&&e.data[0]&&e.data[0].streamtypes&&1<e.data[0].streamtypes.length?(this.player=t,this._quality=b.get(".x-quality"),this.init(e),this.bindEvent(),this._button=this._quality.getElementsByTagName("button")[0],this._panel=this._quality.getElementsByTagName("div")[0],this._nodes=this._quality.getElementsByTagName("li")):b.get(".x-quality").style.display="none"};fa.prototype={addEventListener:function(t,e){this._handler[t]=e},removeEventListener:function(t){this._handler[t]=null},dispatch:function(t){t&&this._handler[t.type]&&(t._target=this,this._handler[t.type](t))},init:function(t){var e,t=t.data[0],i=["<button class=x-control-btn title=画质设置>","","</button>"],n=['<div class=x-panel style="display:none"><ul>',"","</ul><div class=x-mask></div>","</div>"],a="",o=[];for(e in s)if(-1!==t.streamtypes.indexOf(e)&&-1===o.indexOf(s[e])){var r="",d="";e==b.defaultVideoType&&(r="",i[1]=s[e],d=" class=selected"),a+="<li data-vtype="+e+d+">"+r+s[e]+"</li>",o.push(s[e])}""==i[1]&&(i[1]=o[0]),n[1]=a,this._quality.innerHTML=i.join("")+n.join("")},bindEvent:function(){var t=this._quality.getElementsByTagName("li");if(0!=t.length){this.bind_toggle=b.bindAsEventListener(this,this.toggleQualityPanel),b.addEventHandler(this._quality,"click",this.bind_toggle);for(var e=0;e<t.length;e++)b.addEventHandler(t[e],"click",b.bindAsEventListener(this,this.switchQuality))}},removeEvent:function(){null!=this._quality&&b.removeEventHandler(this._quality,"click",this.bind_toggle)},hide:function(t){if(this._quality){var e=this._panel;this._quality.className=this._quality.className.replace(/[\s]*pressed/g,""),e.style.display="none",t||this.dispatch({type:"settinghide"})}},toggleQualityPanel:function(t){var e=this._panel;-1===this._quality.className.indexOf("pressed")?(this._quality.className+=" pressed",e.style.display="block",this.player._reporter.sendUserActionReport("xcq","c"),this.dispatch({type:"settingshow"})):(this.hide(),this.player._reporter.sendUserActionReport("xhq","c")),this.dispatch(t)},switchQuality:function(t){this.player._reporter.sendUserActionReport("xsq","c"),t.stopPropagation();for(var e=t.target,t=null,t=e.getAttribute?e.getAttribute("data-vtype"):e.parentNode.getAttribute("data-vtype"),e=this._button,i=this._nodes,n=0;n<i.length;n++)if(i[n].getAttribute("data-vtype")==t){if(-1!==i[n].className.indexOf("selected"))return void this.toggleQualityPanel();i[n].innerHTML=s[t],i[n].className+=" selected",e.innerHTML=s[t],l.setItem("defaultVideoType",t),b.defaultVideoType=t}else{var a=i[n].getAttribute("data-vtype");i[n].innerHTML=s[a],i[n].className=i[n].className.replace(/selected/,"")}debug.log("q1"),this.toggleQualityPanel(),this.dispatch({type:"settingdone"});var o=this.player.currentTime,r=b.m3u8src_v2(b.v.data[0].videoid,t);b.unitedTag=null,this.player.video.src=r;var d=this,h=0;this.player.video.addEventListener("canplay",function(){1===h?debug.log("XXXXXXXXXXXXXXXXXXXXX"):(h=1,debug.log("q2 nsrc="+r),d.player.seek(o),debug.log("q3"))}),this.player.video.load(),this.player.video.play()},switchQuality_:function(t){t.stopPropagation();for(var t=t.target.dataset.vtype,e=this._button,i=this._nodes,n=0;n<i.length;n++)if(i[n].dataset.vtype==t){if(-1!==i[n].className.indexOf("selected"))return void this.toggleQualityPanel();i[n].innerHTML=s[t],i[n].className+=" selected",e.innerHTML=s[t]}else i[n].innerHTML=s[i[n].dataset.vtype],i[n].className=i[n].className.replace(/selected/,"");debug.log("q1"),this.toggleQualityPanel();var a=this.player.video.currentTime,o=this.player.video.src.replace(/type\/(flv|flvhd|mp4|hd2)/,"type/"+t);this.player.video.src=o;var r=this,d=0;this.player.video.addEventListener("canplay",function(){1===d?debug.log("XXXXXXXXXXXXXXXXXXXXX"):(d=1,debug.log("q2 nsrc="+o),r.player.seek(a),debug.log("q3"))})}};var ga=function(t,e){this._handler={},this.player=t,this._panel=document.createElement("div"),this._panel.className="x-recommend",this.init(e),this.request(e),window.relatedpanel=this,b.get("#x-player").appendChild(this._panel),this._panel.style.display="box";var i={e:"xendcard"};i.device=d.isAndroid?"adr":d.isIPAD?"ipad":"oth",d.Log(d.uniplayerUrl+q(i))};ga.prototype={bindDynamicEvent:function(){var t=this._listinner.getElementsByClassName("x-item");this.bind_itemclick=b.bindAsEventListener(this,this.onItemClick);for(var e=0;e<t.length;e++)b.addEventHandler(t[e],"click",this.bind_itemclick,!0)},onItemClick:function(t){t=t.currentTarget.getAttribute("data-i"),"x"==t?this.replay():this.player._reporter.sendRecommendLog(this.getReportParam(t))},init:function(){this._panel.innerHTML="<div class=x-pages></div>",this._listinner=this._panel.getElementsByClassName("x-pages")[0]},request:function(t){var e,i={};i.vid=t.data[0].videoid,i.uid=t.data[0].userid,t.data[0].show&&t.data[0].show.showid&&(i.sid=t.data[0].show.showid),i.cate=t.data[0].categories,i.site="1",i.module="2",t=t.controller.playmode,i.pg="1",i.pg={normal:1,show:3,folder:4}[t],"interior"==b.config.winType?i.apptype=12:(i.apptype=12,i.pg=1),i.pl=36;for(e in b.initConfig.playlistconfig)i[e]=b.initConfig.playlistconfig[e];i.callback="relatedpanel.parseResponse",e="http://ykrec.youku.com/video/packed/list.json?"+n(i),w(e),this._apt=i.apptype,this._pg=i.pg,this._md=i.module},parseResponse:function(t){this._info=t,this.buildPanel(this._info)},buildPanel:function(t){var t=t.data,e=t.length;debug.log("realted len = "+e);var i=[];i.push('<ul class="x-item" data-i="x"><li class="x-item-img"><img src="http://player.youku.com/h5player/img/replay.png"></li></ul>');for(var n=Math.floor((this._panel.offsetWidth-60+16)/166)*Math.floor((this._panel.offsetHeight-120+12)/97),n=(n>e?e:n)-1,n=0>n?0:n,e=0;n>e;e++){var s=t[e].picUrl,a=t[e].title.substr(0,20),o="http://v.youku.com/v_show/id_"+t[e].codeId+".html?from=",r="y7",r="interior"==b.config.winType?r+".2-1-":r+".7-1-",r=r+b.v.data[0].categories,r=r+".4",r=r+("."+(e+1)+"-1"),r=r+("."+this._apt+"-"+this._pg+"-"+this._md+"-"+e),o=o+r;debug.log(o),"myoukucom"==b.initConfig.client_id&&(o="http://m.youku.com/smartphone/detail?vid="+t[e].codeId),i.push('<ul class="x-item" data-i='+e+'><li class="x-item-img"><img src='+s+'></li><li class="x-item-info"><div class="x-item-title">'+a+'</div><div class="x-item-bg"></div></li><li class="x-item-url"><a href='+o+' target="_blank"></a></li><li class="x-item-loading"><div class="x-play-loading"></div></li></ul>')}this._listinner.innerHTML=i.join(""),this.bindDynamicEvent(),this.buildImgEvent()},getReportParam:function(t){var e={};return e.pos=""+t,e.sct=b.v.data[0].categories,e.dct=this._info.data[t].dct,e.ord=this._info.ord,e.req_id=this._info.req_id,e.abver=this._info.ver,e.dma=this._info.data[t].dma,e.algInfo=this._info.data[t].algInfo,e.apt=this._apt,e.md=this._md,e.pg=this._pg,e.r=(new Date).getTime(),e.vid=b.v.data[0].vidEncoded,e.uid=b.v.data[0].userid,1==this._info.data[t].type?e.dvid=this._info.data[t].id:e.dsid=this._info.data[t].id,e.sid="",b.v.data[0].show&&b.v.data[0].show.showid&&(e.sid=b.v.data[0].show.showid),e},buildImgEvent:function(){for(var t=this._listinner.getElementsByClassName("x-item-img"),e=0;e<t.length;e++)b.addEventHandler(t[e],"error",b.bindAsEventListener(this,this.onLoadImgError)),b.addEventHandler(t[e],"abort",b.bindAsEventListener(this,this.onLoadImgError))},onLoadImgError:function(t){debug.log("img error"),t=t.target,b.addClass(t.parentNode.parentNode,"x-no-pic"),t.src="http://player.youku.com/h5player/img/no_pic.png"},replay:function(t){this.player.controls.rePlay(t)},onResize:function(){var t=this;setTimeout(function(){t.buildPanel(t._info)},500)}};var ha=function(t,e){this._handler={},this.player=t,this._showbtn=b.get(".x-playshow"),this._showlist=b.get(".x-showlist"),this.init(e),this._inner=this._showlist.getElementsByClassName("x-showlist-inner"),this._bullet=this._showlist.getElementsByClassName("x-showlist-bullet"),this.bindEvent()};ha.prototype={init:function(t){this._showlist.innerHTML='<div class=x-showlist-inner><div class=x-showlist-hd></div><div class=x-showlist-bd></div><div class=x-showlist-ft style="display:none"></div><div class=x-mask></div></div>',this._slhd=this._showlist.getElementsByClassName("x-showlist-hd")[0],this._slbd=this._showlist.getElementsByClassName("x-showlist-bd")[0],this._slft=this._showlist.getElementsByClassName("x-showlist-ft")[0],this._slhd.innerHTML="<label>选集</label><div class=x-showlist-close></div>",this._closeHandle=this._slhd.getElementsByClassName("x-showlist-close")[0];var e=t.data[0].list;if(null!=e&&0!=e.length){for(var i=["<ul class=x-showlist-bullet>","","</ul>"],n=[],s=0;s<e.length;s++){var a=e[s],o="http://v.youku.com/v_show/id_"+a.vidEncoded+".html";b.v.folder&&(o=o+"?f="+b.v.folder.folderId);var r="";a.vidEncoded==b.v.data[0].vidEncoded&&(r=" class=selected"),a="<li"+r+"><a href="+o+">"+a.title.substr(0,20)+"</a></li>",n.push(a)}for(i[1]=n.join(""),this._slbd.innerHTML=i.join(""),i="<div class=x-showlist-pages>;<span class=x-showlist-pre></span>;<ul>;;</ul>;<span class=x-showlist-next></span>".split(";"),n=[],r=t.data[0].list_pre?parseInt(t.data[0].list_pre.seq/60):0,s=0;s<(e.length-1)/60+1;s++)t="",s==r&&(t=" class=current"),a="<li"+t+"><em>"+(s+1)+"</em></li>",n.push(a);i[3]=n.join(""),this._slft.innerHTML=i.join("")}},addEventListener:function(t,e){this._handler[t]=e},removeEventListener:function(t){this._handler[t]=null},dispatch:function(t){t&&this._handler[t.type]&&(t._target=this,this._handler[t.type](t))},bindEvent:function(){this.bind_close=b.bindAsEventListener(this,this.hide),b.addEventHandler(this._closeHandle,"click",this.bind_close),this.bind_toggle=b.bindAsEventListener(this,this.toggle),b.addEventHandler(this._showbtn,"click",this.bind_toggle)},removeEvent:function(){b.removeEventHandler(this._closeHandle,"click",this.bind_close)},hide:function(){this._showbtn.className=this._showbtn.className.replace(/[\s]*pressed/g,""),b.hide(this._showlist)},show:function(){this._showbtn.className+=" pressed",b.show(this._showlist)},showListBtn:function(){var t=b.v.data[0].list;null==t||1>=t.length||b.show(this._showbtn)},hideListBtn:function(){var t=b.v.data[0].list;null==t||0==t.length||(b.hide(this._showbtn),this.hide())},toggle:function(t){"block"!=this._showlist.style.display?(this.show(),this.player._reporter.sendUserActionReport("xshl","c"),d.Log(d.uniplayerUrl+q({e:"xshl",adr:d.isAndroid,ios:d.isIPAD}))):this.hide(),this.dispatch(t)},touchStart:function(t){this._sx=t.targetTouches[0].clientX,this._sy=t.targetTouches[0].clientY,this._ex=this._sx,this._ey=this._ey},touchEnd:function(){},touchMove:function(t){this._ex=t.targetTouches[0].clientX,this._ey=t.targetTouches[0].clientY,this._dx=this._ex-this._sx,this._dy=this._ey-this._sy,Math.abs(this._dx)>Math.abs(this._dy)||t.preventDefault()}};var ia=function(t){this.player=t,this._handle={},this._tips=b.get(".x-tips"),b.hide(this._tips),this._tips.innerHTML="<div class=x-tips-txt></div><div class=x-tips-close><a href=#><em>关闭</em></a></div><div class=x-tips-mask></div>",this._ptip=this._tips.getElementsByClassName("x-tips-txt")[0],this._ctip=this._tips.getElementsByClassName("x-tips-close")[0],null==l.getItem("youku_conf_skip")&&l.setItem("youku_conf_skip",!0),this.bindEvent()};ia.prototype={bindEvent:function(){b.addEventHandler(this._ctip,"click",b.bindAsEventListener(this,this.closeTip))},closeTip:function(){b.hide(this._tips),this.keepLastTime()},autoHide:function(t){var e=this;setTimeout(function(){e.closeTip()},t)},keepLastTime:function(){},ignoreLastTime:function(){},isShowTimeTip:function(){var t=l.getItem("youku_keep_lasttime"),t=parseInt(t),e=l.getItem("youku_ignore_lasttime"),e=parseInt(e);return t>=3||e>=3?!1:!0},showLastTimeTip:function(t){t=b.getTime(t),debug.log("last = "+t),0!=this.isShowTimeTip()&&(this._ptip.innerHTML="优酷记忆您上次播放到<span class=x-tips-time>"+t+"</span>, <a class=x-tip-timebegin href=#>从头观看</a>",this._playBegin=this._ptip.getElementsByClassName("x-tip-timebegin")[0],b.addEventHandler(this._playBegin,"click",b.bindAsEventListener(this,this.seekBegin)),b.show(this._tips),this.autoHide(5e3))},onSkipTail:function(){"true"==l.getItem("youku_conf_skip")?(this._ptip.innerHTML="即将为您跳过片尾, <a class=x-tip-skipnoway href=#>不再跳过</a>",this._skipnowtail=this._ptip.getElementsByClassName("x-tip-skipnoway")[0],b.addEventHandler(this._skipnowtail,"click",b.bindAsEventListener(this,this.skipNoway))):(this._ptip.innerHTML="是否跳过片头片尾? <a class=x-tip-skipalways href=#>始终跳过</a>",this._skipalwtail=this._ptip.getElementsByClassName("x-tip-skipalways")[0],b.addEventHandler(this._skipalwtail,"click",b.bindAsEventListener(this,this.skipAlways))),b.show(this._tips),this.autoHide(1e4)},onSkipHead:function(){"true"==l.getItem("youku_conf_skip")?(this._ptip.innerHTML="已经为您跳过片头, <a class=x-tip-skipnoway href=#>不再跳过</a>",this._skipnow=this._ptip.getElementsByClassName("x-tip-skipnoway")[0],b.addEventHandler(this._skipnow,"click",b.bindAsEventListener(this,this.skipNoway))):(this._ptip.innerHTML="是否跳过片头片尾? <a class=x-tip-skipalways href=#>始终跳过</a>",this._skipalw=this._ptip.getElementsByClassName("x-tip-skipalways")[0],b.addEventHandler(this._skipalw,"click",b.bindAsEventListener(this,this.skipImediately))),b.show(this._tips),this.autoHide(5e3)},onUglyAdPlay:function(){this._ptip.innerHTML="尊敬的会员，因版权原因，请点击右上角 关闭广告 ",b.show(this._tips);var t=this;setTimeout(function(){b.hide(t._tips)},15e3)},closeUglyHint:function(){b.hide(this._tips)},skipImediately:function(){debug.log("skip imediately"),this.player._reporter.sendUserActionReport("xskh","c"),l.setItem("youku_conf_skip",!0);var t=parseInt((b.v.data[0].dvd||"").head)/1e3;return this.onSkipHead(),this.player.seek(t),!1},skipNoway:function(){return this.player._reporter.sendUserActionReport("xnsk","c"),l.setItem("youku_conf_skip",!1),this._ptip.innerHTML="设置成功",!1},skipAlways:function(){return this.player._reporter.sendUserActionReport("xask","c"),l.setItem("youku_conf_skip",!0),this._ptip.innerHTML="设置成功",!1},seekBegin:function(){return this.player._reporter.sendUserActionReport("xseb","c"),b.hide(this._tips),this.ignoreLastTime(),this.player.seek(0),!1}};var K=function(t,e,i){if(this.player=t,this.v=e,this.sid=i,this.isSendedConsumeReport=!1,d.hd=this.getHDFlag(),0<C.length)for(t=0;t<C.length;t++)this.sendUepReport(C[t].type,C[t].time);if(this.dimension={w:document.getElementById("x-player").offsetWidth,h:document.getElementById("x-player").offsetHeight},this.screenDim={w:screen.availWidth,h:screen.availHeight},"onorientationchange"in window){var n=this;window.addEventListener("orientationchange",function(){n.sendUserActionReport("xro","r");var t={e:"xro"};t.device=d.isAndroid?"adr":d.isIPAD?"ipad":"oth",d.Log(d.uniplayerUrl+q(t))})}};K.prototype={sendRecommendLog:function(t){d.Log("http://r.l.youku.com/recclick?"+n(t))},tsInit:function(){this.tsSn=null},sendTSLog:function(t){null==this.tsSn&&(this.tsSn=0);var e=5,e=24<this.tsSn?20:12<this.tsSn?10:5,i=this;if(this.tstimer=setTimeout(function(){i.sendTSLog(60)},1e3*e),61==t)clearTimeout(this.tstimer),this.tstimer=null;else if(i.player.video.paused)return;if(0==this.tsSn)this.tsSn++;else{var s=b.v.data[0];s.sid=b.videoInfo._sid,b.initConfig.tslogconfig=b.initConfig.tslogconfig||{};var a={};a.vvid=s.sid,a.vid=s.videoid,a.cf=this.getHDFlag(),a.cpt=this.player.currentTime?Math.floor(this.player.currentTime):0,a.full=this.player.controls.fullscreenPanel.fullFlag()?1:0,a.lang=this.getLanguage(),a.pc=60==t?0:1,a.clb=0,a.iku="m",a.pt=this.getPlayTime(),a.sn=this.tsSn++,a.hi=e,a.uid=b.v.user.id,a.r=this.signTS(a.vvid+a.vid+a.cpt+a.pt+a.sn),d.Log("http://p-log.ykimg.com/tslog?"+n(a))}},signTS:function(t){if(null==t)return 0;var e=0,i=t.length;for(j=0;i>j;j++)e=43*e+t.charCodeAt(j),e%=1e10;return e},getPlayTime:function(){var t=0;return t=24<this.tsSn?180+20*(this.tsSn-24):12<this.tsSn?60+10*(this.tsSn-12):5*this.tsSn},tslogparse:function(){},sendTSErrorLog:function(){},sendVVLog:function(t){var e=b.v.data[0];e.sid=b.videoInfo._sid,b.initConfig.vvlogconfig=b.initConfig.vvlogconfig||{};var i={pvid:""};i.chid=e.ct,i.url=escape(window.location.href),i.rurl="",i.vvid=e.sid,i.vid=e.videoid,i.schid=e.cs,i.plid="",i.plchid="",i.shid=null!=e.show&&e.show.showid?e.show.showid:"",i.shchid=e.ct,i.ptype=b.WIN_TYPE,i.cp=null!=e.show&&e.show.copyright?e.show.copyright:"",i.vl=parseInt(e.seconds),i.cf=this.getHDFlag(),i.hf=this.getMaxFileType(),i.spt=0,i.pb=62==t?2:0,i.vdoid=e.userid,i.out="interior"==b.initConfig.wintype?0:1,i.r=this.signTS(i.vvid+i.vid),i.ext=this.getExtString(t);for(var s in b.initConfig.vvlogconfig)i[s]=b.initConfig.vvlogconfig[s];d.Log("http://v.l.youku.com/ykvvlog?"+n(i))},getLanguage:function(){return null==this.langMap&&(this.langMap={"国语":1,"粤语":2,"英语":6,"日语":7,"川话":3}),this.langMap[b.defaultLanguage||"国语"]},getExtString:function(t){var e={iku:"m"};return e.full=this.player.controls.fullscreenPanel.fullFlag(),e.lang=this.getLanguage(),e.num=t,e.ctp=0,e.pc=60==t?0:1,e.clb=0,e.ctype="12",e.ev="1",e.tk=d.userCache.token,e.oip=b.v.data[0].ip,e.isvip=b.v.user.vip?"1":"0",e.paystate=this.getPayState(),e.playstate=null==b.v.data[0].trial?"1":"2",escape(n(e))},getPlayByType_:function(t){var e=0;return 62==t&&(e=2),b.initConfig.vvlogconfig.pb&&(e=b.initConfig.vvlogconfig.pb),e},getMaxFileType:function(){return b.v.data[0].segs.hd2?2:b.v.data[0].segs.mp4?1:0},getHDFlag:function(){if(null==this.player)return 0;var t=null,e=this.player.video.src;-1!=e.indexOf("m3u8")?(t={flv:0,flvhd:0,mp4:1,hd2:2,hd3:3},e=b.defaultVideoType):t={"030020":4,"030004":0,"030008":1,"030080":3};for(var i in t)if(-1!==e.indexOf(i))return t[i];return 0},addPlayerDurationReport:function(t){var e=b.videoInfo;if(null!=e&&null!=e._playListData){if(null==this.drtimer){var i=this;this.drtimer=setInterval(function(){i.player.video.paused||i.addPlayerDurationReport(60)},6e4)}61==t&&(clearInterval(this.drtimer),this.drtimer=null);var s={};s.sid=e._sid,s.videoOwnerId=b.v.data[0].userid,s.viewUserId=b.v.user.id,s.videoid=b.v.data[0].videoid,s.ct=b.v.data[0].ct,s.cs=b.v.data[0].cs,s.number=t,s.rnd=((new Date).getTime()-e.abstarttime)/1e3,null!=e._playListData.show?(s.showid_v2=null==e._playListData.show?"":e._playListData.show.showid,s.showid_v3=null==e._playListData.show?"":e._playListData.show.showid_encode,s.show_videotype=e._playListData.show.show_videotype,s.stg=e._playListData.show.stage,s.Tid=e._playListData.show.theaterid,s.Copyright=e._playListData.show.copyright):(s.showid_v2="",s.Tid=0,s.Copyright=""),s.hd=0,s.ikuflag="m",s.hd={flv:0,flvhd:0,mp4:1,hd2:2,hd3:3}[b.defaultVideoType],s.winType=b.WIN_TYPE,s.mtype=P(),s.totalsec=e.totalTime,s.fullflag=this.player.controls.fullscreenPanel.fullFlag(),s.playComplete=0,61==t&&(s.playComplete=1),59==t&&(s.referUrl=(b.initConfig.vvlogconfig||"").rurl,s.url=encodeURIComponent(window.location.href),s.starttime=0),s.currentPlayTime=parseInt(this.player.currentTime||0),s.continuationPlay=0,s.pid=b.initConfig.client_id,s.timestamp=(new Date).getTime(),s.ctype="12",s.ev="1",s.tk=d.userCache.token,s.oip=b.v.data[0].ip,s.isvip=b.v.user.vip?"1":"0",s.paystate=this.getPayState(),s.playstate=null==b.v.data[0].trial?"1":"2",d.Log("http://stat.youku.com/player/addPlayerDurationReport?"+n(s))}},addPlayerStaticReport:function(){var t={};t.videoid=this.v.data[0].videoid,t.t=this.v.data[0].ts,t.totalsec=parseInt(this.v.data[0].seconds),t.ikuflag="m",t.url=escape(window.location.href),t.fullflag=this.player.controls.fullscreenPanel.fullFlag(),t.source="video",t.referer=(b.initConfig.vvlogconfig||"").rurl,t.sid=this.sid,t.uid=this.v.data[0].userid;for(var e=t.t,i=!1,s="";!i;){for(var s="",a=0;20>a;a++)var o=Math.floor(61*Math.random()),s=s+"0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz".substring(o,o+1);hstr=e+s,hashcash=oa(hstr),"00"==hashcash.substring(0,2)&&(i=!0)}t.h=s,t.totalseg=b.pieceLength(),t=n(t),d.Log("http://stat.youku.com/player/addPlayerStaticReport?"+t)},sendUserActionReport:function(t,e,i){e={t:1002,e:t,v:e},e.d=D(P());var s={v:"h5player",vid:b.v.data[0].videoid,ssid:b.videoInfo._sid,ct:b.v.data[0].ct,cs:b.v.data[0].cs,uid:0};b.v.data[0].user&&(s.uid=b.v.user.id),s.sid="",b.v.data[0].show&&(s.sid=b.v.data[0].show.showid),s.tc=this.player.currentTime||0,s.w=b.get("#x-player").offsetWidth,s.h=b.get("#x-player").offsetHeight,s.f=this.player.video.webkitDisplayingFullscreen?"on":"off",s.q=this.player.getQuality(),s.ver="1.0.0";for(var a in i)s[a]=i[a];if(e.x=D(n(s)),a=n(e),"xre"==t)this.checkPlayerResize("http://e.stat.ykimg.com/red/ytes.php?",a);else{if("xenfs"==t||"xexfs"==t){this._giveupReTag=!0;var o=this;setTimeout(function(){o._giveupReTag=!1},800)}d.Log("http://p-log.ykimg.com/event?"+a)}this.sendCustomUserAction(t,i)},checkScreenRotate:function(t,e){var i=screen.availWidth,n=screen.availHeight;debug.log("<hr/>rota w,h = "+i+","+n),(this.screenDim.w!=i||this.screenDim.h!=n)&&(this.screenDim.w=i,this.screenDim.h=n,debug.log("<b><font color=red>rotate</font></b>"),d.Log(t+e))},checkPlayerResize:function(t,e){if(!0===this._giveupReTag)debug.log("give up xre after enfs or exfs");else{var i=document.getElementById("x-player");this._resizeList=this._resizeList||[],this._resizeList.push({str:e,time:(new Date).getTime(),w:i.offsetWidth,h:i.offsetHeight});var n=this;setTimeout(function(){if(0!=n._resizeList.length){for(var e=n._resizeList[0].time,i=0;i<n._resizeList.length;i++){var s=n._resizeList[i].w,a=n._resizeList[i].h,o=n._resizeList[i].time;(s!=n.dimension.w||a!=n.dimension.h)&&(n.dimension.w=s,n.dimension.h=a,(o-e>800||i==n._resizeList.length-1)&&d.Log(t+n._resizeList[i].str))}n._resizeList=[]}},1e3)}},sendCustomUserAction:function(t,e){var i,n={e:t};for(i in e)n[i]=e[i];switch(n.device=d.isAndroid?"adr":d.isIPAD?"ipad":"oth",t){case"xenfs":d.Log(d.uniplayerUrl+q(n));break;case"xexfs":d.Log(d.uniplayerUrl+q(n));break;case"xsra":d.Log(d.uniplayerUrl+q(n))}},sendCustomLoadedTime:function(t){t={vid:b.v.data[0].videoid,os:escape(d.os),adrd4:d.isAndroid4,mobile:d.isMobile,type:"mp4"==b.config.content?m:b.config.content,cost:t,ver:VER.replace(/[-:]/g,"")},0==t.mobile&&(t.ua=escape(navigator.userAgent.replace(/[\/\+\*@\(\)\,]/g,""))),d.Log("http://passport-log.youku.com/logsys/logstorage/append?project=xplayerloadtime&log="+q(t))},sendUepReport:function(t,e,i){!1!==i&&10<100*Math.random()||(i="",i=d.isIPAD?"xplayer_ipad":d.isIPHONE?"xplayer_iphone":"xplayer_android",t={m:i,hd:this.getHDFlag(),t:t,s:e,u:escape(window.location.href),p:2,v:b.videoInfo._sid,ct:b.v.data[0].ct,cs:b.v.data[0].cs,a:b.v.controller.area_code+"|"+b.v.controller.dma_code},d.Log("http://v.l.youku.com/uep?"+n(t)))},sendLoadedTime:function(t){debug.log("loaded cost = "+t),this.sendCustomLoadedTime(t),this.sendUepReport("videoload",t)},sendComScoreReport:function(t){if(!this._hasComScore){for(var e=document.getElementsByTagName("script"),i=0;i<e.length;i++)if(-1!==e[i].src.indexOf("scorecardresearch.com/beacon.js")){this._hasComScore=!0;break}!0!==this._hasComScore&&(e=document.createElement("script"),i=document.getElementsByTagName("script")[0],e.async=!0,e.src=("https:"==document.location.protocol?"https://sb":"http://b")+".scorecardresearch.com/beacon.js",i.parentNode.insertBefore(e,i)),this._hasComScore=!0}var n=setInterval(function(){if("undefined"!=typeof COMSCORE){clearInterval(n);try{COMSCORE.beacon({c1:1,c2:7293931,c3:t,c6:b.v.data[0].categories})}catch(e){debug.log("beacon exception")}}},500)},sendIResearchReport:function(){},sendThirdPartyReport:function(t){"xplayer_h5"==t&&(t=d.isAndroid?"xplayer_h5_android":d.isIPAD?"xplayer_h5_ipad":"xplayer_h5_other"),this.sendComScoreReport(t),this.sendIResearchReport(t)},sendPayReport:function(){var t={vid:b.v.data[0].videoid,os:escape(d.os)};d.Log("http://passport-log.youku.com/logsys/logstorage/append?project=unipay&log="+q(t))},sendClientConsumeReport:function(){1!=this.isSendedConsumeReport&&null!=b.config.partner_config&&1==b.config.partner_config.status&&null!=b.config.partner_config.token&&""!=b.config.partner_config.token&&(this.isSendedConsumeReport=!0,d.Log("https://openapi.youku.com/v2/players/consume.json?token="+b.config.partner_config.token))},getPayState:function(){var t=0;return b.v.data[0].show&&"vod"==b.v.data[0].show.paid_type&&(t=1),b.v.data[0].show&&"mon"==b.v.data[0].show.paid_type&&(t=2),t}};var ja=function(t,e){this._handler={},this._adinfo=t,this._info={VAL:[]};for(var i in t)"VAL"!=i&&(this._info[i]=t[i]);this._vt2nodes=e||[]};ja.prototype={addEventListener:function(t,e){this._handler[t]=e},removeEventListener:function(t){this._handler[t]=null},dispatch:function(t){t&&this._handler[t.type]&&(t._target=this,this._handler[t.type](t))},buildAdRS:function(){for(var t="http://pl.youku.com/playlist/m3u8?",e={},i={},s=this._adinfo.VAL,a=0;a<s.length;a++){var o=s[a];i["a"+(a+1)]=o.VID+"_"+o.VQT}i.v=b.v.data[0].videoid+"_"+b.defaultVideoType;var r,a=escape,o=[];for(r in i)o.push('"'+r+'":"'+i[r]+'"');for(i="{"+o.join(",")+"}",e.ids=a(i),e.ts=parseInt((new Date).getTime()/1e3),b.password&&(e.password=b.password),b.password&&b.initConfig.client_id&&b.config.partner_config&&1==b.config.partner_config.status&&1==b.config.partner_config.passless&&(e.client_id=b.initConfig.client_id),i=[],r=0;r<s.length;r++)i.push(s[r].VID);return i.push(b.v.data[0].videoid),s=encodeURIComponent(D(E(F(b.mk.a4+"poz"+d.userCache.a2,[19,1,4,7,30,14,28,8,24,17,6,35,34,16,9,10,13,22,32,29,31,21,18,3,2,23,25,27,11,20,5,15,12,0,33,26]).toString(),d.userCache.sid+"_"+i.join("")+"_"+d.userCache.token))),e.ep=s,e.sid=d.userCache.sid,e.token=d.userCache.token,e.ctype="12",e.ev="1",e.oip=b.v.data[0].ip,t+=n(e),""!=b.getUCStr(b.v.data[0].videoid)&&(t+=b.getUCStr(b.v.data[0].videoid)),t},run:function(){if(null!=this._adinfo&&null!=this._adinfo.VAL&&0!=this._adinfo.VAL.length){for(var t={SUS:[],SU:[],SUE:[],CU:[],CUM:[],VTVC:[]},e=0,i=0;i<this._adinfo.VAL.length;i++){var n=this._adinfo.VAL[i];if(null!=n.VID&&null!=n.VQT){if(null==n.SU&&(n.SU=[]),null==n.SUE&&(n.SUE=[]),0==i)t.SUS=n.SUS||[];else for(var s=0;s<n.SUS.length;s++)t.SU.push({T:e,U:n.SUS[s].U});for(s=0;s<n.SU.length;s++){var a=n.SU[s].T+e;t.SU.push({T:a,U:n.SU[s].U})}if(i==this._adinfo.VAL.length-1)t.SUE=n.SUE;else for(s=0;s<n.SUE.length;s++)a=e+n.AL,t.SU.push({T:a,U:n.SUE[s].U});if(e+=n.AL,t.CU.push({T:e,U:n.CU}),t.CUM.push({T:e,CUM:n.CUM}),1==parseInt(n.VT)&&t.VTVC.push({U:n.VC,T:e}),0!=this._vt2nodes.length)for(s=0;s<this._vt2nodes.length;s++)n=this._vt2nodes[s].VC,a=this._vt2nodes[s].pos_,-1==a&&t.VTVC.push({U:n,T:0}),a==i&&t.VTVC.push({U:n,T:e})}}t.AL=e,t.RS=this.buildAdRS(),this._info.VAL.push(t),this._info.src=t.RS}this.dispatch({type:ADConstant.FRONT_AD_INFO_ADAPER_OK,data:this._info})}};var L=function(t,e){this._handler={},this.player=t,this.video=this.player.video,this.controls=this.player.controls,this._adplugin=this.player._adplugin,this._adplugin.adplayer=this,this.video.preload="none",this.video.src=e.data.urls[0],debug.log("ad src="+this.video.src),this.video.style.display="block",this._addata=e.data,this._addata.curnum=0,this._playTag=[],this.bindAdEvent(),this._adreporter=new G(this,this._addata)};L.prototype={addEventListener:function(t,e){this._handler[t]=e},removeEventListener:function(t){this._handler[t]=null},dispatch:function(t){t&&this._handler[t.type]&&(t._target=this,this._handler[t.type](t))},bindAdEvent:function(){this.bind_fadtoplay=b.bindAsEventListener(this,this.onPlayClick),this.bind_fadplay=b.bindAsEventListener(this,this.onAdPlay),this.bind_fadended=b.bindAsEventListener(this,this.onAdEnded),this.bind_faderror=b.bindAsEventListener(this,this.onAdError),this.bind_fadpause=b.bindAsEventListener(this,this.onAdPause),this.bind_fadsuspend=b.bindAsEventListener(this,this.onAdSuspend),this.bind_fadstalled=b.bindAsEventListener(this,this.onAdStalled),this.bind_fadwaiting=b.bindAsEventListener(this,this.onAdWaiting),this.bind_fadloadedmetadata=b.bindAsEventListener(this,this.onAdLoadedMetaData),this.bind_fadtimeupdate=b.bindAsEventListener(this,this.onAdTimeUpdate),b.addEventHandler(this.video,"play",this.bind_fadplay),b.addEventHandler(this.video,"ended",this.bind_fadended),b.addEventHandler(this.video,"error",this.bind_faderror),b.addEventHandler(this.video,"pause",this.bind_fadpause),b.addEventHandler(this.video,"suspend",this.bind_fadsuspend),b.addEventHandler(this.video,"stalled",this.bind_fadstalled),b.addEventHandler(this.video,"waiting",this.bind_fadwaiting),b.addEventHandler(this.video,"loadedmetadata",this.bind_fadloadedmetadata),b.addEventHandler(this.video,"timeupdate",this.bind_fadtimeupdate),this.shadow=this.controls.buttons.shadow,this.videobtn=this.controls.buttons.videobtn,b.addEventHandler(this.videobtn,"click",this.bind_fadtoplay,!0)},removeAdEvent:function(){b.removeEventHandler(this.video,"play",this.bind_fadplay),b.removeEventHandler(this.video,"ended",this.bind_fadended),b.removeEventHandler(this.video,"error",this.bind_faderror),b.removeEventHandler(this.video,"pause",this.bind_fadpause),b.removeEventHandler(this.video,"suspend",this.bind_fadsuspend),b.removeEventHandler(this.video,"stalled",this.bind_fadstalled),b.removeEventHandler(this.video,"waiting",this.bind_fadwaiting),b.removeEventHandler(this.video,"timeupdate",this.bind_fadtimeupdate),b.removeEventHandler(this.video,"loadedmetadata",this.bind_fadloadedmetadata),b.removeEventHandler(this.videobtn,"click",this.bind_fadtoplay,!0)
},onPlayClick:function(){this.video.play()},checkVTVC:function(t){var e=this._addata.vtvc;if(null!=e&&0!==e.length)for(var i=0;i<e.length;i++){var n=e[i];n.pos_==t-1&&x(n.VC,"js")}},play:function(){this.checkVTVC(0),this.video.load(),this.video.play()},leftSecond:function(){for(var t=this._addata.curnum,e=this._addata.seconds.length,i=this._addata.seconds[t]-this.video.currentTime,t=t+1;e>t;t++)i+=this._addata.seconds[t];return parseInt(i)},clearTimer:function(){clearInterval(this._checkTimer),this._checkTimer=null},checkPause:function(){if(!this._checkTimer){var t=this;this._timelist=[],this._checkTimer=setInterval(function(){t.video.paused?t.onAdPause():(t._timelist.push(t.video.currentTime),3<=t._timelist.length&&(1>Math.abs(t._timelist[0]-t._timelist[2])&&(debug.log("<b>ad unexpected pause</b>"),t.video.play(),0==t.leftSecond()&&(debug.log("<b>exception left = 0 </b>"),t.onAdEnded())),t._timelist=[]))},1e3)}},onAdPlay:function(){this.checkPause();var t=this.controls.container.poster;b.hide(this.controls.buttons.videobtn),b.hide(t),b.hide(b.get(".x-video-info")),this.video.style.display="block",t=this._addata.curnum,debug.log("left="+this.leftSecond()+" curtotal="+this._addata.seconds[t]+" curtime="+this.video.currentTime),this._adplugin.setLeftSecond(this.leftSecond());var e=this;setTimeout(function(){debug.log("ad media timeout check begin = "+e._adBegin),e._adBegin||(e.removeAdEvent(),e._adplugin.hide(),e._adplugin.reportTime("advideo",-1,!1),e.dispatch({type:ADConstant.AD_ERROR,data:!0}))},1e4),this._playTag[t]||(this._playTag[t]=!0,this._adfirsttu=!1,this._adplugin.recordTime("advideo"),l.appendItem("phase","adplay"))},uglyClose:function(){this.video.src="",this.video.load(),this.video.play()},onAdError:function(){this.checkVTVC(this._addata.curnum+1),this.removeAdEvent(),this._adplugin.hide(),this._adplugin.reportTime("advideo",-1,!1),this.dispatch({type:ADConstant.AD_ERROR,data:!0})},onAdEnded:function(t){debug.log("ad ended"),this._adreporter.sendSUE(),this.checkVTVC(this._addata.curnum+1),this._addata.curnum<this._addata.urls.length-1?this.onMiddleAdEnded(t):(this.removeAdEvent(),this._adplugin.hide(),this.clearTimer(),this.dispatch({type:ADConstant.AD_END,data:!0}),l.appendItem("phase","adend"))},onMiddleAdEnded:function(){debug.log("onMiddleAdEnded"),this._pauseLeftSec=!0;var t=this;setTimeout(function(){t._pauseLeftSec=!1},1e3),this._addata.curnum++,this.video.src=this._addata.urls[this._addata.curnum],this.video.load(),this.video.play(),this._adBegin=!1},onAdPause:function(){this.player.video.ended||(b.show(this.controls.buttons.videobtn),b.hide(this.controls.buttons.shadow))},onAdSuspend:function(){debug.log("<font color=red>ad suspend</font>")},onAdStalled:function(){debug.log("<font color=red>ad stalled</font>")},onAdWaiting:function(t){this.controls.onWaiting(t)},onAdTimeUpdate:function(){b.hide(this.controls.buttons.loading),this._adBegin=!0,b.hide(this.controls.buttons.loading),this._pauseLeftSec||this._adplugin.setLeftSecond(this.leftSecond()),this._adreporter.sendSU(this.video.currentTime),.5<=this.video.currentTime&&this._adplugin.show(),this._adfirsttu||(this._adfirsttu=!0,this._adreporter.sendSUS(),this._adreporter.sendVC(),this._adplugin.reportTime("advideo"),d.isNeedAdrTrick()&&d.adrInvalidPauseCheck(this.video),0===this._adplugin.SKIP&&this.dispatch({type:ADConstant.UGLY_CLOSE_AD_HINT}))},onAdLoadedMetaData:function(){this._adBegin=!0},onAdClick:function(){this.video.pause(),this._adreporter.sendCUM();var t=this._addata,t=t.info.VAL[t.curnum].CU;debug.log("click cu="+t),window.open(t,"","",!1)}},ADConstant={FRONT_REQUEST_BASE:"http://mf.atm.youku.com/mf?",BACK_REQUEST_BASE:"http://mb.atm.youku.com/mb?",PAUSE_REQUEST_BASE:"http://mp.atm.youku.com/mp?",INSERT_REQUEST_BASE:"http://valo.atm.youku.com/valo?",OVERLAY_REQUEST_BASE:"http://valc.atm.youku.com/valc?",FRONT_AD:"frontAD",BACK_AD:"backAD",INSERT_AD:"insertAD",PAUSE_AD:"pauseAD",OVERLAY_AD:"overlayAD",AD_END:"adend",AD_ERROR:"aderror",UGLY_CLOSE_AD:"uglyclosead",FRONT_AD_END:"frontADend",FRONT_AD_ERROR:"frontADerror",FRONT_AD_INFO_OK:"frontAdinfook",FRONT_AD_UNITED_INFO_OK:"unitedfrontadinfook",FRONT_AD_INFO_ADAPER_OK:"frontAdinfoadapterok",FRONT_AD_INFO_TIMEOUT:"frontAdinfotimeout",BACK_AD_END:"backAdend",BACK_AD_ERROR:"backaderror",BACK_AD_INFO_OK:"backAdinfook",BACK_AD_INFO_TIMEOUT:" backAdinfotimeout",INSERT_AD_INFO_OK:"insertAdinfook",PAUSE_AD_INFO_OK:"pauseAdinfook",PAUSE_AD_INFO_ERROR:"pauseAdinfoerror",PAUSE_AD_INFO_TIMEOUT:"pauseadinfotimeout",OVERLAY_AD_INFO_OK:"overlayAdinfook",AdPluginObject:"adpluginobject"};var M=function(t,e,i){this._handler={},this.player=t,this.sid=i,this._advids=[],this._adsecs=[],this._adsrcs=[],this._vid=e.data[0].videoid,this._advert=b.get(".x-advert"),this._adskip=this._advert.getElementsByClassName("x-advert-skip")[0],this._adcount=this._advert.getElementsByClassName("x-advert-countdown")[0],this._adknowdet=this._advert.getElementsByClassName("x-advert-detail")[0],this.init(e),this.bindEvent()};M.prototype={init:function(t){this.initRequestParam(t),this._adskipTxt=this._adskip.getElementsByClassName("x-advert-txt")[0],this._adskipTxt.innerHTML="跳过广告",this._adcountTxt=this._adcount.getElementsByClassName("x-advert-txt")[0],this._adcountTxt.innerHTML="广告剩余时间<span class=x-advert-sec></span>秒",this._adsec=this._adcountTxt.getElementsByClassName("x-advert-sec")[0]},initRequestParam:function(t){var e={site:1,p:0,vl:parseInt(t.data[0].seconds),fu:0,ct:t.data[0].ct,cs:t.data[0].cs,d:0,paid:t.data[0].show?t.data[0].show.paid:0,s:t.data[0].show?t.data[0].show.showid:0,sid:this.sid,td:t.data[0].sourceVid?t.data[0].sourceVid:0,v:t.data[0].videoid,vip:t.user.vip?1:0,wintype:"xplayer_m3u8",k:"",u:t.data[0].userid,bt:d.isPad?"pad":"phone",os:d.isMobileIOS?"ios":"Android",rst:d.isMobileIOS?"m3u8":"3gphd",tict:0,aw:"w",vs:"1.0",ti:encodeURIComponent(t.data[0].title)};null!=b.config.partner_config&&(e.partnerid=b.initConfig.client_id,e.atm=b.config.partner_config.atm),e.k=escape((t.data[0].tags||[]).join("|"));for(var i in b.initConfig.adconfig)e[i]=b.initConfig.adconfig[i];this._param=e,this.loadPartnerParam()},loadPartnerParam:function(){},partnerParse:function(){},initRequestParam_:function(t){var e={ct:t.data[0].ct,cs:t.data[0].cs,v:t.data[0].videoid,t:parseInt(t.data[0].seconds),u:t.data[0].userid,fileid:"todo",winType:"xplayer_m3u8",partnerid:b.config.partnerId,sid:this.sid,k:"",td:"todo"};e.s=t.data[0].show?t.data[0].show.showid:"",t.user&&(e.vip=t.user.vip?1:0),e.paid=t.data[0].show?t.data[0].show.paid:0;for(var i in b.initConfig.adconfig)e[i]=b.initConfig.adconfig[i];this._param=e},bindEvent:function(){var t=this;this.fSkipAd=function(){t.adplayer.video.pause(),window.open("http://cps.youku.com/redirect.html?id=000002bf","","",!1)},this._adskip.addEventListener("click",this.fSkipAd,!1),this._adknowdet.addEventListener("click",function(){debug.log("detail clicked"),t.adplayer.onAdClick("")},!1)},addEventListener:function(t,e){this._handler[t]=e},removeEventListener:function(t){this._handler[t]=null},dispatch:function(t){t&&this._handler[t.type]&&(t._target=this,this._handler[t.type](t))},show:function(){b.show(this._advert)},hide:function(){b.hide(this._advert)},setLeftSecond:function(t){this._adsec&&(this._adsec.innerText=t)},splitVTVC:function(t){debug.log("split adinfo vt vc"),this._vtvc=[];var e,i={};for(e in t)"VAL"!=e&&(i[e]=t[e]);for(i.VAL=[],t=t.VAL,e=0;e<t.length;e++)2===parseInt(t[e].VT)?(t[e].pos_=e-1-this._vtvc.length,this._vtvc.push(t[e])):null==t[e].RS||""==t[e].RS.trim()||null==t[e].VID||null==t[e].VQT||i.VAL.push(t[e]);return i},buildTestData:function(){return{VAL:[{AL:15,VID:147660115,VQT:"flv",SUS:[{U:"http://mytestdata.com1"},{U:"http://mytestdata.com2"}],SU:[],SUE:[],CU:"http://www.baidu.com",CUM:[{U:"http://cum"}],RS:"http://fasdfa"},{AL:15,VID:15252,VQT:"flv",SUS:[{U:"http://mytestdata.com1"},{U:"http://mytestdata.com2"}],SU:[],SUE:[],CU:"http://www.bing.com",CUM:[{U:"http://cum"}],RS:"http://fasdfa",VT:2,VC:"http://vc.com"}]}},checkSkip:function(t){t&&0===parseInt(t.SKIP)&&(b.hide(this._adskip),this.SKIP=0)},adParseUnited:function(t){if(this.checkSkip(t),this._isAdInfoOk=!0,l.appendItem("phase","adinfo"),this.reportTime("adinfo"),t&&t.VAL&&(debug.log("<b>before split val length =  "+t.VAL.length+"</b>"),t=this.splitVTVC(t),debug.log("<b>after : val length =  "+t.VAL.length+"</b>")),null==t||null==t.VAL||0==t.VAL.length)t={VAL:[]},this.dispatch({type:ADConstant.FRONT_AD_UNITED_INFO_OK,data:{info:{VAL:[]},vtvc:this._vtvc||[]}});else{var t=new ja(t,this._vtvc),e=this;t.addEventListener(ADConstant.FRONT_AD_INFO_ADAPER_OK,function(t){debug.log("ad info adapter ok"),e.dispatch({type:ADConstant.FRONT_AD_UNITED_INFO_OK,data:{info:t.data,vtvc:e._vtvc||[]}})}),t.run()}},adParse:function(t){if(this.checkSkip(t),l.appendItem("phase","adinfo"),this.reportTime("adinfo"),this._isAdInfoOk=!0,t&&t.VAL)for(var t=this.splitVTVC(t),e=t.VAL,i=0;i<e.length;i++)this._adsrcs.push(e[i].RS),this._adsecs.push(parseInt(e[i].AL));debug.log("frontad len ="+this._adsrcs.length),this.dispatch({type:ADConstant.FRONT_AD_INFO_OK,data:{ids:this._advids||[],urls:this._adsrcs,seconds:this._adsecs,info:t,vtvc:this._vtvc||[]}})},buildPauseData:function(){return adinfo={P:10,VAL:[{RS:"http://static.atm.youku.com/Youku2013/201307/0715/27896/600-430.jpg",RST:"img",AT:73,SU:[],SUS:[{U:"http://mf.atm.youku.com/mshow?v=137006183&at=73&ct=d&cs=1003&ca=135159&ie=150597&uid=1234567&ck=137689524489061H&al=0&bl=1&s=&td=&st=1&vl=1200.0&ap=4&sid=1&cr=0&tvb=0&pr=100&oidtype=27896%7C1&tpa=null&rid=&os=1&dt=1&aw=a&avs="}],SUE:[],CU:"http://vid.atm.youku.com/mclick?v=137006183&at=73&ct=d&cs=1003&ca=135159&ie=150597&uid=1234567&ck=137689524489061H&al=0&bl=1&s=&td=&st=1&vl=1200.0&ap=4&sid=1&cr=0&tvb=0&pr=100&oidtype=27896%7C1&tpa=null&rid=&os=1&dt=1&aw=a&avs=&u=http://static.youku.com/pub/youku/fragment/panel_phone.html&md5=f2450cd80597324b57d986147dc1b3a9",W:400,H:300,CF:"1"}]}},adParsePause:function(t){debug.log("<b> ad parse pause </b>"),l.appendItem("phase","pauseadinfo"),this.reportTime("adinfo"),this._isPauseAdInfoOk=!0,null==t||null==t.VAL||0==t.VAL.length||10!=t.P?this.dispatch({type:ADConstant.PAUSE_AD_INFO_ERROR}):(debug.log("<b>pause ad len = "+t.VAL.length+"</b>"),this.dispatch({type:ADConstant.PAUSE_AD_INFO_OK,data:{info:t}}))},frontAd:function(){this._param.fu=this.player.controls.fullscreenPanel.fullFlag()?1:0,this._param.p=7,this._param.callback=ADConstant.AdPluginObject+".adParse",b.OLD_M3U8=!0,d.isIPAD&&(debug.log("<font color=red> new m3u8 api</font>"),b.OLD_M3U8=!1,this._param.callback=ADConstant.AdPluginObject+".adParseUnited");var t=ADConstant.FRONT_REQUEST_BASE+n(this._param);w(t),this.recordTime("adinfo");var e=this;setTimeout(function(){e._isAdInfoOk||(debug.log("adinfo timeout"),e.reportTime("adinfo",-1),e.dispatch({type:ADConstant.FRONT_AD_INFO_TIMEOUT,data:{timeout:8e3}}))},8e3)},pauseAd:function(){this._param.r_=parseInt(1e4*Math.random()),this._param.p=10,this._param.fu=this.player.controls.fullscreenPanel.fullFlag()?1:0,this._param.callback=ADConstant.AdPluginObject+".adParsePause";var t=ADConstant.PAUSE_REQUEST_BASE+n(this._param);w(t),this.recordTime("adinfo");var e=this;setTimeout(function(){e._isPauseAdInfoOk||(debug.log("pause ad info timeout"),e.reportTime("adinfo",-1),e.dispatch({type:ADConstant.PAUSE_AD_INFO_TIMEOUT,data:{timeout:8e3}}))},8e3)},recordTime:function(t){null==this._timearr&&(this._timearr={}),this._timearr[t]=(new Date).getTime()},reportTime:function(t,e,i){null==this._timearr&&(this._timearr={}),e=e||(new Date).getTime()-this._timearr[t],this.player._reporter.sendUepReport({adinfo:"valfload",advideo:"adload"}[t],e,i)},backAd:function(){this._param.fu=this.player.controls.fullscreenPanel.fullFlag(),this._param.p=9,this._param.callback=ADConstant.AdPluginObject+".adParse",this._param.ctu=0;var t=ADConstant.BACK_REQUEST_BASE+n(this._param);w(t);var e=this;setTimeout(function(){e._isAdInfoOk||(debug.log("adinfo timeout"),e.dispatch({type:ADConstant.BACK_AD_INFO_TIMEOUT,data:{timeout:5e3}}))},5e3)},insertAd:function(){this._param.ps=0,this._param.pt=0}};var G=function(t,e){this.adplayer=t,this.addata=e,"undefined"==typeof e.curnum&&(this.addata.curnum=0)};G.prototype={sendSUS:function(){var t=this.addata.info.VAL[this.addata.curnum].SUS;if("undefined"!=typeof t)for(var e=0;e<t.length;e++)d.Log(t[e].U)},sendUnitedVTVC:function(t){var t=t+2,e=this.addata.info.VAL[0].VTVC;this._vtccache||(this._vtccache=[]);for(var i=null,n=1e6,s=1e5,a=0;a<e.length;a++){var o=e[a].U,r=parseInt(e[a].T),d=t-r;d>=0&&s>d&&(s=d,i=o,n=r)}null!=i&&-1==this._vtccache.indexOf(n)&&(this._vtccache.push(n),debug.log("<b> vc = "+i+"</b>"),x(i,"js"))},sendVC:function(){var t=this.addata.info.VAL[this.addata.curnum];"undefined"!=typeof t.VT&&x(t.VC,"js")},sendSUS_:function(){var t=this.addata.info,e=this.addata.curnum+2,i=t["A"+e].ATMSU,n=t["A"+e].ISOSU;d.Log(t["A"+e].SU),d.Log(i),d.Log(n)},sendSUE:function(){var t=this.addata.info.VAL[this.addata.curnum].SUE;if("undefined"!=typeof t)for(var e=0;e<t.length;e++)d.Log(t[e].U)},sendSUE_:function(){var t=this.addata.info,e=this.addata.curnum+2,i=t["A"+e].COU;d.Log(t["A"+e].OU),d.Log(i)},sendSU:function(t){var e=this.addata.info.VAL[this.addata.curnum].SU;if("undefined"!=typeof e){this._sucache||(this._sucache=[]);for(var i=1e4,n=1e6,s=0;s<e.length;s++){var a=parseInt(e[s].T),o=t-a;o>=0&&i>o&&(i=o,n=a)}if(1e6!=n&&-1==this._sucache.indexOf(n))for(this._sucache.push(n),s=0;s<e.length;s++)parseInt(e[s].T)==n&&d.Log(e[s].U)}},sendSU_:function(t){curnum+=2;var e=this.addata.info["A"+curnum].MT;e&&t>=parseInt(e)&&(t=this.addata.info["A"+curnum].CMU,d.Log(this.addata.info["A"+curnum].MU),d.Log(t))},sendCUM:function(){var t=this.addata.info.VAL[this.addata.curnum].CUM;if("undefined"!=typeof t)for(var e=0;e<t.length;e++)d.Log(t[e].U)},sendUnitedCUM:function(t){var e=this.addata.info.VAL[0].CUM;if("undefined"!=typeof e&&0!==e.length)for(var i=0;i<e.length;i++)if(t<parseInt(e[i].T)){for(t=0;t<(e[i].CUM||[]).length;t++)d.Log(e[i].CUM[t].U);break}},sendCUM_:function(){var t=this.addata;d.Log(t.info["A"+(t.curnum+2)].VCU)}};var ka=function(t,e){this._handler={},this.player=t,this.controls=t.controls,this.adplugin=this.controls._pauseAdPlugin,this.info=e.data.info,this.adjustIMGWH(),this.adpause=b.get(".x-ad-pause"),this.info.VAL[0].VT=parseInt(this.info.VAL[0].VT),2!=this.info.VAL[0].VT&&(this.init(),this.bindEvent(),this._adreporter=new G(this,e.data)),this.loadVC()};ka.prototype={addEventListener:function(t,e){this._handler[t]=e},removeEventListener:function(t){this._handler[t]=null},dispatch:function(t){t&&this._handler[t.type]&&(t._target=this,this._handler[t.type](t))},bindEvent:function(){b.addEventHandler(this.adcontent,"click",b.bindAsEventListener(this,this.adClick)),b.addEventHandler(this.adclose,"click",b.bindAsEventListener(this,this.hide));var t=this;window.addEventListener("orientationchange",function(){setTimeout(function(){b.isLandScape()||t.hide()},1e3)})},adjustIMGWH:function(){var t=this.info.VAL[0].W,e=this.info.VAL[0].H,i=(b.get("#x-player").offsetHeight-110)/e;(i>1||0>=i)&&(i=1),this.info.VAL[0].W=t*i,this.info.VAL[0].H=e*i,debug.log("pause img adjusted w = "+this.info.VAL[0].W+" h = "+this.info.VAL[0].H)},init:function(){this.adpause.innerHTML="<div class=x-pause-content></div><div class=x-pause-close></div>",this.adcontent=this.adpause.getElementsByClassName("x-pause-content")[0],this.adcontent.innerHTML=" <img class=x-pause-img width="+this.info.VAL[0].W+" height="+this.info.VAL[0].H+" src="+this.info.VAL[0].RS+">",this.adclose=this.adpause.getElementsByClassName("x-pause-close")[0],this.adimg=this.adcontent.getElementsByClassName("x-pause-img")[0],this.adimg.style.height=this.info.VAL[0].H+"px",this.adimg.style.width=this.info.VAL[0].W+"px",this.adpause.style.marginLeft="-"+this.info.VAL[0].W/2+"px",this.adpause.style.marginTop="-"+this.info.VAL[0].H/2+"px"},hide:function(){b.hide(this.adpause)},play:function(){2!=this.info.VAL[0].VT&&(b.show(this.adpause),this._adreporter.sendSUS())},adClick:function(){window.open(this.info.VAL[0].CU,null),this._adreporter&&this._adreporter.sendCUM()},loadVC:function(){(2==this.info.VAL[0].VT||1==this.info.VAL[0].VT)&&x(this.info.VAL[0].VC,"js")}};var la=function(t,e){this._handler={},this.player=t,this.video=this.player.video,this.controls=this.player.controls,this._adplugin=this.player._adplugin,this._adplugin.adplayer=this,this._addata=e.data.info,this.video.preload="none",this.video.src=this._addata.VAL[0].RS,debug.log("ad src="+this.video.src),this.video.style.display="block",this._playTag=[],this.bindAdEvent(),this._adreporter=new G(this,{curnum:0,info:this._addata})};la.prototype={addEventListener:function(t,e){this._handler[t]=e},removeEventListener:function(t){this._handler[t]=null},dispatch:function(t){t&&this._handler[t.type]&&(t._target=this,this._handler[t.type](t))},bindAdEvent:function(){this.bind_fadtoplay=b.bindAsEventListener(this,this.onPlayClick),this.bind_fadplay=b.bindAsEventListener(this,this.onAdPlay),this.bind_fadended=b.bindAsEventListener(this,this.onAdEnded),this.bind_faderror=b.bindAsEventListener(this,this.onAdError),this.bind_fadpause=b.bindAsEventListener(this,this.onAdPause),this.bind_fadsuspend=b.bindAsEventListener(this,this.onAdSuspend),this.bind_fadstalled=b.bindAsEventListener(this,this.onAdStalled),this.bind_fadwaiting=b.bindAsEventListener(this,this.onAdWaiting),this.bind_fadloadedmetadata=b.bindAsEventListener(this,this.onAdLoadedMetaData),this.bind_fadtimeupdate=b.bindAsEventListener(this,this.onAdTimeUpdate),b.addEventHandler(this.video,"play",this.bind_fadplay),b.addEventHandler(this.video,"error",this.bind_faderror),b.addEventHandler(this.video,"pause",this.bind_fadpause),b.addEventHandler(this.video,"suspend",this.bind_fadsuspend),b.addEventHandler(this.video,"stalled",this.bind_fadstalled),b.addEventHandler(this.video,"waiting",this.bind_fadwaiting),b.addEventHandler(this.video,"loadedmetadata",this.bind_fadloadedmetadata),b.addEventHandler(this.video,"timeupdate",this.bind_fadtimeupdate),this.shadow=this.controls.buttons.shadow,this.videobtn=this.controls.buttons.videobtn,b.addEventHandler(this.videobtn,"click",this.bind_fadtoplay,!0)},removeAdEvent:function(){b.removeEventHandler(this.video,"play",this.bind_fadplay),b.removeEventHandler(this.video,"ended",this.bind_fadended),b.removeEventHandler(this.video,"error",this.bind_faderror),b.removeEventHandler(this.video,"pause",this.bind_fadpause),b.removeEventHandler(this.video,"suspend",this.bind_fadsuspend),b.removeEventHandler(this.video,"stalled",this.bind_fadstalled),b.removeEventHandler(this.video,"waiting",this.bind_fadwaiting),b.removeEventHandler(this.video,"timeupdate",this.bind_fadtimeupdate),b.removeEventHandler(this.video,"loadedmetadata",this.bind_fadloadedmetadata),b.removeEventHandler(this.videobtn,"click",this.bind_fadtoplay,!0)},onPlayClick:function(){this.video.play()},play:function(){this.video.load(),this.video.play()},leftSecond:function(){return parseInt(Math.max(0,this._addata.VAL[0].AL-this.video.currentTime))},clearTimer:function(){clearInterval(this._checkTimer),this._checkTimer=null},checkPause:function(){if(!this._checkTimer){var t=this;this._timelist=[],this._checkTimer=setInterval(function(){t.video.paused?t.onAdPause():(t._timelist.push(t.video.currentTime),3<=t._timelist.length&&(1>Math.abs(t._timelist[0]-t._timelist[2])&&(debug.log("<b>ad unexpected pause</b>"),t.video.play(),0==t.leftSecond()&&(debug.log("<b>exception left = 0 </b>"),t.onAdEnded())),t._timelist=[]))},1e3)}},onAdPlay:function(){this.checkPause();var t=this.controls.container.poster;b.hide(this.controls.buttons.videobtn),b.hide(t),b.hide(b.get(".x-video-info")),this.video.style.display="block",this._adplugin.setLeftSecond(this.leftSecond());var e=this;setTimeout(function(){debug.log("ad media timeout check begin = "+e._adBegin),e._adBegin||(e.removeAdEvent(),e._adplugin.hide(),e._adplugin.reportTime("advideo",-1,!1),e.dispatch({type:ADConstant.AD_ERROR,data:!0}))},15e3),this._playTag[0]||(this._playTag[0]=!0,this._adfirsttu=!1,this._adplugin.recordTime("advideo"),l.appendItem("phase","adplay"))},uglyClose:function(){debug.log("united ugly close"),this.onAdError()},onAdError:function(){this.removeAdEvent(),this._adplugin.hide(),this._adplugin.reportTime("advideo",-1,!1),this.clearTimer(),this.dispatch({type:ADConstant.AD_ERROR,data:!0})},onAdEnded:function(){debug.log("united ad ended"),this._adreporter.sendSUE(),this.removeAdEvent(),this._adplugin.hide(),this.clearTimer(),this.dispatch({type:ADConstant.AD_END,data:!0}),l.appendItem("phase","adend")},onAdPause:function(){this.player.video.ended||(b.show(this.controls.buttons.videobtn),b.hide(this.controls.buttons.shadow))},onAdSuspend:function(){debug.log("<font color=red>ad suspend</font>")},onAdStalled:function(){debug.log("<font color=red>ad stalled</font>")},onAdWaiting:function(t){this.controls.onWaiting(t)},onAdTimeUpdate:function(){this.video.currentTime>this._addata.VAL[0].AL?this.onAdEnded():(b.hide(this.controls.buttons.loading),this._adBegin=!0,b.hide(this.controls.buttons.loading),this._adplugin.setLeftSecond(this.leftSecond()),this._adreporter.sendSU(this.video.currentTime),this._adreporter.sendUnitedVTVC(this.video.currentTime),this._adfirsttu||(this._adplugin.show(),this._adreporter.sendSUS(),this._adfirsttu=!0,this._adplugin.reportTime("advideo"),0===this._adplugin.SKIP&&this.dispatch({type:ADConstant.UGLY_CLOSE_AD_HINT})))},onAdLoadedMetaData:function(){this._adBegin=!0},onAdClick:function(){this.video.pause(),this._adreporter.sendUnitedCUM(this.video.currentTime||0);for(var t=this._addata.VAL[0].CU,e=this.video.currentTime,i=0;i<t.length;i++){var n=t[i],s=n.U;if(e<=parseInt(n.T)){window.open(s,"","",!1);break}}}},DirectPlayer=function(t){b.config=t,null==b.config.width&&(b.config.width=document.getElementById(b.config.parentBox).offsetWidth),this.buildDirectDom(document.getElementById(b.config.parentBox))},DirectPlayer.prototype={buildDirectDom:function(t){t.innerHTML="<div id=x-player class="+y(b.config.width)+'><div class=x-video-poster><img id=x-img></img></div><div class=x-video-button><div class=x-video-play-ico></div></div><div class=x-video-info><h1 class=x-title></h1><div class=x-video-state style="display:none"><span class=x-time-span></span></div><div class=x-showmore></div><div class=x-mask></div></div>'},bindEvent:function(){this._videobtn=b.get(".x-video-button"),b.addEventHandler(this._videobtn,"click",b.bindAsEventListener(this,this.redirect))},startPlay:function(t,e){b.v=t,b.videoInfo=e,b.videoInfo._playListData=t.data[0],this._pimg=b.get("#x-img"),this._pimg.src=t.data[0].logo,this._title=b.get(".x-title"),this._title.innerHTML=t.data[0].title,this._timespan=b.get(".x-time-span"),this._timespan.innerHTML=b.getTime(t.data[0].seconds),b.show(b.get(".x-video-poster")),b.show(b.get(".x-video-info")),this.adapterForReport(),this._reporter=new K(this,b.v,b.videoInfo._sid),this.bindEvent()},onPlayStart:function(){b.config.events&&b.config.events.onPlayStart&&(d.playerCurrentState=d.playerState.PLAYER_STATE_PLAYING,debug.log(d.playerCurrentState),debug.log("api:onplaystart"),b.config.events.onPlayStart())},getSrc:function(){return this.src?this.src:("m3u8"==b.config.content?this.src=b.videoInfo.src:null!=b.videoInfo._videoSegsDic&&null!=b.videoInfo._videoSegsDic[m]&&(this.src=b.videoInfo._videoSegsDic[m][0].src),this.src)},redirect:function(){var t=this.getSrc();debug.log("redirect play src="+t),d.isMIUI?window.location.href=t:window.open(t,"","",!1),this.onPlayStart(),this._reporter.addPlayerStaticReport(),this._reporter.addPlayerDurationReport(59),this._reporter.sendVVLog(59),this._reporter.sendTSLog(60),this._reporter.sendUserActionReport("xps","c"),this._reporter.sendThirdPartyReport("xplayer_dl"),this._reporter.sendCustomLoadedTime(1),this._reporter.sendClientConsumeReport()},adapterForReport:function(){this.controls={fullscreenPanel:{fullFlag:function(){return 1}}},this.video={src:this.getSrc()},this.getQuality=function(){return"m"}}},x("http://player.youku.com/h5player/play.css?ver="+VER.replace(/[-:]/g,""),"css");var ma=function(t,e){this.setting={debug:!1,controls:b.get(".x-console"),feedback:b.get(".x-feedback"),container:{poster:b.get(".x-video-poster")},buttons:{pointVideo:b.get("#point-video"),playControl:b.get(".x-play-control"),play:b.get("#x-playbtn"),videobtn:b.get(".x-video-button"),loading:b.get(".x-video-loading"),videoinfo:b.get(".x-video-info"),shadow:b.get(".x-trigger"),currentTime:b.get(".x-time-current"),totalTime:b.get(".x-time-duration"),fullscreen:b.get(".x-fullscreen")},classNames:{play:"x-playing",pause:"x-pause"},init:function(){}},b.extend(this.setting,e),this.player=t,this.dashboard=this.setting.controls,this.container=this.setting.container,this.progressBar=new ca(t),this.progressBar.uCurrentTime=this.setting.buttons.currentTime,this.miniProgressBar=new Z(t),this.fullscreenPanel=new V(t),this.interactionPanel=new X(t),this.xplayer=b.get("#x-player"),this.buttons=this.setting.buttons};ma.prototype={init:function(t,e){this.buttons.totalTime.innerHTML=e.totalTime?b.getTime(e.totalTime):"00:00",this.resetProgress(),this.buttons.play.className=this.setting.classNames.play;var i=this.container.poster.getElementsByTagName("img")[0];b.config.poster?i.src=b.config.poster:t.data[0].trial||-6==t.data[0].error_code?(this.container.poster.style.backgroundColor="black",i.parentNode.removeChild(i),b.show(this.container.poster)):(i.src=t.data[0].logo,this.container.poster.style.display="block"),this._qualityPanel=new fa(this.player,t),this._languagePanel=new Y(this.player,t),this._playratePanel=new ba(this.player,t),this._payPanel=new $(this.player,t),this._feedbackPanel=new J(this.player,t),this._informationPanel=new W(this.player,t),this.tipPanel=new ia(this.player,t),this.showlistPanel=new ha(this.player,t),this.playLimit=new aa(this.player,t),this.bindDynamicEvent()},bindDynamicEvent:function(){this.bind_mutualHide=b.bindAsEventListener(this,this.mutualHide),b.addEventHandler(this._languagePanel,"click",this.bind_mutualHide),b.addEventHandler(this._qualityPanel,"click",this.bind_mutualHide),b.addEventHandler(this.showlistPanel,"click",this.bind_mutualHide),b.addEventHandler(this._playratePanel,"click",this.bind_mutualHide),this.bind_progress=b.bindAsEventListener(this,this.onProgress),b.addEventHandler(this.progressBar,"progressing",this.bind_progress),b.addEventHandler(this.progressBar,"progressend",b.bindAsEventListener(this,this.onProgressEnd)),b.addEventHandler(this._languagePanel,"settingdone",b.bindAsEventListener(this,this.onSettingDone)),b.addEventHandler(this._qualityPanel,"settingdone",b.bindAsEventListener(this,this.onSettingDone)),b.addEventHandler(this._playratePanel,"settingdone",b.bindAsEventListener(this,this.onSettingDone)),b.addEventHandler(this._languagePanel,"settingshow",b.bindAsEventListener(this,this.onSettingShow)),b.addEventHandler(this._qualityPanel,"settingshow",b.bindAsEventListener(this,this.onSettingShow)),b.addEventHandler(this._playratePanel,"settingshow",b.bindAsEventListener(this,this.onSettingShow)),b.addEventHandler(this._languagePanel,"settinghide",b.bindAsEventListener(this,this.onSettingHide)),b.addEventHandler(this._qualityPanel,"settinghide",b.bindAsEventListener(this,this.onSettingHide)),b.addEventHandler(this._playratePanel,"settinghide",b.bindAsEventListener(this,this.onSettingHide)),b.addEventHandler(this.fullscreenPanel,"enterfullscreen",b.bindAsEventListener(this,this.onEnterFullScreen)),b.addEventHandler(this.fullscreenPanel,"exitfullscreen",b.bindAsEventListener(this,this.onExitFullScreen))},retimer:function(){debug.log("retimer"),this.autoHideDashBoard()},hideDashBoard:function(){var t=this._payPanel,e=this._informationPanel,i=this.miniProgressBar,n=this.interactionPanel,s=this._languagePanel;this.setting.controls.style.display="none",i.show(),t.hide(),e.hide(),n.hideStatus(),s.hide(),this._qualityPanel.hide(),this._playratePanel.hide()},autoHideDashBoard:function(t){this.dashboardTimer&&clearTimeout(this.dashboardTimer);var e=this;this.dashboardTimer=setTimeout(function(){"block"==b.get(".x-showlist").style.display?e.autoHideDashBoard(t):e.player.video.paused||e.hideDashBoard()},t||2e3)},onMultiTouch:function(){},showUglyHint:function(){},closeUglyHint:function(){},showBoardInfo:function(){b.show(this.setting.controls),this.miniProgressBar.hide(),this._informationPanel.show(),this._payPanel.hasPayInfo()&&this._payPanel.show()},toggleDashBoard:function(t){if(!("touchend"==t.type&&1<t.changedTouches.length)){this._sx=this._sx||0,this._sy=this._sy||0,t.changedTouches=t.changedTouches||[{clientX:this._sx,clientY:this._sy}];var e={x:this._sx,y:this._sy},t={x:t.changedTouches[0].clientX,y:t.changedTouches[0].clientY};!this._stmtag&&1!==this._sactionType&&this.isTouchTooShort(e,t,100)&&(e=this.setting.controls.style.display,"none"==e||""==e?(this.player._reporter.sendUserActionReport("xcd","c"),this.showBoardInfo(),this.autoHideDashBoard(),da=(new Date).getTime()):(this.player._reporter.sendUserActionReport("xhd","c"),clearTimeout(this.dashboardTimer),this.hideDashBoard()))}},bindAdVideoBtnEvent:function(){b.addEventHandler(this.buttons.videobtn,"touchstart",b.bindAsEventListener(this,this.onVideoBtnTouchStart)),b.addEventHandler(this.buttons.videobtn,"touchend",b.bindAsEventListener(this,this.onVideoBtnTouchEnd))},bindVideoBtnEvent:function(){b.addEventHandler(this.buttons.videobtn,"click",b.bindAsEventListener(this,this.onVideoBtnClick),!0)},bindEvent:function(){debug.log("bind event"),this.bind_uireinit=b.bindAsEventListener(this,this.uiInit),this.bind_play=b.bindAsEventListener(this,this.play),this.bind_redirect=b.bindAsEventListener(this,this.redirect),this.bind_showTimeTip=b.bindAsEventListener(this,this.showTimeTip),this.bind_hideTimeTip=b.bindAsEventListener(this,this.hideTimeTip),this.bind_changeVolume=b.bindAsEventListener(this,this.changeVolume),this.bind_toggleVolume=b.bindAsEventListener(this,this.toggleVolume),this.bind_gestureChange=b.bindAsEventListener(this,this.onGestureChange),this.bind_toggleDashBoard=b.bindAsEventListener(this,this.toggleDashBoard),this.bind_retimer=b.bindAsEventListener(this,this.retimer),b.addEventHandler(this.progressBar,"click",this.bind_uireinit),b.addEventHandler(this.setting.controls,"click",this.bind_retimer),b.addEventHandler(this.setting.controls,"touchstart",this.bind_retimer),b.addEventHandler(this.buttons.playControl,"click",this.bind_play),"directsrc"==b.config.playType&&(d.isIPHONE||d.isIPOD?b.addEventHandler(this.buttons.videobtn,"click",b.bindAsEventListener(this,this.playIPH),!0):b.addEventHandler(this.buttons.videobtn,"click",this.bind_redirect,!0)),b.addEventHandler(this.buttons.shadow,"touchstart",b.bindAsEventListener(this,this.shadowTouchStart)),b.addEventHandler(this.buttons.shadow,"touchmove",b.bindAsEventListener(this,this.shadowTouchMove)),b.addEventHandler(this.buttons.shadow,"touchend",b.bindAsEventListener(this,this.shadowTouchEnd)),b.addEventHandler(this.buttons.shadow,"click",this.bind_toggleDashBoard),b.addEventHandler(this.buttons.shadow,"touchend",b.bindAsEventListener(this,this.onMultiTouch)),b.addEventHandler(this.buttons.shadow,"gesturechange",this.bind_gestureChange)},removeEvent:function(){debug.log("remove event begin"),b.removeEventHandler(this.progressBar,"click",this.bind_uireinit),b.removeEventHandler(this.buttons.playControl,"click",this.bind_play),b.removeEventHandler(this.buttons.shadow,"click",this.bind_toggleDashBoard),b.removeEventHandler(this.progressBar,"touchstart",this.bind_uireinit),b.removeEventHandler(this._languagePanel,"click",this.bind_mutualHide),b.removeEventHandler(this._qualityPanel,"click",this.bind_mutualHide),b.removeEventHandler(this._playratePanel,"click",this.bind_mutualHide),this.progressBar.removeEvent(),this.fullscreenPanel.removeEvent(),this._languagePanel.removeEvent(),this._qualityPanel.removeEvent(),debug.log("remove event end")},onGestureChange:function(t){t.preventDefault();
var e=-1!==this.fullscreenPanel.zoomStatus().indexOf("in");(1.1<t.scale&&e||.9>t.scale&&!e)&&(t.method="m",this.fullscreenPanel.switchFullScreen(t))},toggleVolume:function(){},changeVolume:function(){},rePlay:function(){debug.log("replay"),this.player._reporter.sendUserActionReport("xrp","c"),v=!1,(this._recommend=b.get(".x-recommend"))&&b.get("#x-player").removeChild(this._recommend),this.resetProgress(),this._first=!1,this.player.replay(),debug.log("replay func end")},redirect:function(t){this.player.redirect(t)},hideFacade:function(){var t=this.container.poster;b.hide(this.buttons.videobtn),b.hide(t),b.hide(b.get(".x-feedback")),debug.log("<font color=blue>hide facade</font>")},onVideoBtnTouchStart:function(t){this._vtsx=t.targetTouches[0].clientX,this._vtsy=t.targetTouches[0].clientY},onVideoBtnTouchEnd:function(t){debug.log("<font color=red>video btn clicked</font>"),t=t||{},v?this.rePlay():t&&t.changedTouches&&50<Math.abs(t.changedTouches[0].clientY-this._vtsy)?debug.log("videobtn too long y"):(this.player._reporter.sendUserActionReport("xps","c"),!0!==this._hasAdReq&&(this._hasAdReq=!0,this.hideFacade(),debug.log("active src="+this.player.video.src),this.player.video.load(),this.player.requestAd()))},onVideoBtnClick:function(){(d.isIPHONE||d.isIPOD)&&null!=b.v.data[0].trial&&(this.player.video.style.display="block"),v?this.rePlay():b.v.data[0].trial&&0==b.v.data[0].trial.time||(this.player.video.load(),this.player.video.play())},playIPH:function(){if(!this.iphTag){this.player.video.load();var t=this;this.player.video.addEventListener("timeupdate",function(e){4==e.target.readyState&&(t.iphTag=!0)})}this.player.video.play()},play:function(t){if(t=t||{},v)this.rePlay();else{var e=this.player.video.paused;debug.log("m3u8 isPause = "+e+" e = "+t),e?(0===this._payPanel.activeTime?(this._payPanel.activeTime=-1,this.player.seek(0)):this.player.video.play(),this.player._reporter.sendUserActionReport("xpl","c"),this.interactionPanel.setStatus("播放")):(this.player.video.pause(),this.player._reporter.sendUserActionReport("xpa","c"),this.interactionPanel.setStatus("暂停")),this.checkPauseAd()}},isProperWH:function(t,e){var i=b.get("#x-player");return i.offsetWidth>=t&&i.offsetHeight>=e},isNeedPauseAd:function(){return this.player.video.paused&&b.isLandScape()},checkPauseAd:function(){this.isNeedPauseAd()?(this._pauseAdPlugin=new M(this.player,b.v,b.videoInfo._sid),this._pauseAdPlugin.addEventListener(ADConstant.PAUSE_AD_INFO_OK,b.bindAsEventListener(this,this.onPauseAdInfoOK)),this._pauseAdPlugin.addEventListener(ADConstant.PAUSE_AD_INFO_TIMEOUT,b.bindAsEventListener(this,this.onPauseAdInfoTimeout)),this._pauseAdPlugin.addEventListener(ADConstant.PAUSE_AD_INFO_ERROR,b.bindAsEventListener(this,this.onPauseAdInfoERROR)),window[ADConstant.AdPluginObject]=this._pauseAdPlugin,this._pauseAdPlugin.pauseAd(),debug.log("send pause ad request<br/>")):(debug.log("<font color=blue> donot need pause ad </font>"),this.hidePauseAd())},hidePauseAd:function(){b.hide(b.get(".x-ad-pause"))},onPauseAdInfoOK:function(t){debug.log("pause info ok"),this._pauseAdStart||(this._pauseAdStart=!0),this._pauseAdPlayer=new ka(this.player,t),this._pauseAdPlayer.play()},onPauseAdInfoTimeout:function(t){debug.log("pause info timeout = "+t.data.timeout),this._pauseAdStart||(this._pauseAdStart=!0)},onPauseAdInfoERROR:function(){debug.log("<font color=blue>pause info error no info</font>"),this._pauseAdStart||(this._pauseAdStart=!0)},autoShow:function(){this.show();var t=this;setTimeout(function(){t.hide()},5e3)},mutualHide:function(t){t._target==this._languagePanel?(this._qualityPanel.hide(!0),this._playratePanel.hide(!0),this.showlistPanel.hide()):t._target==this._qualityPanel?(this._languagePanel.hide(!0),this._playratePanel.hide(!0),this.showlistPanel.hide()):t._target==this.showlistPanel?(this._qualityPanel.hide(!0),this._languagePanel.hide(!0),this._playratePanel.hide(!0)):t._target==this._playratePanel&&(this._qualityPanel.hide(!0),this._languagePanel.hide(!0),this.showlistPanel.hide())},show:function(t){b.show(t?this.buttons[t]:this.setting.controls)},hide:function(t){b.hide(t?this.buttons[t]:this.setting.controls)},backAdPrepare:function(){this.dashboard.style.display="none",this.buttons.shadow.display="none"},onEnded:function(){this.dashboard.style.display="none",this.buttons.shadow.display="none",this.buttons.videobtn.style.display="block",this.container.poster.style.display="block",this._informationPanel.show(),this.miniProgressBar.hide(),this.interactionPanel.hide(),null==b.v.data[0].trial&&(this._relatedPanel=new ga(this.player,b.v))},onPlay:function(){this.player.video.style.display="block",this.buttons.play.className=this.setting.classNames.pause,this.buttons.videobtn.style.display="none",this.container.poster.style.display="none",this.hidePauseAd(),this.buttons.shadow.style.display="block",(this._recommend=b.get(".x-recommend"))&&b.get("#x-player").removeChild(this._recommend),v=!1,this._first||(this._first=!0,this._informationPanel.show(),this.setting.controls.style.display="block"),this.autoHideDashBoard(5e3)},onPause:function(){this.buttons.play.className=this.setting.classNames.play,b.hide(this.buttons.loading),this.interactionPanel.isVisible()||(this.showBoardInfo(),this.interactionPanel.setStatus("暂停"))},onWaiting:function(){!this.player.video.paused&&"none"==this.buttons.videobtn.style.display&&(this.buttons.loading.style.display="block")},onTryPlayEnded:function(){debug.log("try end");var t=this.player.video;this.player.video.pause(),this._payPanel.activeTime=0,v=!0,this.onEnded({target:t}),this._payPanel.showTip();var e=this;setTimeout(function(){e.dashboard.style.display="none",e.buttons.shadow.style.display="none",e.interactionPanel.hide()},1e3)},onTimeUpdate:function(t){if(this.buttons.loading.style.display="none",t.target==this.player.video){var e=this.player.currentTime;4==t.target.readyState&&this.setProgress(e),this._payPanel.hasPayInfo()&&e>=this._payPanel.tryDuration()&&this.onTryPlayEnded(),this.playLimit.isLimit()&&e>=this.playLimit.limitTime()&&this.playLimit.create()}},checkPlayLimit:function(){return this.playLimit.isLimit()?(this.playLimit.create(),!0):!1},removeControls:function(){this.video.controls=!1},loadControls:function(){this.video.controls=!0},setProgress:function(t){t=Math.min(Math.max(t,0),b.videoInfo.totalTime),this.progressBar.setProgress(t),this.miniProgressBar.setProgress(t),this.buttons.currentTime.innerHTML=b.getTime(this.progressBar.playTime)},resetProgress:function(){this.progressBar.resetProgress(),this.miniProgressBar.resetProgress(),this.buttons.currentTime.innerHTML="00:00"},hideTimeTip:function(t){return t.srcElement.id==this.buttons.progressHandler.id?!1:void(this.buttons.progressTime.style.display="none")},showTimeTip:function(t){return t.srcElement.id==this.buttons.progressHandler.id||t.srcElement.id==this.buttons.progressTime.id||t.srcElement.id==this.buttons.pointVideo.id?!1:(t=t.offsetX/this.buttons.progressBar.offsetWidth,this.buttons.progressTime.innerHTML=b.getTime(t*b.videoInfo.totalTime),this.buttons.progressTime.style.left=100*Math.min(Math.max(t,.023),.977)+"%",void(this.buttons.progressTime.style.display="block"))},shadowTouchStart:function(t){1<t.targetTouches.length?this.interactionPanel.hide():(this._sx=t.targetTouches[0].clientX,this._sy=t.targetTouches[0].clientY,this._smx=this._sx,this._smy=this._sy,this._presmx=this._sx,this._presmy=this._sy,this._deltaxs=[],this._ttime=this._stime=this.player.currentTime||0,this._spretag=this._stmtag=!1,this._presmt=this._sactionTime=(new Date).getTime(),this._stmlrtag=this._sactionType=0)},shadowTouchMove:function(t){if(1<t.targetTouches.length)this.interactionPanel.hide();else{this._smx=t.targetTouches[0].clientX,this._smy=t.targetTouches[0].clientY,this._smt=(new Date).getTime();var e=Math.abs(this._smx-this._sx),i=Math.abs(this._smy-this._sy),n=this._smt-this._sactionTime;0===this._stmlrtag&&(this._stmlrtag=e>i?1:-1),1==this._stmlrtag&&t.preventDefault(),1!=this._sactionType&&(e>100&&e>i&&500>n?(debug.log("quick seek moving"),this.player.video.pause(),this._sactionType=1,n=this._smx>this._sx?30:-30,this.interactionPanel.setTip(this._stime,n),this.interactionPanel.show()):(200>e&&100>i&&n>1e3&&(this._spretag=!0),(this._spretag&&e>i||this._stmtag)&&(debug.log("stmtag ="+this._stmtag),this._sactionType=2,this._stmtag=!0,this.player.video.pause(),this.dragging(t))))}},shadowTouchEnd:function(t){1<t.changedTouches.length?this.interactionPanel.hide():(this.adrAdapt(t),this.isShadowTouchTooShort()&&!this._stmtag&&1!=this._sactionType?debug.log("too short or horizontal"):(t=Math.abs(this._smy-this._sy)>Math.abs(this._smx-this._sx)?"xdud":"xdlr",debug.log("shadow action = "+t),this.player._reporter.sendUserActionReport(t,"d"),2==this._sactionType?(debug.log("<br/><b>normal seek</b>"),this.player.video.play(),this.player.seek(this._ttime),this.interactionPanel.hide(),this.player._reporter.sendUserActionReport("xtseek","d"),d.Log(d.uniplayerUrl+q({e:"xtseek",adr:d.isAndroid,ios:d.isIPAD,d:parseInt(this._ttime-this._stime)}))):1==this._sactionType&&(t=0<this._smx-this._sx?30:-30,debug.log("<br/><font color=red>quick seek deltat = "+t+" cur="+this._stime+"</font>"),this.setProgress(this._stime+t),this.interactionPanel.setTip(this._stime,t),this.interactionPanel.show(),this.interactionPanel.autoHide(),this.player.video.play(),this.player.seek(this._stime+t),this.player._reporter.sendUserActionReport("xqseek","d"),d.Log(d.uniplayerUrl+q({e:"xqseek",adr:d.isAndroid,ios:d.isIPAD,d:t})),debug.log("<br/>"))))},dragging_:function(t){var e=this._smx-this._presmx;this._deltaxs.push(e>10?e/2:e);for(var i=e=0;i<this._deltaxs.length;i++)e+=this._deltaxs[i];t=Math.min(Math.max(e/t.currentTarget.offsetWidth*b.videoInfo.totalTime+this._stime,0),b.videoInfo.totalTime),this.setProgress(t),this.interactionPanel.show(),this._ttime=t,this._presmx=this._smx,this._presmy=this._smy,this._presmt=this._smt},dragging:function(t){t=Math.min(Math.max(60*((this._smx-this._sx)/t.currentTarget.offsetWidth)+this._stime,0),b.videoInfo.totalTime),this.setProgress(t),this.interactionPanel.setTip(this._ttime,t-this._ttime),this.interactionPanel.show(),this._ttime=t,this._presmx=this._smx,this._presmy=this._smy,this._presmt=this._smt},onProgress:function(t){this.interactionPanel.setTip(t.st||0,t.dt||0),this.interactionPanel.show()},onProgressEnd:function(){this.interactionPanel.hide()},onSettingDone:function(){this.interactionPanel.setStatus("设置成功")},onSettingShow:function(){debug.log("<b>setting show</b>"),clearTimeout(this.pbarClickTimer),this.progressBar.removeClickEvent()},onSettingHide:function(){debug.log("<b>setting hide</b>");var t=this;this.pbarClickTimer=setTimeout(function(){t.progressBar.addClickEvent()},1e3)},onEnterFullScreen:function(){d.isIPAD&&b.addClass(this.setting.controls,"x-fs-console")},onExitFullScreen:function(){d.isIPAD&&b.removeClass(this.setting.controls,"x-fs-console")},adrAdapt:function(t){d.isAndroid&&(this._smx=t.changedTouches[0].clientX,this._smy=t.changedTouches[0].clientY,debug.log("<hr/>adr smy= "+this._smy+" y = "+this._sy))},isShadowTouchTooShort:function(t){return this.isTouchTooShort({x:this._sx,y:this._sy},{x:this._smx,y:this._smy},t)},isTouchTooShort:function(t,e,i){var n=Math.abs(e.x-t.x),n=n||1e-6,t=(t=Math.abs(e.y-t.y))||1e-6;return debug.log(n+","+t),i=i||100,i>n&&i>t?!0:!1},showShowListBtn:function(){this.showlistPanel.showListBtn()},hideShowListBtn:function(){this.showlistPanel.hideListBtn()},showLastTimeTip:function(t){0>=t||this.tipPanel.showLastTimeTip(t)},uiInit:function(){debug.log("uiInit"),v&&(v=!1,this.buttons.videobtn.style.display="block")},onResize:function(t){var e=document.getElementById(b.config.parentBox).offsetWidth,i=document.getElementById(b.config.parentBox).offsetHeight;e&&i&&b.resizeTag&&(this.player._reporter.sendUserActionReport("xre","r"),i=this.xplayer.className,this.xplayer&&(-1===i.indexOf("fullscreen")?this.xplayer.className=y(e):(e=window.innerWidth,this.xplayer.className=y(e)+" x-player-fullscreen")),this._relatedPanel)&&this._relatedPanel.onResize(t)}};var N=function(){this.video=b.get("#youku-html5player-video"),this._startPlayTime=-1,this.currentTime=this._waitTry=0};N.prototype={getVideo:function(){return this.video},show:function(){b.show(this.video)},hide:function(){b.hide(this.video)},play:function(){b.v&&b.v.data[0].trial&&0==b.v.data[0].trial.time?debug.log("<b> trial time = 0  </b>"):this.video.play()},pause:function(){this.video.pause()},setupControls:function(t){return this.controls&&this.controls.removeEvent(),new ma(t)},hideControls:function(){this.controls.hide()},showControls:function(){this.controls.show()},removeControls:function(){this.controls.removeControls()},loadControls:function(){this.controls.loadControls()},retry:function(){},showError:function(t){this.errorBox||(this.errorBox=document.createElement("div"),this.errorBox.style.cssText="position:absolute;width:100%;top:50%;display:none;text-align:center;",this.video.parentNode.appendChild(this.errorBox)),this.errorBox.innerHTML=t,this.errorBox.style.marginTop="-"+this.errorBox.offsetHeight/2+"px",this.errorBox.style.display="block"},onLoadStart:function(){},onCanPlay:function(){},onLoadedData:function(){},onLoadedMetaData:function(){},onAbort:function(){},onError:function(){if(this._reporter.sendUserActionReport("xve","e"),this._reporter.sendUepReport("videoload",-1,!1),d.uniReport({error:10,vid:b.v.data[0].videoid,time:this.currentTime,errorcode:this.video.error.code,ua:escape(navigator.userAgent.replace(/[\/\+\*@\(\)\,]/g,""))}),d.sendErrorReport(2001),0<=this._retry--)-1!==this.video.src.indexOf("m3u8")&&(this.video.src=b.m3u8src_v2(b.v.data[0].videoid,b.defaultVideoType)),debug.log("video onerror retry it ,time="+this.currentTime+" src="+this.video.src),this.video.load(),this.video.play(),this.seek(this.currentTime);else if(!(this.isOnePiece()&&1==this.controls.checkPlayLimit()||this._errorTag)){d.uniReport({error:11,errorcode:this.video.error.code,vid:b.v.data[0].videoid,ua:escape(navigator.userAgent.replace(/[\/\+\*@\(\)\,]/g,""))}),this._errorTag=!0,b.playerEvents&&b.playerEvents.onPlayError&&b.playerEvents.onPlayError("抱歉，视频出错，请刷新");var t=b.get("#x-player");t.innerHTML="抱歉，视频出错，请刷新",t.style.textAlign="center",t.style.color="white",t.style.lineHeight=t.offsetHeight+"px"}},onPause:function(){this.controls.onPause()},onPlayIPH:function(){debug.log("onplayiph"),this.onPlayStart(),this._firstPlayTag?1==this._endedIPH&&(this._reporter.tsInit(),this._reporter.sendVVLog(62),this._reporter.sendTSLog(60),this._reporter.addPlayerDurationReport(62)):(this._firstPlayTag=!0,this._reporter.addPlayerStaticReport(),this._reporter.addPlayerDurationReport(59),this._reporter.sendVVLog(59),this._reporter.sendTSLog(60),this._reporter.sendUserActionReport("xps","c"),this._reporter.sendLoadedTime(3),this._reporter.sendThirdPartyReport("xplayer_iph"),this._reporter.sendClientConsumeReport())},onTimeUpdateIPH:function(){this.currentTime=this.video.currentTime},onEndedIPH:function(){this.onPlayEnd(),this._reporter.addPlayerDurationReport(61),this._reporter.sendTSLog(61),this._endedIPH=!0},onPlay:function(){debug.log("onplay"),this.controls.onPlay(),this._firstPlayTag||(this._firstPlayTag=!0,this.onPlayStart(),b.initConfig.firsttime?(debug.log("starttime = "+b.initConfig.firsttime),this.seek(b.initConfig.firsttime)):this.seekToLastPoint()||this.skipHead(),this._startPlayTime=(new Date).getTime(),this._reporter.addPlayerStaticReport(),this._reporter.addPlayerDurationReport(59),this._reporter.sendVVLog(59),this._reporter.sendTSLog(60),this._reporter.sendClientConsumeReport()),l.appendItem("phase","videoplay")},onVolumeChange:function(){},onPlaying:function(){},onStalled:function(t){debug.log("<b>stalled</b>"),(this.isOnePiece()||t.target==this.video)&&this.controls.onWaiting(t)},onSuspend:function(){},onWaiting:function(t){(this.isOnePiece()||t.target==this.video)&&this.controls.onWaiting(t)},onSeeked:function(){if(debug.log("onSeeked waitSkip="+this._waitSeek+" try= "+this._waitTry),!isNaN(this._waitSeek)){var t=this._waitSeek;10<Math.abs(this.video.currentTime-t)&&5>=this._waitTry?(this._waitTry+=1,this.seek(t)):this._waitSeek="NaN"}},onSeeking:function(t){if(debug.log("seeking"),this.isOnePiece()||t.target==this.video){var e=this;setTimeout(function(){e.controls.onWaiting(t)},100)}},onDurationChange:function(){},onProgress:function(){},onRateChange:function(){},customWaiting:function(){var t=this;0==this.video.paused&&this._lastTime===this.currentTime&&(debug.log("custom waiting!:) networkstate="+this.video.networkState),this.controls.onWaiting()),this._lastTime=this.currentTime,setTimeout(function(){t.customWaiting()},5e3)},sendLoadedTime:function(){var t=0,t=-1==this._startPlayTime?0:(new Date).getTime()-this._startPlayTime;this._reporter.sendLoadedTime(t)},onTimeUpdate:function(t){if(this.isOnePiece())this.currentTime=this.video.currentTime,b.unitedTag&&(this.currentTime-=b.unitedTag.offset);else{for(var e=0,i=0;r>i;i++)e+=parseInt(b.videoInfo._videoSegsDic[m][i].seconds);this.currentTime=e+this.video.currentTime}this.controls.onTimeUpdate(t),this._firstflag||(this._firstflag=!0,this.customWaiting(),this.recordLocalPlayPoint(),this.sendLoadedTime(),l.appendItem("phase","videotimeupdate"),d.isNeedAdrTrick()&&d.adrInvalidPauseCheck(this.video)),this._comscoreflag||(this._comscoreflag=!0,this._reporter.sendThirdPartyReport("xplayer_h5")),this.skipTail(this.currentTime)},curVideo:function(){return this.video},getQuality:function(){if("m3u8"!=b.config.content)return"m";var t=this.video.src;return-1!==t.indexOf("mp4")?"m":-1!==t.indexOf("flv")?"f":-1!==t.indexOf("hd2")?"h":void 0},bufferedEnd:function(){var t=this.curVideo().buffered;return 0==t.length?0:t.end(t.length-1)},loadNextVideo:function(){var t=b.v.data[0].list_next,e=this;if(debug.log("loadNextVideo vid = "+t.vidEncoded),t.vidEncoded){var n={isFullScreen:!0,vid:t.vid,vidEncoded:t.vidEncoded,Pt:2==window.playmode?t.seq:null};b.config.nextAutoPlay=!0,i.start(t.vidEncoded,"",b.config.content,function(t,i){e.startPlay(t,i);try{onPlayerStart(n)}catch(s){console.log("onPlayerStart error")}})}},onPlayEnd:function(){d.playerCurrentState=d.playerState.PLAYER_STATE_END,debug.log(d.playerCurrentState),b.config.events&&b.config.events.onPlayEnd&&(debug.log("callback: on play end"),b.config.events.onPlayEnd(b.v.data[0].list_next))},onPlayStart:function(){b.config.events&&b.config.events.onPlayStart&&(d.playerCurrentState=d.playerState.PLAYER_STATE_PLAYING,debug.log(d.playerCurrentState),debug.log("callback: on play start"),b.config.events.onPlayStart())},onMiddleEnded:function(){r++,this.video.src=b.multiPieceSrc(r),this.video.load(),this.video.play(),this.video.style.display="block",debug.log("middle src = "+this.video.src)},onEnded:function(t){this.isOnePiece()&&1==this.controls.checkPlayLimit()||(this.isOnePiece()||r==b.videoInfo._videoSegsDic[m].length-1?(v=!0,this._reporter.addPlayerDurationReport(61),this._reporter.sendTSLog(61),this.clearLocalPlayPoint(),this.showEndCard(t),l.appendItem("phase","videoended")):this.onMiddleEnded(t))},showEndCard:function(t){this.video.style.display="none",this.controls.onEnded(t),this.onPlayEnd()},onBeginFullscreen:function(){},onEndFullscreen:function(){(d.isIPHONE||d.isIPOD)&&null!=b.v.data[0].trial&&(this.video.style.display="none")},detectIsPlaying:function(t){var e=t||0,i=this;clearTimeout(this.timeoutTimer),0===this.video.currentTime&&60>=e&&(this.video.load(),this.play(),this.timeoutTimer=setTimeout(function(){i.detectIsPlaying(++e)},1e3))},isOnePiece:function(){return"m3u8"==b.config.content||"mp4"==b.config.content&&1==b.videoInfo._videoSegsDic[m].length},bindEvent:function(){if(!b.v.data[0].error_code&&!b.v.data[0].error)if("directsrc"==b.config.playType)b.addEventHandler(this.video,"play",b.bindAsEventListener(this,this.onPlayIPH)),b.addEventHandler(this.video,"timeupdate",b.bindAsEventListener(this,this.onTimeUpdateIPH)),b.addEventHandler(this.video,"ended",b.bindAsEventListener(this,this.onEndedIPH)),b.addEventHandler(this.video,"webkitendfullscreen",b.bindAsEventListener(this,this.onEndFullscreen));else{var t,e={loadstart:"onLoadStart",canplay:"onCanPlay",loadeddata:"onLoadedData",loadedmetadata:"onLoadedMetaData",abort:"onAbort",error:"onError",pause:"onPause",waiting:"onWaiting",stalled:"onStalled",suspend:"onSuspend",play:"onPlay",volumechange:"onVolumeChange",playing:"onPlaying",seeked:"onSeeked",seeking:"onSeeking",durationchange:"onDurationChange",progress:"onProgress",ratechange:"onRateChange",timeupdate:"onTimeUpdate",ended:"onEnded",webkitbeginfullscreen:"onBeginFullscreen",webkitendfullscreen:"onEndFullscreen"};for(t in e)b.addEventHandler(this.video,t,b.bindAsEventListener(this,this[e[t]]))}}};var r=-1,v=!1,m=null,da=0,ea=600,s={flvhd:"标清",flv:"标清",mp4:"高清",hd2:"超清"};b.WIN_TYPE=30,b.defaultVideoType="mp4",b.resizeTag=!0,b.extend=function(t,e){for(var i in e)t[i]=e[i]},b.inherits=function(t,e){var i=function(){};i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=t},b.bind=function(t,e){return function(){return e.apply(t,arguments)}},b.bindAsEventListener=function(t,e){var i=Array.prototype.slice.call(arguments).slice(2);return function(n){return e.apply(t,[n||window.event].concat(i))}},b.getCurrentStyle=function(t){return t.currentStyle||document.defaultView.getComputedStyle(t,null)},b.addEventHandler=function(t,e,i,n){b.config.isMobile&&"click"==e&&!n&&(e="touchend"),t.addEventListener?t.addEventListener(e,i,!1):t.attachEvent?t.attachEvent("on"+e,i):t["on"+e]=i},b.removeEventHandler=function(t,e,i,n){b.config.isMobile&&"click"==e&&!n&&(e="touchend"),t.removeEventListener?t.removeEventListener(e,i,!1):t.detachEvent?t.detachEvent("on"+e,i):t["on"+e]=null},b.show=function(t){t.style.display="video"===t.tagName.toLowerCase()?"":"block"},b.hide=function(t){t&&(t.style.display="none")},b.getLeftPosition=function(t){for(var e=t.offsetLeft;t.offsetParent;)t=t.offsetParent,e+=t.offsetLeft;return e},b.get=function(t){return document.querySelector(t)},b.pieceLength=function(){return"m3u8"==b.config.content?1:b.videoInfo._videoSegsDic[m].length},b.multiPieceSrc=function(t){return t>=b.videoInfo._videoSegsDic[m].length?"":b.videoInfo._videoSegsDic[m][t].src},b.getTime=function(t){if(!t)return"00:00";var e=Math.floor(t),t=e%60,e=Math.floor(e/60);return(10>e?"0"+e:e)+":"+(10>t?"0"+t:t)},b.addClass=function(t,e){b.hasClass(t,e)||(t.className+=" "+e)},b.hasClass=function(t,e){return RegExp("(^| )"+e+"( |$)").test(t.className)},b.removeClass=function(t,e){t.className=t.className.replace(RegExp("(^| )"+e+"( |$)")," ").replace(/^\s+|\s+$/g,"")},b.m3u8src=function(t,e){var i="http://v.youku.com/player/getM3U8/vid/"+t+"/type/"+e+"/ts/"+parseInt((new Date).getTime()/1e3);return(d.isIPHONE||d.isIPOD)&&(i+="/useKeyFrame/0"),i+"/v.m3u8"},b.m3u8src_v2=function(t,e){if(b.OLD_M3U8)return b.m3u8src(t,e);var i={vid:t,type:e,ts:parseInt((new Date).getTime()/1e3),keyframe:d.isIPHONE?0:1};b.password&&(i.password=b.password),b.password&&b.initConfig.client_id&&b.config.partner_config&&1==b.config.partner_config.status&&1==b.config.partner_config.passless&&(i.client_id=b.initConfig.client_id);var s=encodeURIComponent(D(E(F(b.mk.a4+"poz"+d.userCache.a2,[19,1,4,7,30,14,28,8,24,17,6,35,34,16,9,10,13,22,32,29,31,21,18,3,2,23,25,27,11,20,5,15,12,0,33,26]).toString(),d.userCache.sid+"_"+t+"_"+d.userCache.token)));return i.ep=s,i.sid=d.userCache.sid,i.token=d.userCache.token,i.ctype="12",i.ev="1",i.oip=b.v.data[0].ip,i="http://pl.youku.com/playlist/m3u8?"+n(i),""!=b.getUCStr(t)&&(i+=b.getUCStr(t)),i},b.isLandScape=function(){return 90==window.orientation||-90==window.orientation},b.getUCStr=function(t){var e="";if("undefined"!=typeof getUCSecret)t=getUCSecret(t),e+="&xk="+t;else if("undefined"!=typeof uckey)var i=uckey.getUCKey(t),e=e+("&vid="+t+"&uc_param_str=xk&xk="+i);else 1==b.isUCBrowserAndValidVersion()&&(e+="&vid="+t+"&uc_param_str=xk");return e},b.isUCBrowserAndValidVersion=function(){var t=navigator.userAgent,e=t.search(/ucbrowser/i);return-1!=e&&9.8<=parseFloat(t.substr(e+10,4))?!0:!1},YoukuHTML5Player=function(t){null==t.parentBox&&(t.parentBox="parentBox"),t.expand&&0<parseInt(t.width)?(document.getElementById(t.parentBox).style.width=t.width+"px",document.getElementById(t.parentBox).style.height=t.height+"px"):(t.width=document.getElementById(t.parentBox).offsetWidth,t.height=document.getElementById(t.parentBox).offsetHeight),b.config=t;var e=document.getElementById(b.config.parentBox),i=parseInt(b.config.width);parseInt(b.config.height),playerDom='<div id=x-player class="'+y(i)+'">',e.innerHTML=playerDom+'<video class=x-video-player id=youku-html5player-video></video><div class=x-video-poster><img></img></div><div class=x-video-loading></div><div class=x-video-info><h1 class=x-title></h1><div class=x-video-state></div><div class=x-showmore></div><div class=x-mask></div></div><div id=x-video-button class=x-video-button><div class=x-video-play-ico></div></div><div class=x-feedback><div class="x-message"><div class=x-message-txt></div><div class=x-message-btn></div></div><div class="x-mask"></div></div><div class="x-pay"><div class=x-pay-txt><h1><em class=vip></em></h1><p class=x-pay-tips></p></div><div class=x-pay-btn><button type=button id=x-try class=x-btn>免费试看</button><button type=button id=x-pay class="x-btn x-btn-pay"></button></div></div><div class=x-advert><div class=x-advert-info><div class=x-advert-skip><div class=x-advert-txt></div><div class=x-mask></div></div><div class=x-advert-countdown><div class=x-advert-txt></div><div class=x-mask></div></div></div><div class=x-advert-detail><div class=x-advert-txt>详细了解<span class=x-ico-detail></span></div><div class=x-mask></div></div></div><div class=x-ad-pause></div><div class=x-prompt></div><div class="x-dashboard"><div class=x-progress-mini><div class=x-progress-track-mini></div><div class=x-progress-load-mini></div><div class=x-progress-play-mini></div></div><div class="x-console"><div class="x-progress"><div class="x-progress-track"><div class="x-progress-load"></div><div class=x-progress-play></div><div class="x-progress-seek"><div class="x-seek-handle"></div></div></div></div><div class="x-controls"><div class="x-play-control"><button class="x-control-btn"><b id=x-playbtn class="x-playing"><em>播放</em></b></button></div><div class="x-time-display"><span class="x-time-current">00:00</span><span class="x-time-splite">/</span><span class="x-time-duration">00:00</span></div><div class="x-settings"><div class=x-playspeed></div><div class=x-playshow style=display:none><button class=x-control-btn title=选集>选集</button></div><div class="x-localization"></div><div class="x-quality"></div><div class="x-fullscreen"><button class="x-control-btn" type="button" title="全屏模式" rol="button"><b class=x-zoomin><em>全屏</em></b></button></div></div></div></div></div><div class=x-showlist></div><div class=x-tips></div><div class=x-trigger></div></div>',N.apply(this,arguments),this.video.style.width="100%",this.video.style.height="100%",this.video.style.display="none",this.video.style.position="relative",this._firstPlayTag=!1,this._retry=2,this.uiAdapter()},b.inherits(YoukuHTML5Player,N),b.extend(YoukuHTML5Player.prototype,{startPlay:function(t,e,i){t&&t.data&&t.data[0]&&(t.data[0].show=t.data[0].show||{},e.abstarttime=(new Date).getTime(),e._playListData=t.data[0],e._user=t.user,b.v=t,b.videoInfo=e,this.setting={},b.extend(this.setting,i),!t.data[0].error_code&&!t.data[0].error||!this.processError(t,e,i))&&(this._reporter=new K(this,b.v,b.videoInfo._sid),this.controls=this.setupControls(this),this.controls.init(b.v,b.videoInfo),this.mpieceReport(),this.createIdNode(),this.isNeedAdRequest()?this.processAd():(this.controls.bindVideoBtnEvent(),this.realStartPlay(),1==b.initConfig.ucautoplay&&this.controls.onVideoBtnClick({})))},isNeedAdRequest:function(){return"undefined"==typeof this._frontAdTag&&(this._frontAdTag=!1),d.isNeedFrontAd=!this._frontAdTag&&"directsrc"!=b.config.playType&&!b.v.data[0].trial,d.isNeedFrontAd},processAd:function(){this.isNeedAdRequest()&&(this._frontAdTag=!0,this._adplugin=new M(this,b.v,b.videoInfo._sid),this.bind_frontAd=b.bindAsEventListener(this,this.onFrontAdInfoOK),this.bind_frontAdInfoTimeout=b.bindAsEventListener(this,this.onFrontAdInfoTimeout),this._adplugin.addEventListener(ADConstant.FRONT_AD_INFO_OK,this.bind_frontAd,!1),this._adplugin.addEventListener(ADConstant.FRONT_AD_INFO_TIMEOUT,this.bind_frontAdInfoTimeout),this.bind_unitedFrontAd=b.bindAsEventListener(this,this.onUnitedFrontAdInfoOK),this._adplugin.addEventListener(ADConstant.FRONT_AD_UNITED_INFO_OK,this.bind_unitedFrontAd,!1),this.bind_backAdInfoOK=b.bindAsEventListener(this,this.onBackAdInfoOK),this.bind_backAdInfoTimeout=b.bindAsEventListener(this,this.onBackAdInfoTimeout),this._adplugin.addEventListener(ADConstant.BACK_AD_INFO_OK,this.bind_backAdInfoOK,!1),this._adplugin.addEventListener(ADConstant.BACK_AD_INFO_TIMEOUT,this.bind_backAdInfoTimeout),this.bind_uglyCloseAd=b.bindAsEventListener(this,this.onUglyCloseAd),this._adplugin.addEventListener(ADConstant.UGLY_CLOSE_AD,this.bind_uglyCloseAd),this.controls.bindAdVideoBtnEvent(),window[ADConstant.AdPluginObject]=this._adplugin,1==b.initConfig.ucautoplay)&&this.controls.onVideoBtnTouchEnd({})},requestAd:function(){this._adplugin&&this._adplugin.frontAd()},onUglyCloseHint:function(){this.controls.showUglyHint()},onUglyCloseAd:function(){debug.log("ugly close"),this.controls.closeUglyHint(),this.adplayer.uglyClose()},onFrontAdInfoTimeout:function(){this._hasStartPlay=!0,this.realStartPlay(!0)},onUnitedFrontAdInfoOK:function(t){debug.log("<b>on united front adinfo ok</b>");var e=t.data.info;if(0==t.data.info.VAL.length)debug.log("<b>onUnitedFrontAdInfoOK val length == 0 </b>"),this.loadVTVC(t.data.vtvc),this.video.src=b.m3u8src_v2(b.v.data[0].videoid,b.defaultVideoType),this.unitedStartPlay(e,!0);else{this.adplayer=new la(this,t);var i=this;this.adplayer.addEventListener(ADConstant.AD_END,function(){debug.log("<font color=red>united ad end</font>"),i._realFlag||(i._realFlag=!0,i.adplayer.clearTimer(),i.unitedStartPlay(e))},!1),this.adplayer.addEventListener(ADConstant.AD_ERROR,function(){debug.log("<font color=red>united ad error</font>"),i._realFlag||(b.unitedTag=null,i._realFlag=!0,i.adplayer.clearTimer(),i.video.src=b.m3u8src_v2(b.v.data[0].videoid,b.defaultVideoType),i.unitedStartPlay(e,!0))},!1),this.adplayer.addEventListener(ADConstant.UGLY_CLOSE_AD_HINT,function(){debug.log("<b>ugly hint</b>"),i.onUglyCloseHint()},!1),this.adplayer.play(),this.createIdNode()}},loadVTVC:function(t){for(var e=0;e<t.length;e++)x(t[e].VC,"js")},onFrontAdInfoOK:function(t){if(debug.log("onFrontAdInfoOK"),!0!==this._hasStartPlay)if(0==t.data.urls.length)this.loadVTVC(t.data.vtvc),this.realStartPlay(!0);else{d.playerCurrentState=d.playerState.PLAYER_STATE_AD,debug.log(d.playerCurrentState),this.adplayer=new L(this,t);var e=this;this.adplayer.addEventListener(ADConstant.AD_END,function(t){debug.log("ad end"),e._realFlag||(e._realFlag=!0,e.adplayer.clearTimer(),e.realStartPlay(t.data))},!1),this.adplayer.addEventListener(ADConstant.AD_ERROR,function(t){debug.log("<font color=red>ad error</font>"),e._realFlag||(e._realFlag=!0,e.adplayer.clearTimer(),e.realStartPlay(t.data))},!1),this.adplayer.addEventListener(ADConstant.UGLY_CLOSE_AD_HINT,function(){debug.log("<b>ugly hint</b>"),e.onUglyCloseHint()},!1),this.adplayer.play(),this.createIdNode()}},onBackAdInfoTimeout:function(){debug.log("onBackAdInfoTimeout"),this.showEndCard()},onBackAdInfoOK:function(t){if(debug.log("onBackAdInfoOK"),0==t.data.urls.length)this.showEndCard();else{this.adplayer=new L(this,t);var e=this;this.adplayer.addEventListener(ADConstant.AD_END,function(){e.showEndCard()}),this.adplayer.addEventListener(ADConstant.AD_ERROR,function(){e.showEndCard()}),this.adplayer.play()}},prepareVideoTag:function(){this.video.preload="none","m3u8"==b.config.content?this.video.src=b.videoInfo.src:null!=b.videoInfo._videoSegsDic&&null!=b.videoInfo._videoSegsDic[m]&&(this.video.src=b.videoInfo._videoSegsDic[m][0].src),b.v.data[0].trial&&0==b.v.data[0].trial.time&&(this.video.src=null),this.createIdNode()
},createIdNode:function(){if(!document.getElementById(b.config.id)){var t=document.createElement("div");t.id=b.config.id,document.getElementById(b.config.parentBox).appendChild(t)}},redirect:function(){var t="";"m3u8"==b.config.content?t=b.videoInfo.src:null!=b.videoInfo._videoSegsDic&&null!=b.videoInfo._videoSegsDic[m]&&(t=b.videoInfo._videoSegsDic[m][0].src),debug.log("redirect play src="+t),this._reporter.addPlayerStaticReport(),this._reporter.addPlayerDurationReport(59),this._reporter.sendVVLog(59),this._reporter.sendTSLog(60),this._reporter.sendUserActionReport("xps","c"),window.open(t,"","",!1),this._reporter.sendClientConsumeReport(),this.onPlayStart()},realStartPlay:function(t){debug.log("realStartPlay "+t),this.controls.bindEvent(),this.bindEvent(),this.prepareVideoTag(),this.playVideos(t)},unitedStartPlay:function(t,e){debug.log("<b>united start play </b>"),b.unitedTag={offset:t.VAL.length?t.VAL[0].AL:0},this.controls.bindEvent(),this.bindEvent(),!0===e?(this.video.load(),this.video.play()):this.onPlay(),this.controls.onPlay()},playVideos:function(t){debug.log("playVideos "+t),v=!1,r=0,this.video.style.display=(d.isIPHONE||d.isIPOD)&&null!=b.v.data[0].trial?"none":"block",(b.config.autoplay||b.config.nextAutoPlay||t)&&(debug.log("src= "+this.video.src+" auto = "+t),this.video.load(),this.video.play())},processError:function(t){var e=t.data[0].error_code;return-12==e||-13==e?(t.data[0].error_code=null,t.data[0].error=null,t.data[0].trial={time:0},!1):(b.hide(b.get(".x-video-poster")),this.feedbackPanel=new J(this,t),!0)},mpieceReport:function(){"mp4"==b.config.content&&b.videoInfo._videoSegsDic&&null!=b.videoInfo._videoSegsDic[m]&&1<b.videoInfo._videoSegsDic[m].length&&(debug.log("mpiece report"),d.Log(d.MPIECEURL+q({partner:b.config.partnerId,type:m,length:b.videoInfo._videoSegsDic[m].length,vid:b.v.data[0].videoid})))},resize_:function(t,e,i){debug.log("resize="+b.resizeTag),e&&i&&b.resizeTag&&this.controls&&(t=this.controls.xplayer.className,this.controls&&this.controls.xplayer&&(-1===t.indexOf("fullscreen")?this.controls.xplayer.className=y(e):(e=window.innerWidth,this.controls.xplayer.className=y(e)+" x-player-fullscreen")))},uiAdapter:function(){"index"==b.config.wintype&&(b.hide(b.get(".x-localization")),b.hide(b.get(".x-quality"))),b.get("#x-video-button").className="x-video-button","m3u8"!=b.config.content&&b.hide(b.get(".x-quality"));var t=this;window.addEventListener("resize",function(e){debug.log("window.resize"),t.controls&&t.controls.onResize(e)},!1)},isOutTryDuration:function(t){return this.tryDuration?t>=this.tryDuration:!1},replay:function(){r=0,this._ireflag=this._comscoreflag=!1,this._firstflag=d.adrPlayTrick=!1,this.video.style.display="block",this.isOnePiece()||(this.video.src=b.multiPieceSrc(r)),d.isIPAD&&(this.video.src=b.m3u8src_v2(b.v.data[0].videoid,b.defaultVideoType),b.unitedTag=null),this.video.load(),this.video.play(),this._reporter.tsInit(),this._reporter.sendVVLog(62),this._reporter.sendTSLog(60),this._reporter.addPlayerDurationReport(62)},seekToLastPoint:function(){if(d.isAndroid)return!1;var t=b.v.data[0].lastpoint/1e3||-1,e=parseInt(l.getItem(b.v.data[0].videoid+"_playpoint"))||-1,i=-1;return-1!=t&&-1!=e?(i=t,60>Math.abs(t-e)&&(i=e)):(i=t,-1==t&&(i=e)),debug.log("lastpoint="+i),t=l.getItem("youku_ignore_lasttime"),t=parseInt(t)||0,-1!==i&&i>=120&&3>t&&null==b.v.data[0].trial&&0==b.v.controller.xplayer_disable&&600<=b.v.data[0].seconds?(this.controls.showLastTimeTip(i),d.isAndroid&&(this._waitSeek=i),this.seek(i),!0):!1},clearLocalPlayPoint:function(){var t=b.v.data[0].videoid;clearTimeout(this._recordLPPTimer),l.removeItem(t+"_playpoint")},recordLocalPlayPoint:function(){var t=b.v.data[0].videoid,e=this.currentTime||0,i=this;if(this._recordLPPTimer=setTimeout(function(){i.recordLocalPlayPoint()},1e4),l.removeItem(t+"_playpoint"),600<=b.v.data[0].seconds&&e<b.v.data[0].seconds-120&&null==b.v.data[0].trial&&e>=120&&(l.setItem(t+"_playpoint",e),!this.updatePPVids)){if(this.updatePPVids=!0,e=l.getItem("youku_playpoint_vids")||"",""==e)e=t;else{for(var e=e.split(":"),n=0;n<e.length;n++)e[n]==t&&(e[n]="");for(e.push(t),e=e.join(":"),n=0;":"==e.charAt(n);)n++;e=e.substring(n),e=e.replace(/:(:)+/g,":")}t=e.split(":"),30<t.length&&(debug.log("slice"),l.removeItem(t[0]+"_playpoint"),e=t.slice(1).join(":")),debug.log("youku_playpoint_vids="+e),l.setItem("youku_playpoint_vids",e)}},skipHead:function(){if(!d.isAndroid){var t=parseInt((b.v.data[0].dvd||{}).head||-1);debug.log("skiphead = "+t),-1!=t&&(this.controls.tipPanel.onSkipHead(),"true"==l.getItem("youku_conf_skip")&&(d.isAndroid&&(this._waitSeek=t/1e3),this.seek(t/1e3)))}},skipTail:function(t){if(!d.isAndroid){var e=parseInt((b.v.data[0].dvd||{}).tail||-1);-1!=e&&t>=e/1e3-10&&!this._tailTip&&(debug.log("skiptail(act before 10) ="+e),this._tailTip=!0,this.controls.tipPanel.onSkipTail()),-1!=e&&t>=e/1e3&&!this._tailSkipped&&(this._tailSkipped=!0,"true"==l.getItem("youku_conf_skip")&&this.seek(parseInt(b.v.data[0].seconds)-1))}},assistSkipTail:function(t){var e=parseInt((b.v.data[0].dvd||{}).tail||-1);this._tailTip=this._tailSkipped=t>=e/1e3?!0:!1},seek:function(t,e){t=t||0,t=Math.max(t,0),b.videoInfo.totalTime&&(t=Math.min(t,b.videoInfo.totalTime-5)),this.isOutTryDuration(t)&&(t=this.tryDuration-1),this.assistSkipTail(t);var i=this;if(this.switchTimer&&clearTimeout(this.switchTimer),this.currentTime=t,this.isOnePiece()){var n=this.video.seekable;b.unitedTag&&(t+=b.unitedTag.offset),1==n.length&&t<n.end(0)?(debug.log("seek ct = "+t+",end = "+n.end(0)),this.seekTo(t,e)):(this.controls.onWaiting(),this.switchTimer=setTimeout(function(){i.seek(t,e)},100))}else debug.log("multi seek"),this.multiSeekTo(t)},seekTo:function(t,e){if(this.isOnePiece()){debug.log("is one piece");var i=this;try{i.video.currentTime=t}catch(n){var s=0;this.video.addEventListener("canplay",function(){1!==s&&(s=1,debug.log("canplay time="+t),i.video.currentTime=t)})}"function"==typeof e&&(debug.log("<b>seekto callback(mayby play)</b>"),e())}},multiSeekTo_:function(){debug.log("YoukuHTML5 ")},multiSeekTo:function(t){debug.log("YoukuHTML5Player multiSeekTo !");for(var e=0,i=0,n=0,s=0;s<b.videoInfo._videoSegsDic[m].length;s++){var a=parseInt(b.videoInfo._videoSegsDic[m][s].seconds),e=e+a;if(e>t){i=s,n=a-(e-t);break}if(e==t){i=s+1,n=0;break}}if(this.video.pause(),i==r){debug.log(" piece time = "+n);try{this.video.currentTime=n}catch(o){}}else{r=i;var d=0,l=this;this.video.addEventListener("canplay",function(){1!==d&&(d=1,debug.log("canplay time="+n),l.video.currentTime=n)}),this.video.src=b.multiPieceSrc(r),this.video.load()}this.video.play(),this.video.style.display="block"},adjustVideoRatio:function(t){if(!d.isIOS){if(("onorientationchange"in window||"orientation"in window)&&!this._avrTag){this._avrTag=!0;var e=this;window.addEventListener("orientationchange",function(){!0===e.controls.fullscreenPanel.fullFlag()&&e.adjustVideoRatio()})}var e=this,i=this.video;setTimeout(function(){if(1===t)i.style.width="100%",i.style.height="100%",i.style.top=null,i.style.left=null;else{var e=b.get(".x-player"),e=e.offsetWidth/e.offsetHeight,n=i.videoWidth/i.videoHeight;isNaN(n)||isNaN(e)||!isFinite(e)||!isFinite(n)?(i.style.width="100%",i.style.height="100%",i.style.top=null,i.style.left=null):n>e?(i.style.width="100%",i.style.height=100*(e/n)+"%",i.style.top=100*(1/e-1/n)/2*e+"%",i.style.left=null):(i.style.height="100%",i.style.width=100*(n/e)+"%",i.style.left=100*((e-n)/2/e)+"%",i.style.top=null)}},2e3)}}}),window.YoukuPlayerSelect=I,window.BuildVideoInfo=i,window.checkSrc=function(){i._fyks.length>i.mp4srcs.length||(clearInterval(i._tid),i.cleanSrc(),i.cache(),null==i._callback?d.GetMP4OK(i._v,i._videoInfo):i._callback(i._v,i._videoInfo))},window.QS=function(){for(var t={},e=window.location.search.substring(1).split("&"),i=0;i<e.length;i++){var n=e[i].split("=");"undefined"==typeof t[n[0]]?t[n[0]]=n[1]:"string"==typeof t[n[0]]?t[n[0]]=[t[n[0]],n[1]]:t[n[0]].push(n[1])}return t},window.YKP=d,window.YKU=B,window.YoukuHTML5Player=YoukuHTML5Player;for(var O=document.getElementsByTagName("script"),H=0;H<O.length;H++)if(-1!==O[H].src.indexOf("player.youku.com/jsapi")){eval(O[H].innerHTML);break}window.notifyYKU=function(){B.swfLoaded=1},window.onPlayerStart=function(){b.initConfig.events&&b.initConfig.events.onPlayStart&&(d.playerCurrentState=d.playerState.PLAYER_STATE_PLAYING,debug.log(d.playerCurrentState),debug.log("api:flash play start"),b.initConfig.events.onPlayStart())},window.onPlayerComplete=function(){b.initConfig.events&&b.initConfig.events.onPlayEnd&&(d.playerCurrentState=d.playerState.PLAYER_STATE_END,debug.log(d.playerCurrentState),debug.log("api:flash play end"),b.initConfig.events.onPlayEnd())}}(),consoleBak&&(window.console=consoleBak)}()}(module.exports,module,__ctx);__ctx.__modules__.c49d96f0=module.exports}(this),function(t){var e={id:"c4900260",exports:{}};t.__modules__||(t.__modules__={});!function(t,e,i){i.__modules__.c4902970,i.__modules__.c4950b70,i.__modules__.c4955990,i.__modules__.c49b4d01,i.__modules__.c49d96f0}(e.exports,e,t);t.__modules__.c4900260=e.exports}(this);